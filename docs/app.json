[{"name":"app.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ - å¢åŠ åˆ†é¡æ¨™ç±¤\r\nquotes <- data.frame(\r\n  quote = c(\r\n    # 20260131\r\n    \"å…©å€‹æ¨µå¤«æ¯”è³½ç æŸ´ï¼Œå¹´è¼•çš„æ¨µå¤«ä¸€æ•´å¤©ä¸åœæ­‡ï¼Œç´¯å¾—æ°£å–˜ååï¼›å¹´è€çš„æ¨µå¤«æ¯ç ä¸€å°æ™‚å°±ä¼‘æ¯ååˆ†é˜ã€‚ å‚æ™šçµç®—æ™‚ï¼Œå¹´è€çš„æ¨µå¤«ç çš„æŸ´ç«Ÿç„¶æ¯”å¹´è¼•çš„å¤šå‡ºä¸€å€ã€‚ å¹´è¼•äººä¸æœæ°£ï¼šã€Œæˆ‘ä¸€ç›´æ²’åœï¼Œä½ ä¸€ç›´åœ¨ä¼‘æ¯ï¼Œæ€éº¼å¯èƒ½æ¯”æˆ‘å¤šï¼Ÿã€ è€æ¨µå¤«å¾®ç¬‘èªªï¼šã€Œæˆ‘ä¼‘æ¯çš„æ™‚å€™ï¼Œå…¶å¯¦æ˜¯åœ¨ç£¨æˆ‘çš„æ–§é ­ã€‚æ–§é ­éˆäº†ï¼Œå†ç”¨åŠ›ä¹Ÿæ˜¯ç™½è²»åŠ›æ°£ã€‚ã€ç£¨åˆ€ä¸èª¤ç æŸ´å·¥ã€‚ç•¶ä½ è¦ºå¾—ç”Ÿæ´»è®“ä½ æ„Ÿåˆ°åƒåŠ›æ™‚ï¼Œåœä¸‹ä¾†ã€Œç£¨äº®ã€ä½ çš„å¿ƒæ™ºèˆ‡æŠ€èƒ½ï¼Œæ¯”ç›²ç›®åŠªåŠ›æ›´æœ‰æˆæ•ˆã€‚\",\r\n    \"æ•™æˆæ‹¿èµ·ä¸€æ¯æ°´å•å­¸ç”Ÿï¼šã€Œé€™æ¯æ°´æœ‰å¤šé‡ï¼Ÿã€å­¸ç”ŸçŒœæ¸¬å¾ 200 å…‹åˆ° 500 å…‹ä¸ç­‰ã€‚æ•™æˆèªªï¼šã€Œæ°´çš„é‡é‡ä¸è®Šï¼Œä½†å–æ±ºæ–¼ä½ æ‹¿å¤šä¹…ã€‚æ‹¿ä¸€åˆ†é˜æ²’å•é¡Œï¼›æ‹¿ä¸€å°æ™‚è‚©è†€æœƒé…¸ï¼›æ‹¿ä¸€å¤©ï¼Œä½ çš„æ‰‹è‡‚æœƒéº»æœ¨ç™±ç˜“ã€‚ã€å£“åŠ›èˆ‡éå»çš„åŒ…è¢±ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‹¿è‘—å®ƒä¸¦ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯ä½ å¿˜äº†æŠŠå®ƒã€Œæ”¾ä¸‹ã€ã€‚æ”¾ä¸‹ä¸ä»£è¡¨èƒŒå›éå»ï¼Œè€Œæ˜¯ç‚ºäº†è®“é›™æ‰‹æœ‰åŠ›æ°£å»æ“æŠ±æœªä¾†ã€‚\",\r\n    \"ä¸€ç¾¤é’è›™åœ¨æ¯”è³½çˆ¬é«˜å¡”ï¼Œåœè§€çš„ç¾¤çœ¾éƒ½åœ¨å–Šï¼šã€Œå¤ªé›£äº†ï¼çµ•å°ä¸Šä¸å»çš„ï¼ã€é’è›™å€‘ä¸€éš»éš»ç²¾ç–²åŠ›ç«­åœ°æ‰ä¸‹ä¾†ï¼Œæœ€å¾Œåªå‰©ä¸€éš»å°é’è›™çˆ¬åˆ°äº†é ‚ç«¯ã€‚å¤§å®¶é©šå¥‡åœ°å•ç‰ ç§˜è¨£ï¼Œæ‰ç™¼ç¾åŸä¾†é‚£éš»é’è›™æ˜¯å€‹è¾å­ã€‚ç‰ è½ä¸åˆ°å¤–é¢çš„å¦å®šï¼Œæ‰€ä»¥ç‰ åªè½è¦‹å…§å¿ƒæƒ³ç™»é ‚çš„è²éŸ³ã€‚æœ‰æ™‚å€™ï¼Œç‚ºäº†ä¿è­·ä½ çš„å¤¢æƒ³ï¼Œä½ å¿…é ˆå­¸æœƒå°é‚£äº›èªªä½ ã€Œä¸è¡Œã€çš„äººè£è¾ä½œå•ã€‚\",\r\n    \"ä¸€å€‹å­©å­ç«™åœ¨æ–æ™ƒçš„åŠæ©‹å‰ä¸æ•¢å‰è¡Œï¼Œçœ‹è‘—æ·±è°·ç‘Ÿç‘Ÿç™¼æŠ–ã€‚ çˆ¶è¦ªå°ä»–èªªï¼šã€Œå­©å­ï¼Œä½ ä¸éœ€è¦çœ‹åˆ°æ©‹çš„å¦ä¸€é ­ï¼Œä½ åªéœ€è¦çœ‹æ¸…ä½ è…³ä¸‹é‚£ä¸€æ­¥çš„æœ¨æ¿ï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ã€ ç•¶å­©å­ä¸€æ­¥æ¥è‘—ä¸€æ­¥ï¼Œåªå°ˆæ³¨æ–¼ç•¶ä¸‹çš„é‚£ä¸€å°å¡Šæœ¨æ¿æ™‚ï¼Œä¸çŸ¥ä¸è¦ºï¼Œä»–å·²ç¶“ç«™åœ¨äº†å½¼å²¸ã€‚ææ‡¼å¾€å¾€ä¾†è‡ªæ–¼å°ã€Œé æ–¹ã€çš„éåº¦æƒ³åƒã€‚å¦‚æœä½ è¦ºå¾—ç›®æ¨™å¤ªé ã€åœç‰†å¤ªé«˜ï¼Œå°±å…ˆå°ˆæ³¨æ–¼è…³ä¸‹é‚£ä¸€æ­¥ã€‚åªè¦åœ¨èµ°ï¼Œè·¯å°±æœƒå‡ºç¾ã€‚\",\r\n    \"ç”Ÿç‰©å­¸å®¶æ›¾åšéä¸€å€‹å¯¦é©—ï¼šå°‡è·³èš¤æ”¾é€²ç»ç’ƒç½ï¼Œè·³èš¤æœƒè¼•æ˜“è·³å‡ºã€‚éš¨å¾Œï¼Œå¯¦é©—è€…è“‹ä¸Šé€æ˜è“‹å­ï¼Œè·³èš¤æ¯æ¬¡è·³èºéƒ½æœƒæ’åˆ°è“‹å­ã€‚ ä¸€æ®µæ™‚é–“å¾Œï¼Œå³ä¾¿æ‹¿æ‰è“‹å­ï¼Œè·³èš¤ä¹Ÿå†ä¹Ÿä¸æœƒè·³å‡ºç½å£äº†â€”â€”å› ç‚ºç‰ å·²ç¶“ã€Œå­¸æœƒã€äº†é«˜åº¦çš„é™åˆ¶ã€‚å¾ˆå¤šæ™‚å€™ï¼Œæˆ‘å€‘å°±åƒé‚£éš»è·³èš¤ã€‚éå»çš„æŒ«æŠ˜æˆäº†æˆ‘å€‘é ­é ‚çœ‹ä¸è¦‹çš„è“‹å­ï¼Œè®“æˆ‘å€‘å¿˜äº†è‡ªå·±å…¶å¯¦æ“æœ‰è·³å¾—æ›´é«˜ã€çœ‹æ›´é çš„èƒ½åŠ›ã€‚\",\r\n    \"éµé”å°¼è™Ÿä¸æ˜¯æ’ä¸Šäº†æµ·é¢ä¸Šçš„å†°å¡Šï¼Œè€Œæ˜¯æ’ä¸Šäº†æµ·é¢ä¸‹çœ‹ä¸è¦‹çš„å·¨å¤§å†°å±±ã€‚ äººçš„èƒ½åŠ›ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä½ ç¾åœ¨è¡¨ç¾å‡ºä¾†çš„ã€Œè¡Œç‚ºã€ï¼Œåªæ˜¯éœ²åœ¨æ°´é¢ä¸Šçš„ 10%ã€‚è€Œé‚£äº›è¢«å£“æŠ‘çš„å‹‡æ°£ã€å‰µé€ åŠ›èˆ‡éŸŒæ€§ï¼Œéƒ½æ²‰ç¡åœ¨æ·±æµ·ä¹‹ä¸­ã€‚ä¸è¦ç”¨é‚£ 10% çš„ç¾æ³ä¾†å®šç¾©ä½ è‡ªå·±ã€‚åªè¦ä½ é¡˜æ„æŒ–æ˜ï¼Œæµ·é¢ä¸‹é‚„æœ‰ 90% çš„å¥‡è¹Ÿç­‰è‘—è¢«ä½ å–šé†’ã€‚\",\r\n    \"æœ‰å…©å€‹äººç”Ÿç—…ä½åœ¨åŒä¸€å€‹ç—…æˆ¿ï¼Œå…¶ä¸­ä¸€å€‹äººé çª—ï¼Œæ¯å¤©ä»–éƒ½æœƒå‘å®¤å‹æè¿°çª—å¤–çš„æ™¯è±¡ï¼š ã€Œä»Šå¤©å…¬åœ’è£¡æœ‰å­©å­åœ¨æ”¾é¢¨ç®ï¼Œæ¹–é¢ä¸Šæœ‰å¤©éµåœ¨æˆ²æ°´ï¼Œå¤©æ°£å¥½æ¥µäº†ã€‚ã€ å¦ä¸€ä½å®¤å‹è½è‘—è½è‘—ï¼Œå¿ƒè£¡æ¼¸æ¼¸ç”¢ç”Ÿäº†å¸Œæœ›ï¼Œæ¯å¤©éƒ½æœŸå¾…è‘—é€™æ®µæè¿°ã€‚ å¾Œä¾†ï¼Œé çª—çš„äººå‡ºé™¢äº†ï¼Œå¦ä¸€äººè¿«ä¸åŠå¾…åœ°çœ‹å‘çª—å¤–ï¼Œå»ç™¼ç¾çª—å¤–åªæœ‰ä¸€å µå†·å†°å†°çš„ç£šç‰†ã€‚ä»–é€™æ‰æ˜ç™½ï¼Œç¾å¥½çš„é¢¨æ™¯ä¸ä¸€å®šæ˜¯åœ¨çª—å¤–ï¼Œè€Œæ˜¯åœ¨ä¸€å€‹äººçš„å¿ƒè£¡ã€‚å¦‚æœä½ å¿ƒä¸­æœ‰å…‰ï¼Œå³ä¾¿é¢å°æ®˜ç‰†ï¼Œä¹Ÿèƒ½çœ‹è¦‹è¬ç´«åƒç´…ã€‚\",\r\n    \"ä¸€ä½å¹´è¼•çš„æ¨‚å¸«å•ä½›é™€ï¼šã€Œæˆ‘æ¯å¤©ä¿®è¡Œéå¸¸åˆ»è‹¦ï¼Œç‚ºä»€éº¼é‚„æ˜¯æ„Ÿè¦ºä¸åˆ°é€²æ­¥ï¼Ÿã€ ä½›é™€å•ä»–ï¼šã€Œä½ å½ˆç´æ™‚ï¼Œå¦‚æœç´å¼¦èª¿å¾—å¤ªç·Šæœƒæ€æ¨£ï¼Ÿã€ æ¨‚å¸«ç­”ï¼šã€Œå¼¦æœƒæ–·ã€‚ã€ ä½›é™€åˆå•ï¼šã€Œå¦‚æœèª¿å¾—å¤ªé¬†å‘¢ï¼Ÿã€ æ¨‚å¸«ç­”ï¼šã€Œå½ˆä¸å‡ºè²éŸ³ã€‚ã€ ä½›é™€å¾®ç¬‘èªªï¼šã€Œä¿®è¡Œèˆ‡ç”Ÿæ´»ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¤ªç·Šå‰‡ç´¯ï¼Œå¤ªé¬†å‰‡å»¢ã€‚å”¯æœ‰ä¿æŒé©åº¦çš„å¼µåŠ›ï¼Œæ‰èƒ½å½ˆå¥å‡ºç¾å¦™çš„æ¨‚ç« ã€‚ã€\",\r\n    \r\n    # çŸ­èªéŒ„ (100å­—ä»¥å…§)\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\",\r\n    \r\n    # å°æ•…äº‹ (100-300å­—)\r\n    \"æœ‰å€‹å¹´è¼•äººå•æ™ºè€…ï¼šã€Œå¦‚ä½•æ‰èƒ½æˆåŠŸï¼Ÿã€æ™ºè€…å¸¶ä»–åˆ°æ²³é‚Šï¼Œçªç„¶æŠŠä»–çš„é ­æŒ‰å…¥æ°´ä¸­ã€‚å¹´è¼•äººæ‹¼å‘½æ™æ‰ï¼Œçµ‚æ–¼æ™è„«ã€‚æ™ºè€…å•ï¼šã€Œåœ¨æ°´è£¡æ™‚ï¼Œä½ æœ€æƒ³è¦ä»€éº¼ï¼Ÿã€å¹´è¼•äººèªªï¼šã€Œç©ºæ°£ï¼ã€æ™ºè€…å¾®ç¬‘ï¼šã€Œç•¶ä½ æ¸´æœ›æˆåŠŸå¦‚åŒæ¸´æœ›ç©ºæ°£ä¸€æ¨£å¼·çƒˆæ™‚ï¼Œä½ å°±æœƒæˆåŠŸã€‚ã€æˆåŠŸä¸æ˜¯é é‹æ°£ï¼Œè€Œæ˜¯é é‚£ä»½æ°¸ä¸æ”¾æ£„çš„æ¸´æœ›èˆ‡æ±ºå¿ƒã€‚\",  \r\n    \"ä¸€ä½è€è¾²å¤«çš„é©¢å­æ‰é€²æ¯äº•è£¡ã€‚è€è¾²å¤«æƒ³äº†å¾ˆä¹…ï¼Œæ±ºå®šæ”¾æ£„æ•‘æ´ï¼Œç›´æ¥æŠŠäº•å¡«å¹³ã€‚ç•¶æ³¥åœŸè½åœ¨é©¢å­èº«ä¸Šæ™‚ï¼Œé©¢å­èµ·åˆå¾ˆé©šæï¼Œä½†éš¨å¾Œç‰ åšäº†ä¸€å€‹æ±ºå®šï¼šæ¯æ¬¡æ³¥åœŸè½ä¸‹ï¼Œå°±æŠ–è½èº«ä¸Šçš„åœŸï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ä¸€éŸåˆä¸€éŸï¼Œé©¢å­ä¸æ–·å¾€ä¸Šå‡ã€‚æœ€å¾Œï¼Œç‰ è·³å‡ºäº†äº•å£ã€‚é‚£äº›æƒ³åŸ‹è‘¬ä½ çš„å›°é›£ï¼Œå…¶å¯¦éƒ½æ˜¯å¢Šé«˜ä½ çš„éšæ¢¯ã€‚\",\r\n    \"ç«¹å­åœ¨å‰å››å¹´åªé•·äº†ä¸‰å…¬åˆ†ï¼Œä½†å¾ç¬¬äº”å¹´é–‹å§‹ï¼Œæ¯å¤©ä»¥ä¸‰åå…¬åˆ†çš„é€Ÿåº¦ç˜‹ç‹‚ç”Ÿé•·ï¼Œåƒ…ç”¨å…­é€±å°±é•·åˆ°äº†åäº”å…¬å°ºã€‚åŸä¾†åœ¨å‰å››å¹´ï¼Œç«¹å­çš„æ ¹å·²ç¶“åœ¨åœŸå£¤è£¡å»¶ä¼¸äº†æ•¸ç™¾å¹³æ–¹å…¬å°ºã€‚äººç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¦æ“”å¿ƒä½ çš„ä»˜å‡ºæ²’æœ‰å›å ±ï¼Œä½ ç¾åœ¨åšçš„æ¯ä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯åœ¨æ‰æ ¹ã€‚æ™‚æ©Ÿä¸€åˆ°ï¼Œä½ æœƒæˆé•·å¾—æ¯”ä»»ä½•äººéƒ½å¿«ã€‚\",\r\n    \"æœ‰å€‹å°ç”·å­©å•çˆ¶è¦ªï¼šã€Œçˆ¸çˆ¸ï¼Œæˆ‘å€‘å®¶å¾ˆçª®å—ï¼Ÿã€çˆ¶è¦ªèªªï¼šã€Œä¸ï¼Œæˆ‘å€‘åªæ˜¯æš«æ™‚æ²’æœ‰éŒ¢ã€‚çª®æ˜¯ä¸€ç¨®å¿ƒæ…‹ï¼Œè€Œæ²’æœ‰éŒ¢åªæ˜¯ä¸€ç¨®ç‹€æ…‹ã€‚ç‹€æ…‹å¯ä»¥æ”¹è®Šï¼Œä½†å¦‚æœä½ èªå®šè‡ªå·±çª®ï¼Œå°±æœƒæ°¸é çª®ã€‚ã€å¤šå¹´å¾Œï¼Œé€™å€‹ç”·å­©æˆç‚ºæˆåŠŸçš„ä¼æ¥­å®¶ã€‚ä»–èªªï¼šã€Œçˆ¶è¦ªé‚£ç•ªè©±æ”¹è®Šäº†æˆ‘çš„ä¸€ç”Ÿã€‚æˆ‘å¾ä¸èªç‚ºè‡ªå·±æ˜¯çª®äººï¼Œæˆ‘åªæ˜¯é‚„åœ¨é€šå¾€å¯Œæœ‰çš„è·¯ä¸Šã€‚ã€\",\r\n    \"ä¸€ä½ç•«å®¶æŠŠä½œå“æ”¾åœ¨å»£å ´ä¸Šï¼Œè«‹è·¯äººç”¨ç´…ç­†åœˆå‡ºç¼ºé»ã€‚ä¸€å¤©å¾Œï¼Œç•«ä½œè¢«åœˆå¾—æ»¿æ»¿çš„ã€‚ä»–å¾ˆæ²®å–ªã€‚è€å¸«èªªï¼šã€Œå†ç•«ä¸€å¹…ï¼Œé€™æ¬¡è«‹è·¯äººåœˆå‡ºå„ªé»ã€‚ã€çµæœå„ªé»æ¯”ç¼ºé»é‚„å¤šã€‚è€å¸«èªªï¼šã€Œç„¡è«–ä½ åšä»€éº¼ï¼Œéƒ½æœƒæœ‰äººæ‰¹è©•ï¼Œä¹Ÿæœƒæœ‰äººæ¬£è³ã€‚ä½ è¦åšçš„ä¸æ˜¯è¨å¥½æ‰€æœ‰äººï¼Œè€Œæ˜¯ä¸æ–·ç²¾é€²ï¼Œè®“æ¬£è³ä½ çš„äººè¶Šä¾†è¶Šå¤šã€‚ã€\",\r\n    \r\n    # æ–°å¢å‹µå¿—å°æ•…äº‹\r\n    \"æ„›è¿ªç”Ÿåœ¨ç™¼æ˜ç‡ˆæ³¡å‰å¤±æ•—äº†ä¸€è¬æ¬¡ã€‚æœ‰äººå•ä»–ï¼šã€Œå¤±æ•—é€™éº¼å¤šæ¬¡ä¸ç°å¿ƒå—ï¼Ÿã€ä»–ç¬‘è‘—èªªï¼šã€Œæˆ‘æ²’æœ‰å¤±æ•—ï¼Œæˆ‘åªæ˜¯ç™¼ç¾äº†ä¸€è¬ç¨®ä¸èƒ½ç”¨çš„ææ–™ã€‚ã€æ¯ä¸€æ¬¡æ‰€è¬‚çš„å¤±æ•—ï¼Œéƒ½æ˜¯é€šå¾€æˆåŠŸçš„å¿…ç¶“ä¹‹è·¯ã€‚é‡é»ä¸æ˜¯è·Œå€’å¹¾æ¬¡ï¼Œè€Œæ˜¯ä½ é¡˜ä¸é¡˜æ„å†ç«™èµ·ä¾†ã€‚\",\r\n    \"å…©å€‹æ¨éŠ·å“¡è¢«æ´¾åˆ°éæ´²è³£é‹ã€‚ç¬¬ä¸€å€‹äººæŠµé”å¾Œç™¼é›»å ±å›å…¬å¸ï¼šã€Œé€™è£¡æ²’æœ‰å¸‚å ´ï¼Œå› ç‚ºæ‰€æœ‰äººéƒ½ä¸ç©¿é‹ã€‚ã€ç¬¬äºŒå€‹äººå»èˆˆå¥®åœ°å›å ±ï¼šã€Œé€™è£¡å•†æ©Ÿç„¡é™ï¼Œå› ç‚ºé‚„æ²’æœ‰äººç©¿é‹ï¼ã€åŒæ¨£çš„ç¾å¯¦ï¼Œä¸åŒçš„è¦–è§’ï¼Œé€ å°±æˆªç„¶ä¸åŒçš„å‘½é‹ã€‚ä½ çœ‹åˆ°çš„æ˜¯å›°é›£ï¼Œé‚„æ˜¯æ©Ÿæœƒï¼Ÿ\",\r\n    \"è€é·¹æ˜¯ä¸–ç•Œä¸Šå£½å‘½æœ€é•·çš„é³¥é¡ã€‚ä½†åœ¨ç‰  40 æ­²æ™‚ï¼Œçˆªå­æœƒé–‹å§‹è€åŒ–ã€å–™æœƒè®Šå¾—åˆé•·åˆå½ï¼Œç¾½æ¯›ä¹Ÿæœƒè®Šå¾—æ²‰é‡ã€‚é€™æ™‚ç‰ é¢è‡¨å…©å€‹é¸æ“‡ï¼šç­‰æ­»ï¼Œæˆ–æ˜¯ç¶“æ­· 150 å¤©ç—›è‹¦çš„ã€Œè›»è®Šã€ã€‚ ç‰ å¿…é ˆç”¨å–™æ“Šæ‰“å²©çŸ³ç›´åˆ°è„«è½ï¼Œé•·å‡ºæ–°å–™å¾Œï¼Œå†æŠŠè€åŒ–çš„è¶¾ç”²å’Œç¾½æ¯›ä¸€ä¸€æ‹”æ‰ã€‚é‡ç”Ÿå¾ˆç—›ï¼Œä½†ä¸é‡ç”Ÿå°±æ˜¯æ­»è·¯ä¸€æ¢ã€‚å¦‚æœä½ è¦ºå¾—ç¾ç‹€è®“ä½ çª’æ¯ï¼Œæˆ–è¨±æ˜¯å› ç‚ºä½ éœ€è¦ä¸€å ´å¾¹åº•çš„ã€Œè‡ªæˆ‘ä¿®å‰ªã€ï¼Œæ‹”æ‰é‚£äº›é™åˆ¶ä½ é£›ç¿”çš„è€èˆŠç¿’æ…£ã€‚\",\r\n    \"ä¸€ä½çˆ¶è¦ªé€å…’å­ä¸€å¡Šæ‰‹éŒ¶ï¼Œèªªï¼šã€Œé€™æ˜¯çˆºçˆºå‚³ä¸‹ä¾†çš„ï¼Œå…ˆå»ç•¶é‹ªå•å•å€¼å¤šå°‘éŒ¢ã€‚ã€ç•¶é‹ªçµ¦äº†ä¸€ç™¾å…ƒã€‚çˆ¶è¦ªåˆèªªï¼šã€Œå»å¤è‘£åº—å•å•ã€‚ã€å¤è‘£åº—é–‹åƒ¹åè¬ã€‚çˆ¶è¦ªèªªï¼šã€Œè¨˜ä½ï¼Œåªæœ‰åœ¨å°çš„åœ°æ–¹ï¼Œä½ çš„åƒ¹å€¼æ‰æœƒè¢«çœ‹è¦‹ã€‚ä¸è¦å¾…åœ¨ä¸æ‡‚å¾—æ¬£è³ä½ çš„ç’°å¢ƒè£¡ï¼Œé‚£åªæœƒè®“ä½ ä½ä¼°è‡ªå·±ã€‚ã€\",\r\n    \"æš´é¢¨é›¨å¾Œçš„æµ·ç˜ä¸Šï¼Œæˆåƒä¸Šè¬çš„æµ·æ˜Ÿè¢«æ²–ä¸Šå²¸ã€‚ä¸€å€‹å°ç”·å­©ä¸æ–·æ’¿èµ·æµ·æ˜Ÿä¸Ÿå›æµ·è£¡ã€‚è·¯äººèªªï¼šã€Œé€™éº¼å¤šæµ·æ˜Ÿï¼Œä½ æ•‘å¾—å®Œå—ï¼Ÿé€™æœ‰ä»€éº¼æ„ç¾©ï¼Ÿã€å°ç”·å­©æ’¿èµ·ä¸€éš»æµ·æ˜Ÿèªªï¼šã€Œå°é€™ä¸€éš»ä¾†èªªï¼Œå¾ˆæœ‰æ„ç¾©ã€‚ã€æ”¹è®Šä¸–ç•Œä¸éœ€è¦è½Ÿè½Ÿçƒˆçƒˆï¼Œæœ‰æ™‚åªéœ€è¦ä¸€å€‹å°å°çš„å–„èˆ‰ã€‚\",\r\n    \"é¦¬æˆ²åœ˜è£¡çš„å¤§è±¡ï¼Œå°æ™‚å€™è¢«ç´°ç¹©ç¶ä½ï¼Œæ™è„«ä¸äº†ã€‚é•·å¤§å¾ŒåŠ›æ°£è¶³ä»¥æ™æ–·éµéˆï¼Œå»ä»è¢«åŒä¸€æ¢ç´°ç¹©å›°ä½ï¼Œå› ç‚ºç‰ å·²ç¶“ç›¸ä¿¡è‡ªå·±æ™è„«ä¸äº†ã€‚æˆ‘å€‘æœ‰å¤šå°‘æ½›èƒ½ï¼Œæ˜¯è¢«éå»çš„å¤±æ•—ç¶“é©—æ‰€æŸç¸›ï¼ŸçœŸæ­£å›°ä½ä½ çš„ï¼Œå¾ä¾†ä¸æ˜¯ç’°å¢ƒï¼Œè€Œæ˜¯ä½ å¿ƒä¸­é‚£é“ç„¡å½¢çš„åœç‰†ã€‚\",\r\n    \"è´è¶ç ´ç¹­æ™‚ï¼Œæœ‰äººå‡ºæ–¼å¥½å¿ƒå¹«ç‰ å‰ªé–‹ç¹­ã€‚çµæœè´è¶å‡ºä¾†å¾Œç¿…è†€èç¸®ï¼Œæ°¸é ç„¡æ³•é£›ç¿”ã€‚åŸä¾†ï¼Œè´è¶å¿…é ˆé è‡ªå·±æ™æ‰çš„éç¨‹ï¼Œå°‡é«”æ¶²æ“ å…¥ç¿…è†€æ‰èƒ½å±•ç¿…ã€‚äººç”Ÿçš„æ™æ‰èˆ‡è‹¦é›£ï¼Œä¸æ˜¯æ‡²ç½°ï¼Œè€Œæ˜¯è®“æˆ‘å€‘èŒå£¯çš„å¿…è¦éç¨‹ã€‚\",\r\n    \"ä¸€ä½è€äººåœ¨è·¯é‚Šè³£æ°£çƒï¼Œç”Ÿæ„ä¸å¥½æ™‚å°±æ”¾ä¸€å€‹æ°£çƒä¸Šå¤©ã€‚æ¯æ¬¡æ°£çƒå‡ç©ºï¼Œå°±æœƒå¸å¼•å­©å­ä¾†è²·ã€‚ä¸€å€‹é»‘äººå°å­©å•ï¼šã€Œé»‘è‰²çš„æ°£çƒä¹Ÿèƒ½é£›å—ï¼Ÿã€è€äººå¾®ç¬‘è‘—æ”¾äº†ä¸€å€‹é»‘æ°£çƒï¼Œå®ƒåŒæ¨£é£›å‘å¤©ç©ºã€‚è€äººèªªï¼šã€Œå­©å­ï¼Œæ°£çƒèƒ½ä¸èƒ½é£›ï¼Œä¸æ˜¯çœ‹é¡è‰²ï¼Œè€Œæ˜¯çœ‹è£¡é¢æœ‰æ²’æœ‰æ°£ã€‚ã€æ±ºå®šä½ èƒ½é£›å¤šé«˜çš„ï¼Œæ˜¯ä½ å…§å¿ƒçš„åŠ›é‡ã€‚\",\r\n    \"ä¸€å€‹äººæŠ±æ€¨è‡ªå·±æ²’æœ‰é‹ç©¿ï¼Œç›´åˆ°ä»–é‡è¦‹ä¸€å€‹æ²’æœ‰è…³çš„äººã€‚é‚£äººååœ¨è·¯é‚Šï¼Œå¾®ç¬‘è‘—ç”¨é›™æ‰‹æ’åœ°å‰é€²ï¼Œçœ¼ä¸­æ²’æœ‰ä¸€çµ²æ€¨æ¨ã€‚ä»–çªç„¶æ˜ç™½ï¼šå¹¸ç¦ä¸æ˜¯æ“æœ‰å¤šå°‘ï¼Œè€Œæ˜¯è¨ˆè¼ƒå¤šå°‘ã€‚ç•¶ä½ é–‹å§‹æ„Ÿæ©å·²æ“æœ‰çš„ï¼Œä½ æœƒç™¼ç¾è‡ªå·±æ¯”æƒ³åƒä¸­å¯Œæœ‰ã€‚\",\r\n    \"æœ‰äººå•è¾²å¤«ï¼šã€Œä½ æ¯å¤©éƒ½åœ¨åšä»€éº¼ï¼Ÿã€è¾²å¤«èªªï¼šã€Œæ˜¥å¤©æ’­ç¨®ï¼Œå¤å¤©è€•è€˜ï¼Œç§‹å¤©æ”¶ç©«ï¼Œå†¬å¤©ä¼‘æ¯ã€‚ã€é‚£äººåˆå•ï¼šã€Œé‚£ä»€éº¼æ™‚å€™æ‰èƒ½æˆåŠŸï¼Ÿã€è¾²å¤«ç¬‘èªªï¼šã€ŒæˆåŠŸæ²’æœ‰æ·å¾‘ï¼Œä½†æœ‰æ™‚åˆ»è¡¨ã€‚ä½ ä¸èƒ½åœ¨å†¬å¤©æ’­ç¨®ï¼Œä¹Ÿä¸èƒ½åœ¨æ˜¥å¤©æ”¶ç©«ã€‚åšå°çš„äº‹ï¼Œåœ¨å°çš„æ™‚é–“ï¼ŒæˆåŠŸè‡ªç„¶æœƒä¾†ã€‚ã€\",\r\n    \"å…©æ£µæ¨¹ç”Ÿé•·åœ¨æ‡¸å´–é‚Šã€‚ä¸€æ£µæŠ±æ€¨é¢¨å¤ªå¤§ã€åœŸå¤ªå°‘ï¼Œæœ€çµ‚æ¯èã€‚å¦ä¸€æ£µæŠŠæ ¹æ·±æ·±æ‰é€²å²©ç¸«ï¼Œåè€Œé•·å¾—æ›´åŠ å …éŸŒã€‚å¤šå¹´å¾Œï¼Œå®ƒæˆäº†æ‡¸å´–ä¸Šæœ€å£¯è§€çš„é¢¨æ™¯ã€‚æƒ¡åŠ£çš„ç’°å¢ƒä¸ä¸€å®šæ˜¯è©›å’’ï¼Œä¹Ÿå¯èƒ½æ˜¯è®“ä½ èˆ‡çœ¾ä¸åŒçš„ç¥ç¦ã€‚\",\r\n    \"ä¸‰éš»é’è›™ååœ¨è·è‘‰ä¸Šï¼Œå…¶ä¸­ä¸€éš»æ±ºå®šè·³é€²æ°´è£¡ã€‚è«‹å•è·è‘‰ä¸Šé‚„æœ‰å¹¾éš»é’è›™ï¼Ÿç­”æ¡ˆæ˜¯ä¸‰éš»ã€‚å› ç‚ºã€Œæ±ºå®šã€å’Œã€Œè¡Œå‹•ã€æ˜¯å…©å›äº‹ã€‚é€™å€‹ä¸–ç•Œä¸Šä¸ç¼ºæœ‰æƒ³æ³•çš„äººï¼Œç¼ºçš„æ˜¯æŠŠæƒ³æ³•ä»˜è«¸è¡Œå‹•çš„äººã€‚åˆ¥åªæ˜¯æƒ³ï¼Œå»åšå§ã€‚\"\r\n  ),\r\n  author = c(\r\n    #20260131\r\n    \"æ¨µå¤«æ¯”è³½çš„æ•…äº‹\",\r\n    \"æ‰‹è£¡æ°´çš„æ•…äº‹\",\r\n    \"å¤±è°é’è›™çš„æ•…äº‹\",\r\n    \"åŠæ©‹çš„æ•…äº‹\",\r\n    \"è·³èš¤çš„æ•…äº‹\",\r\n    \"å†°å±±çš„æ•…äº‹\",\r\n    \"çª—å¤–çš„æ•…äº‹\",\r\n    \"ç´å¼¦çš„æ•…äº‹\",\r\n    \r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ™ºè€…èˆ‡æ²³çš„æ•…äº‹\",\r\n    \"é©¢å­èˆ‡æ¯äº•çš„æ•…äº‹\",\r\n    \"ç«¹å­çš„å•Ÿç¤º\",\r\n    \"çª®èˆ‡æ²’éŒ¢çš„æ•…äº‹\",\r\n    \"ç•«å®¶èˆ‡è·¯äººçš„æ•…äº‹\",\r\n    \"æ„›è¿ªç”Ÿçš„ç‡ˆæ³¡\",\r\n    \"éæ´²è³£é‹çš„æ•…äº‹\",\r\n    \"è€é·¹é‡ç”Ÿçš„æ•…äº‹\",\r\n    \"æ‰‹éŒ¶èˆ‡åƒ¹å€¼çš„æ•…äº‹\",\r\n    \"æµ·æ˜Ÿç”·å­©çš„æ•…äº‹\",\r\n    \"é¦¬æˆ²åœ˜å¤§è±¡çš„æ•…äº‹\",\r\n    \"è´è¶ç ´ç¹­çš„æ•…äº‹\",\r\n    \"æ°£çƒè€äººçš„æ•…äº‹\",\r\n    \"æ²’æœ‰é‹çš„äºº\",\r\n    \"è¾²å¤«çš„æ™‚åˆ»è¡¨\",\r\n    \"æ‡¸å´–é‚Šçš„å…©æ£µæ¨¹\",\r\n    \"ä¸‰éš»é’è›™çš„æ•…äº‹\"\r\n  ),\r\n  category = c(\r\n    #20260131\r\n    \"å°ˆæ³¨\",\r\n    \"é‡é‡\",\r\n    \"å™ªéŸ³\",\r\n    \"å‹‡æ°£\",\r\n    \"æ¡†æ¶\",\r\n    \"æ½›åŠ›\",\r\n    \"è¦–è§’\",\r\n    \"å¹³è¡¡\",\r\n\r\n    \"å‹‡æ°£\", \"è‡ªçœ\", \"è¡Œå‹•\", \"æ™‚é–“\", \"å¤¢æƒ³\",\r\n    \"åŠªåŠ›\", \"æ¯…åŠ›\", \"åˆå¿ƒ\", \"æˆé•·\", \"è‡ªä¿¡\",\r\n    \"æ¸´æœ›\", \"é€†å¢ƒ\", \"è€å¿ƒ\", \"å¿ƒæ…‹\", \"æ‰¹è©•\",\r\n    \"å …æŒ\", \"è¦–è§’\", \"é‡ç”Ÿ\", \"åƒ¹å€¼\", \"å–„è‰¯\",\r\n    \"æ½›èƒ½\", \"ç£¨ç·´\", \"å…§åœ¨\", \"æ„Ÿæ©\", \"æ™‚æ©Ÿ\",\r\n    \"éŸŒæ€§\", \"è¡Œå‹•\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0a0a0f\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    # å¼•å…¥å„ªé›…çš„ä¸­æ–‡å­—é«”\r\n    tags$link(\r\n      href = \"https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500;600&family=LXGW+WenKai+TC:wght@300;400&display=swap\",\r\n      rel = \"stylesheet\"\r\n    ),\r\n    tags$style(HTML(\"\r\n      /* ===== å…¨åŸŸæ¨£å¼ ===== */\r\n      * {\r\n        margin: 0;\r\n        padding: 0;\r\n        box-sizing: border-box;\r\n      }\r\n      \r\n      body {\r\n        background: #0a0a0f;\r\n        min-height: 100vh;\r\n        font-family: 'LXGW WenKai TC', 'Noto Serif TC', serif;\r\n        overflow-x: hidden;\r\n      }\r\n      \r\n      /* ===== å‹•æ…‹èƒŒæ™¯ ===== */\r\n      .bg-container {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 0;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .bg-gradient {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: \r\n          radial-gradient(ellipse at 20% 20%, rgba(120, 80, 160, 0.15) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 80% 80%, rgba(80, 120, 180, 0.12) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 50% 50%, rgba(60, 60, 80, 0.1) 0%, transparent 70%);\r\n      }\r\n      \r\n      /* æµ®å‹•å…‰é» */\r\n      .floating-orb {\r\n        position: absolute;\r\n        border-radius: 50%;\r\n        filter: blur(60px);\r\n        animation: float 20s infinite ease-in-out;\r\n        opacity: 0.4;\r\n      }\r\n      \r\n      .orb-1 {\r\n        width: 400px;\r\n        height: 400px;\r\n        background: linear-gradient(135deg, #6366f1, #8b5cf6);\r\n        top: -10%;\r\n        left: -5%;\r\n        animation-delay: 0s;\r\n      }\r\n      \r\n      .orb-2 {\r\n        width: 350px;\r\n        height: 350px;\r\n        background: linear-gradient(135deg, #0ea5e9, #06b6d4);\r\n        bottom: -10%;\r\n        right: -5%;\r\n        animation-delay: -7s;\r\n      }\r\n      \r\n      .orb-3 {\r\n        width: 250px;\r\n        height: 250px;\r\n        background: linear-gradient(135deg, #f59e0b, #ef4444);\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        animation-delay: -14s;\r\n        opacity: 0.2;\r\n      }\r\n      \r\n      @keyframes float {\r\n        0%, 100% { transform: translate(0, 0) scale(1); }\r\n        25% { transform: translate(30px, -30px) scale(1.05); }\r\n        50% { transform: translate(-20px, 20px) scale(0.95); }\r\n        75% { transform: translate(20px, 30px) scale(1.02); }\r\n      }\r\n      \r\n      /* æ˜Ÿæ˜Ÿç²’å­ */\r\n      .stars {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-image: \r\n          radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),\r\n          radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.4), transparent),\r\n          radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 160px 120px, rgba(255,255,255,0.3), transparent);\r\n        background-repeat: repeat;\r\n        background-size: 200px 200px;\r\n        animation: twinkle 8s infinite;\r\n      }\r\n      \r\n      @keyframes twinkle {\r\n        0%, 100% { opacity: 0.5; }\r\n        50% { opacity: 1; }\r\n      }\r\n      \r\n      /* ===== ä¸»å®¹å™¨ ===== */\r\n      .main-container {\r\n        position: relative;\r\n        z-index: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 100vh;\r\n        padding: 1.5rem;\r\n      }\r\n      \r\n      /* ===== æ¨™é¡Œå€ ===== */\r\n      .header {\r\n        text-align: center;\r\n        margin-bottom: 2rem;\r\n      }\r\n      \r\n      .main-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: clamp(1.5rem, 4vw, 2.2rem);\r\n        font-weight: 300;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.3em;\r\n        margin-bottom: 0.5rem;\r\n        text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .sub-title {\r\n        font-size: 0.85rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.2em;\r\n        font-weight: 300;\r\n      }\r\n      \r\n      /* ===== å¡ç‰‡ä¸»é«” ===== */\r\n      .quote-card {\r\n        position: relative;\r\n        background: linear-gradient(\r\n          135deg,\r\n          rgba(255, 255, 255, 0.03) 0%,\r\n          rgba(255, 255, 255, 0.08) 50%,\r\n          rgba(255, 255, 255, 0.03) 100%\r\n        );\r\n        backdrop-filter: blur(20px);\r\n        -webkit-backdrop-filter: blur(20px);\r\n        border-radius: 24px;\r\n        padding: clamp(2rem, 5vw, 3.5rem);\r\n        max-width: 850px;\r\n        width: 100%;\r\n        border: 1px solid rgba(255, 255, 255, 0.08);\r\n        box-shadow: \r\n          0 25px 50px -12px rgba(0, 0, 0, 0.5),\r\n          inset 0 1px 0 rgba(255, 255, 255, 0.1);\r\n        animation: cardEnter 1s cubic-bezier(0.16, 1, 0.3, 1);\r\n      }\r\n      \r\n      @keyframes cardEnter {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(40px) scale(0.95);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0) scale(1);\r\n        }\r\n      }\r\n      \r\n      /* å¡ç‰‡é ‚éƒ¨è£é£¾ç·š */\r\n      .quote-card::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        width: 60%;\r\n        height: 1px;\r\n        background: linear-gradient(\r\n          90deg,\r\n          transparent,\r\n          rgba(139, 92, 246, 0.5),\r\n          rgba(236, 72, 153, 0.5),\r\n          transparent\r\n        );\r\n      }\r\n      \r\n      /* ===== åˆ†é¡æ¨™ç±¤ ===== */\r\n      .category-tag {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 0.4rem;\r\n        padding: 0.4rem 1rem;\r\n        background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2));\r\n        border: 1px solid rgba(139, 92, 246, 0.3);\r\n        border-radius: 20px;\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .category-icon {\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      /* ===== å¼•è™Ÿè£é£¾ ===== */\r\n      .quote-mark {\r\n        font-family: Georgia, serif;\r\n        font-size: 4rem;\r\n        line-height: 1;\r\n        color: rgba(139, 92, 246, 0.3);\r\n        margin-bottom: -1rem;\r\n        user-select: none;\r\n      }\r\n      \r\n      /* ===== èªéŒ„æ–‡å­— ===== */\r\n      .quote-wrapper {\r\n        position: relative;\r\n        min-height: 120px;\r\n      }\r\n      \r\n      .quote-text {\r\n        font-family: 'Noto Serif TC', serif;\r\n        color: rgba(255, 255, 255, 0.95);\r\n        margin-bottom: 1.5rem;\r\n        animation: textFade 0.8s ease-out;\r\n      }\r\n      \r\n      @keyframes textFade {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(10px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n      \r\n      /* çŸ­èªéŒ„ */\r\n      .quote-text.short {\r\n        font-size: clamp(1.4rem, 3vw, 1.9rem);\r\n        font-weight: 400;\r\n        line-height: 2;\r\n        letter-spacing: 0.08em;\r\n        text-align: center;\r\n      }\r\n      \r\n      /* ä¸­ç­‰é•·åº¦ */\r\n      .quote-text.medium {\r\n        font-size: clamp(1.1rem, 2.2vw, 1.35rem);\r\n        font-weight: 400;\r\n        line-height: 2.2;\r\n        letter-spacing: 0.05em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* é•·æ•…äº‹ */\r\n      .quote-text.long {\r\n        font-size: clamp(1rem, 1.8vw, 1.15rem);\r\n        font-weight: 400;\r\n        line-height: 2.4;\r\n        letter-spacing: 0.03em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* ===== ä½œè€…å€ ===== */\r\n      .author-section {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        padding-top: 1.5rem;\r\n        border-top: 1px solid rgba(255, 255, 255, 0.08);\r\n        animation: authorFade 0.8s ease-out 0.3s both;\r\n      }\r\n      \r\n      @keyframes authorFade {\r\n        from { opacity: 0; }\r\n        to { opacity: 1; }\r\n      }\r\n      \r\n      .author-line {\r\n        width: 30px;\r\n        height: 1px;\r\n        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));\r\n      }\r\n      \r\n      .author-line:last-child {\r\n        background: linear-gradient(90deg, rgba(255, 255, 255, 0.4), transparent);\r\n      }\r\n      \r\n      .quote-author {\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 1rem;\r\n        color: rgba(255, 255, 255, 0.6);\r\n        font-style: normal;\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      /* ===== å­—æ•¸é¡¯ç¤º ===== */\r\n      .char-count {\r\n        text-align: center;\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        margin-top: 1rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      /* ===== æŒ‰éˆ•å€ ===== */\r\n      .button-group {\r\n        display: flex;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        margin-top: 2rem;\r\n        flex-wrap: wrap;\r\n      }\r\n      \r\n      .action-btn {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 0.5rem;\r\n        padding: 0.9rem 1.8rem;\r\n        border-radius: 50px;\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 0.95rem;\r\n        letter-spacing: 0.1em;\r\n        cursor: pointer;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border: none;\r\n        outline: none;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);\r\n        color: white;\r\n        box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: translateY(-3px) scale(1.02);\r\n        box-shadow: 0 8px 30px rgba(99, 102, 241, 0.5);\r\n      }\r\n      \r\n      .refresh-btn:active {\r\n        transform: translateY(0) scale(0.98);\r\n      }\r\n      \r\n      .secondary-btn {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        color: rgba(255, 255, 255, 0.7);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .secondary-btn:hover {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        color: white;\r\n        transform: translateY(-2px);\r\n      }\r\n      \r\n      .secondary-btn.active {\r\n        background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(239, 68, 68, 0.2));\r\n        border-color: rgba(236, 72, 153, 0.4);\r\n        color: #f472b6;\r\n      }\r\n      \r\n      /* ===== é€²åº¦æ¢ ===== */\r\n      .progress-section {\r\n        margin-top: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .progress-bar-container {\r\n        width: 100%;\r\n        max-width: 300px;\r\n        height: 3px;\r\n        background: rgba(255, 255, 255, 0.1);\r\n        border-radius: 3px;\r\n        margin: 0 auto 0.8rem;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .progress-bar-fill {\r\n        height: 100%;\r\n        background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);\r\n        border-radius: 3px;\r\n        transition: width 1s linear;\r\n      }\r\n      \r\n      .timer-text {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      .countdown {\r\n        font-family: 'SF Mono', 'Consolas', monospace;\r\n        color: rgba(255, 255, 255, 0.6);\r\n      }\r\n      \r\n      /* ===== æ”¶è—åˆ—è¡¨ Modal ===== */\r\n      .favorites-panel {\r\n        position: fixed;\r\n        top: 0;\r\n        right: -400px;\r\n        width: 380px;\r\n        max-width: 90vw;\r\n        height: 100vh;\r\n        background: linear-gradient(180deg, rgba(15, 15, 25, 0.98), rgba(10, 10, 15, 0.98));\r\n        backdrop-filter: blur(20px);\r\n        z-index: 1000;\r\n        padding: 2rem;\r\n        overflow-y: auto;\r\n        transition: right 0.5s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border-left: 1px solid rgba(255, 255, 255, 0.1);\r\n        box-shadow: -10px 0 40px rgba(0, 0, 0, 0.5);\r\n      }\r\n      \r\n      .favorites-panel.open {\r\n        right: 0;\r\n      }\r\n      \r\n      .panel-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-bottom: 2rem;\r\n        padding-bottom: 1rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .panel-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: 1.3rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .close-btn {\r\n        background: none;\r\n        border: none;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 1.5rem;\r\n        cursor: pointer;\r\n        padding: 0.5rem;\r\n        transition: color 0.3s;\r\n      }\r\n      \r\n      .close-btn:hover {\r\n        color: white;\r\n      }\r\n      \r\n      .favorite-item {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        border-radius: 12px;\r\n        padding: 1.2rem;\r\n        margin-bottom: 1rem;\r\n        border: 1px solid rgba(255, 255, 255, 0.05);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .favorite-item:hover {\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border-color: rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .favorite-quote {\r\n        font-size: 0.9rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        line-height: 1.8;\r\n        margin-bottom: 0.8rem;\r\n      }\r\n      \r\n      .favorite-author {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        text-align: right;\r\n      }\r\n      \r\n      .empty-favorites {\r\n        text-align: center;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        padding: 3rem 1rem;\r\n        font-size: 0.9rem;\r\n        line-height: 1.8;\r\n      }\r\n      \r\n      /* ===== é®ç½©å±¤ ===== */\r\n      .overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        z-index: 999;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .overlay.show {\r\n        opacity: 1;\r\n        visibility: visible;\r\n      }\r\n      \r\n      /* ===== å¿«æ·éµæç¤º (å·¦å´) ===== */\r\n      .shortcut-hint {\r\n        position: fixed;\r\n        left: 1.5rem;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.5rem;\r\n        z-index: 100;\r\n      }\r\n      \r\n      .shortcut-panel {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        backdrop-filter: blur(10px);\r\n        border: 1px solid rgba(255, 255, 255, 0.06);\r\n        border-radius: 12px;\r\n        padding: 1rem 0.8rem;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.6rem;\r\n      }\r\n      \r\n      .shortcut-title {\r\n        font-size: 0.65rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        letter-spacing: 0.15em;\r\n        text-transform: uppercase;\r\n        margin-bottom: 0.3rem;\r\n        padding-bottom: 0.5rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.06);\r\n      }\r\n      \r\n      .shortcut-item {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 0.6rem;\r\n        padding: 0.3rem 0;\r\n        transition: all 0.3s ease;\r\n        border-radius: 6px;\r\n        cursor: default;\r\n      }\r\n      \r\n      .shortcut-item:hover {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        padding-left: 0.4rem;\r\n        padding-right: 0.4rem;\r\n        margin-left: -0.4rem;\r\n        margin-right: -0.4rem;\r\n      }\r\n      \r\n      .shortcut-item:hover .key {\r\n        background: rgba(139, 92, 246, 0.3);\r\n        border-color: rgba(139, 92, 246, 0.5);\r\n        color: rgba(255, 255, 255, 0.9);\r\n      }\r\n      \r\n      .shortcut-item:hover .shortcut-label {\r\n        color: rgba(255, 255, 255, 0.7);\r\n      }\r\n      \r\n      .key {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        min-width: 28px;\r\n        height: 26px;\r\n        padding: 0 8px;\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        border-radius: 6px;\r\n        font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;\r\n        font-size: 0.7rem;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .shortcut-label {\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.05em;\r\n        transition: color 0.3s ease;\r\n      }\r\n      \r\n      /* ===== é€šçŸ¥æç¤º ===== */\r\n      .toast {\r\n        position: fixed;\r\n        bottom: 80px;\r\n        left: 50%;\r\n        transform: translateX(-50%) translateY(100px);\r\n        background: rgba(20, 20, 30, 0.95);\r\n        backdrop-filter: blur(10px);\r\n        padding: 0.8rem 1.5rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 0.9rem;\r\n        letter-spacing: 0.05em;\r\n        opacity: 0;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        z-index: 2000;\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .toast.show {\r\n        opacity: 1;\r\n        transform: translateX(-50%) translateY(0);\r\n      }\r\n      \r\n      /* ===== éŸ¿æ‡‰å¼è¨­è¨ˆ ===== */\r\n      @media (max-width: 768px) {\r\n        .main-container {\r\n          padding: 1rem;\r\n        }\r\n        \r\n        .quote-card {\r\n          padding: 1.5rem;\r\n          border-radius: 16px;\r\n        }\r\n        \r\n        .quote-mark {\r\n          font-size: 3rem;\r\n        }\r\n        \r\n        .button-group {\r\n          flex-direction: column;\r\n          align-items: stretch;\r\n        }\r\n        \r\n        .action-btn {\r\n          width: 100%;\r\n        }\r\n        \r\n        .shortcut-hint {\r\n          display: none;\r\n        }\r\n        \r\n        .favorites-panel {\r\n          width: 100%;\r\n          right: -100%;\r\n        }\r\n      }\r\n      \r\n      @media (max-width: 1100px) {\r\n        .shortcut-hint {\r\n          left: 0.8rem;\r\n        }\r\n        \r\n        .shortcut-panel {\r\n          padding: 0.7rem 0.5rem;\r\n        }\r\n        \r\n        .shortcut-label {\r\n          display: none;\r\n        }\r\n        \r\n        .shortcut-title {\r\n          font-size: 0.55rem;\r\n          text-align: center;\r\n        }\r\n      }\r\n      \r\n      /* ===== æ·±è‰²ä¸»é¡Œæ»¾å‹•æ¢ ===== */\r\n      ::-webkit-scrollbar {\r\n        width: 6px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-track {\r\n        background: rgba(255, 255, 255, 0.05);\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb {\r\n        background: rgba(255, 255, 255, 0.2);\r\n        border-radius: 3px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb:hover {\r\n        background: rgba(255, 255, 255, 0.3);\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  # èƒŒæ™¯å±¤\r\n  div(class = \"bg-container\",\r\n    div(class = \"bg-gradient\"),\r\n    div(class = \"floating-orb orb-1\"),\r\n    div(class = \"floating-orb orb-2\"),\r\n    div(class = \"floating-orb orb-3\"),\r\n    div(class = \"stars\")\r\n  ),\r\n  \r\n  # ä¸»å…§å®¹\r\n  div(class = \"main-container\",\r\n    # æ¨™é¡Œ\r\n    div(class = \"header\",\r\n      h1(class = \"main-title\", \"å¿ƒéˆé©›ç«™\"),\r\n      p(class = \"sub-title\", \"DAILY INSPIRATIONS\")\r\n    ),\r\n    \r\n    # èªéŒ„å¡ç‰‡\r\n    div(class = \"quote-card\",\r\n      # åˆ†é¡æ¨™ç±¤\r\n      uiOutput(\"category_tag\"),\r\n      \r\n      # å¼•è™Ÿè£é£¾\r\n      div(class = \"quote-mark\", \"ã€Œ\"),\r\n      \r\n      # èªéŒ„å…§å®¹\r\n      div(class = \"quote-wrapper\",\r\n        uiOutput(\"quote_display\")\r\n      ),\r\n      \r\n      # ä½œè€…\r\n      div(class = \"author-section\",\r\n        span(class = \"author-line\"),\r\n        span(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n        span(class = \"author-line\")\r\n      ),\r\n      \r\n      # å­—æ•¸\r\n      div(class = \"char-count\", textOutput(\"char_count\", inline = TRUE)),\r\n      \r\n      # æŒ‰éˆ•çµ„\r\n      div(class = \"button-group\",\r\n        actionButton(\"refresh\", \r\n          tagList(icon(\"rotate\"), \"æ›ä¸€å‰‡\"),\r\n          class = \"action-btn refresh-btn\"\r\n        ),\r\n        actionButton(\"favorite\", \r\n          tagList(uiOutput(\"fav_icon\", inline = TRUE), \"æ”¶è—\"),\r\n          class = \"action-btn secondary-btn\"\r\n        ),\r\n        actionButton(\"show_favorites\", \r\n          tagList(icon(\"heart\"), \"æ”¶è—å¤¾\"),\r\n          class = \"action-btn secondary-btn\"\r\n        )\r\n      ),\r\n      \r\n      # é€²åº¦æ¢\r\n      div(class = \"progress-section\",\r\n        div(class = \"progress-bar-container\",\r\n          div(id = \"progress-fill\", class = \"progress-bar-fill\", style = \"width: 100%;\")\r\n        ),\r\n        div(class = \"timer-text\",\r\n          \"ä¸‹ä¸€å‰‡ï¼š\",\r\n          span(class = \"countdown\", textOutput(\"countdown\", inline = TRUE))\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # æ”¶è—é¢æ¿é®ç½©\r\n  div(id = \"overlay\", class = \"overlay\"),\r\n  \r\n  # æ”¶è—é¢æ¿\r\n  div(id = \"favorites-panel\", class = \"favorites-panel\",\r\n    div(class = \"panel-header\",\r\n      span(class = \"panel-title\", \"ğŸ’œ æˆ‘çš„æ”¶è—\"),\r\n      actionButton(\"close_panel\", \"Ã—\", class = \"close-btn\")\r\n    ),\r\n    uiOutput(\"favorites_list\")\r\n  ),\r\n  \r\n  # Toast é€šçŸ¥\r\n  div(id = \"toast\", class = \"toast\", textOutput(\"toast_message\", inline = TRUE)),\r\n  \r\n  # å¿«æ·éµæç¤º (å·¦å´)\r\n  div(class = \"shortcut-hint\",\r\n    div(class = \"shortcut-panel\",\r\n      div(class = \"shortcut-title\", \"å¿«æ·éµ\"),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Space\"),\r\n        span(class = \"shortcut-label\", \"æ›ä¸€å‰‡\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"F\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"L\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—å¤¾\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Esc\"),\r\n        span(class = \"shortcut-label\", \"é—œé–‰\")\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # JavaScript\r\n  tags$script(HTML(\"\r\n    // éµç›¤å¿«æ·éµ\r\n    document.addEventListener('keydown', function(e) {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\r\n      \r\n      if (e.code === 'Space') {\r\n        e.preventDefault();\r\n        document.getElementById('refresh').click();\r\n      } else if (e.key.toLowerCase() === 'f') {\r\n        document.getElementById('favorite').click();\r\n      } else if (e.key.toLowerCase() === 'l') {\r\n        document.getElementById('show_favorites').click();\r\n      } else if (e.key === 'Escape') {\r\n        document.getElementById('close_panel').click();\r\n      }\r\n    });\r\n    \r\n    // æ”¶è—é¢æ¿æ§åˆ¶\r\n    Shiny.addCustomMessageHandler('togglePanel', function(open) {\r\n      var panel = document.getElementById('favorites-panel');\r\n      var overlay = document.getElementById('overlay');\r\n      if (open) {\r\n        panel.classList.add('open');\r\n        overlay.classList.add('show');\r\n      } else {\r\n        panel.classList.remove('open');\r\n        overlay.classList.remove('show');\r\n      }\r\n    });\r\n    \r\n    // é»æ“Šé®ç½©é—œé–‰é¢æ¿\r\n    document.getElementById('overlay').addEventListener('click', function() {\r\n      document.getElementById('close_panel').click();\r\n    });\r\n    \r\n    // Toast é€šçŸ¥\r\n    Shiny.addCustomMessageHandler('showToast', function(message) {\r\n      var toast = document.getElementById('toast');\r\n      document.getElementById('toast_message').innerText = message;\r\n      toast.classList.add('show');\r\n      setTimeout(function() {\r\n        toast.classList.remove('show');\r\n      }, 2500);\r\n    });\r\n    \r\n    // æ›´æ–°é€²åº¦æ¢\r\n    Shiny.addCustomMessageHandler('updateProgress', function(percent) {\r\n      document.getElementById('progress-fill').style.width = percent + '%';\r\n    });\r\n  \"))\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  favorites <- reactiveVal(integer(0))\r\n  \r\n  # è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  total_time <- 600\r\n  \r\n  # Toast è¨Šæ¯\r\n  toast_msg <- reactiveVal(\"\")\r\n  \r\n  # æ¯ç§’æ›´æ–°\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n        # æ›´æ–°é€²åº¦æ¢\r\n        percent <- (t / total_time) * 100\r\n        session$sendCustomMessage(\"updateProgress\", percent)\r\n      } else {\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(total_time)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(total_time)\r\n  })\r\n  \r\n  # æ”¶è—/å–æ¶ˆæ”¶è—\r\n  observeEvent(input$favorite, {\r\n    idx <- current_index()\r\n    fav <- favorites()\r\n    \r\n    if (idx %in% fav) {\r\n      favorites(setdiff(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²å¾æ”¶è—å¤¾ç§»é™¤\")\r\n    } else {\r\n      favorites(c(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²åŠ å…¥æ”¶è—å¤¾ ğŸ’œ\")\r\n    }\r\n  })\r\n  \r\n  # é¡¯ç¤ºæ”¶è—é¢æ¿\r\n  observeEvent(input$show_favorites, {\r\n    session$sendCustomMessage(\"togglePanel\", TRUE)\r\n  })\r\n  \r\n  # é—œé–‰æ”¶è—é¢æ¿\r\n  observeEvent(input$close_panel, {\r\n    session$sendCustomMessage(\"togglePanel\", FALSE)\r\n  })\r\n  \r\n  # ç²å–å°ºå¯¸é¡åˆ¥\r\n  get_size_class <- function(text) {\r\n    n <- nchar(text)\r\n    if (n <= 100) \"short\"\r\n    else if (n <= 200) \"medium\"\r\n    else \"long\"\r\n  }\r\n  \r\n  # åˆ†é¡æ¨™ç±¤\r\n  output$category_tag <- renderUI({\r\n    cat <- quotes$category[current_index()]\r\n    icons <- list(\r\n      \"å‹‡æ°£\" = \"ğŸ¦\", \"è‡ªçœ\" = \"ğŸª\", \"è¡Œå‹•\" = \"ğŸš€\", \"æ™‚é–“\" = \"â°\", \"å¤¢æƒ³\" = \"âœ¨\",\r\n      \"åŠªåŠ›\" = \"ğŸ’ª\", \"æ¯…åŠ›\" = \"ğŸ”ï¸\", \"åˆå¿ƒ\" = \"ğŸŒ±\", \"æˆé•·\" = \"ğŸŒ³\", \"è‡ªä¿¡\" = \"ğŸ‘‘\",\r\n      \"æ¸´æœ›\" = \"ğŸ”¥\", \"é€†å¢ƒ\" = \"ğŸŒŠ\", \"è€å¿ƒ\" = \"ğŸ‹\", \"å¿ƒæ…‹\" = \"ğŸ§ \", \"æ‰¹è©•\" = \"ğŸ¨\",\r\n      \"å …æŒ\" = \"ğŸ’\", \"è¦–è§’\" = \"ğŸ‘ï¸\", \"é‡ç”Ÿ\" = \"ğŸ¦…\", \"åƒ¹å€¼\" = \"âŒš\", \"å–„è‰¯\" = \"ğŸŒŸ\",\r\n      \"æ½›èƒ½\" = \"ğŸ˜\", \"ç£¨ç·´\" = \"ğŸ¦‹\", \"å…§åœ¨\" = \"ğŸˆ\", \"æ„Ÿæ©\" = \"ğŸ™\", \"æ™‚æ©Ÿ\" = \"ğŸŒ¾\",\r\n      \"éŸŒæ€§\" = \"ğŸŒ²\"\r\n    )\r\n    icon <- icons[[cat]] %||% \"ğŸ’«\"\r\n    \r\n    div(class = \"category-tag\",\r\n      span(class = \"category-icon\", icon),\r\n      cat\r\n    )\r\n  })\r\n  \r\n  # é¡¯ç¤ºèªéŒ„\r\n  output$quote_display <- renderUI({\r\n    quote_text <- quotes$quote[current_index()]\r\n    size_class <- get_size_class(quote_text)\r\n    div(class = paste(\"quote-text\", size_class), quote_text)\r\n  })\r\n  \r\n  # ä½œè€…\r\n  output$quote_author <- renderText({\r\n    quotes$author[current_index()]\r\n  })\r\n  \r\n  # å­—æ•¸\r\n  output$char_count <- renderText({\r\n    paste0(\"å…± \", nchar(quotes$quote[current_index()]), \" å­—\")\r\n  })\r\n  \r\n  # æ”¶è—åœ–æ¨™\r\n  output$fav_icon <- renderUI({\r\n    if (current_index() %in% favorites()) {\r\n      icon(\"heart\", class = \"fas\", style = \"color: #f472b6;\")\r\n    } else {\r\n      icon(\"heart\", class = \"far\")\r\n    }\r\n  })\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    sprintf(\"%02d:%02d\", floor(t / 60), t %% 60)\r\n  })\r\n  \r\n  # Toast è¨Šæ¯è¼¸å‡º\r\n  output$toast_message <- renderText({\r\n    toast_msg()\r\n  })\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  output$favorites_list <- renderUI({\r\n    fav <- favorites()\r\n    \r\n    if (length(fav) == 0) {\r\n      return(div(class = \"empty-favorites\",\r\n        p(\"ğŸŒ™\"),\r\n        p(\"é‚„æ²’æœ‰æ”¶è—ä»»ä½•èªéŒ„\"),\r\n        p(\"é»æ“Šã€Œæ”¶è—ã€æŒ‰éˆ•æˆ–æŒ‰ F éµå³å¯æ”¶è—\")\r\n      ))\r\n    }\r\n    \r\n    tagList(\r\n      lapply(fav, function(idx) {\r\n        div(class = \"favorite-item\",\r\n          div(class = \"favorite-quote\",\r\n            substr(quotes$quote[idx], 1, 80),\r\n            if (nchar(quotes$quote[idx]) > 80) \"...\" else \"\"\r\n          ),\r\n          div(class = \"favorite-author\",\r\n            paste(\"â€”\", quotes$author[idx])\r\n          )\r\n        )\r\n      })\r\n    )\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"v1.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ (ä½ å¯ä»¥åœ¨é€™è£¡æ–°å¢æ›´å¤šèªéŒ„)\r\nquotes <- data.frame(\r\n  quote = c(\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\"\r\n  ),\r\n  author = c(\r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0f0c29\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    tags$style(HTML(\"\r\n      body {\r\n        background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);\r\n        min-height: 100vh;\r\n        font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;\r\n      }\r\n      \r\n      .quote-container {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 80vh;\r\n        padding: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .quote-card {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        backdrop-filter: blur(10px);\r\n        border-radius: 20px;\r\n        padding: 3rem;\r\n        max-width: 800px;\r\n        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        animation: fadeIn 1s ease-in-out;\r\n      }\r\n      \r\n      @keyframes fadeIn {\r\n        from { opacity: 0; transform: translateY(20px); }\r\n        to { opacity: 1; transform: translateY(0); }\r\n      }\r\n      \r\n      .quote-icon {\r\n        font-size: 4rem;\r\n        color: rgba(255, 215, 0, 0.8);\r\n        margin-bottom: 1rem;\r\n      }\r\n      \r\n      .quote-text {\r\n        font-size: 2rem;\r\n        font-weight: 300;\r\n        line-height: 1.8;\r\n        color: #ffffff;\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.05em;\r\n      }\r\n      \r\n      .quote-author {\r\n        font-size: 1.2rem;\r\n        color: rgba(255, 255, 255, 0.7);\r\n        font-style: italic;\r\n      }\r\n      \r\n      .timer-info {\r\n        margin-top: 2rem;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        margin-top: 1.5rem;\r\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n        border: none;\r\n        padding: 0.8rem 2rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 1rem;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: scale(1.05);\r\n        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);\r\n      }\r\n      \r\n      .title {\r\n        font-size: 1.5rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        margin-bottom: 2rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  div(class = \"quote-container\",\r\n    h1(class = \"title\", \"âœ¨ æ¯æ—¥å‹µå¿—èªéŒ„ âœ¨\"),\r\n    \r\n    div(class = \"quote-card\",\r\n      div(class = \"quote-icon\", \"â\"),\r\n      div(class = \"quote-text\", textOutput(\"quote_text\", inline = TRUE)),\r\n      div(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n      actionButton(\"refresh\", \"æ›ä¸€å¥\", class = \"refresh-btn\"),\r\n      div(class = \"timer-info\", \r\n        \"æ¯ 10 åˆ†é˜è‡ªå‹•æ›´æ› | ä¸‹æ¬¡æ›´æ›ï¼š\",\r\n        textOutput(\"countdown\", inline = TRUE)\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # å„²å­˜ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  \r\n  # æ¯ç§’æ›´æ–°å€’æ•¸\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n      } else {\r\n        # æ™‚é–“åˆ°ï¼Œæ›´æ›èªéŒ„\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(600)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°æŒ‰éˆ•\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(600)\r\n  })\r\n  \r\n  # é¡¯ç¤ºèªéŒ„\r\n  output$quote_text <- renderText({\r\n    quotes$quote[current_index()]\r\n  })\r\n  \r\n  # é¡¯ç¤ºä½œè€…\r\n  output$quote_author <- renderText({\r\n    paste(\"â€”\", quotes$author[current_index()])\r\n  })\r\n  \r\n  # é¡¯ç¤ºå€’æ•¸æ™‚é–“\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    mins <- floor(t / 60)\r\n    secs <- t %% 60\r\n    sprintf(\"%02d:%02d\", mins, secs)\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"v2.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ (ä½ å¯ä»¥åœ¨é€™è£¡æ–°å¢æ›´å¤šèªéŒ„)\r\nquotes <- data.frame(\r\n  quote = c(\r\n    # çŸ­èªéŒ„ (100å­—ä»¥å…§)\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\",\r\n    \r\n    # å°æ•…äº‹ (100-300å­—)\r\n    \"æœ‰å€‹å¹´è¼•äººå•æ™ºè€…ï¼šã€Œå¦‚ä½•æ‰èƒ½æˆåŠŸï¼Ÿã€æ™ºè€…å¸¶ä»–åˆ°æ²³é‚Šï¼Œçªç„¶æŠŠä»–çš„é ­æŒ‰å…¥æ°´ä¸­ã€‚å¹´è¼•äººæ‹¼å‘½æ™æ‰ï¼Œçµ‚æ–¼æ™è„«ã€‚æ™ºè€…å•ï¼šã€Œåœ¨æ°´è£¡æ™‚ï¼Œä½ æœ€æƒ³è¦ä»€éº¼ï¼Ÿã€å¹´è¼•äººèªªï¼šã€Œç©ºæ°£ï¼ã€æ™ºè€…å¾®ç¬‘ï¼šã€Œç•¶ä½ æ¸´æœ›æˆåŠŸå¦‚åŒæ¸´æœ›ç©ºæ°£ä¸€æ¨£å¼·çƒˆæ™‚ï¼Œä½ å°±æœƒæˆåŠŸã€‚ã€æˆåŠŸä¸æ˜¯é é‹æ°£ï¼Œè€Œæ˜¯é é‚£ä»½æ°¸ä¸æ”¾æ£„çš„æ¸´æœ›èˆ‡æ±ºå¿ƒã€‚\",\r\n    \r\n    \"ä¸€ä½è€è¾²å¤«çš„é©¢å­æ‰é€²æ¯äº•è£¡ã€‚è€è¾²å¤«æƒ³äº†å¾ˆä¹…ï¼Œæ±ºå®šæ”¾æ£„æ•‘æ´ï¼Œç›´æ¥æŠŠäº•å¡«å¹³ã€‚ç•¶æ³¥åœŸè½åœ¨é©¢å­èº«ä¸Šæ™‚ï¼Œé©¢å­èµ·åˆå¾ˆé©šæï¼Œä½†éš¨å¾Œç‰ åšäº†ä¸€å€‹æ±ºå®šï¼šæ¯æ¬¡æ³¥åœŸè½ä¸‹ï¼Œå°±æŠ–è½èº«ä¸Šçš„åœŸï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ä¸€éŸåˆä¸€éŸï¼Œé©¢å­ä¸æ–·å¾€ä¸Šå‡ã€‚æœ€å¾Œï¼Œç‰ è·³å‡ºäº†äº•å£ã€‚é‚£äº›æƒ³åŸ‹è‘¬ä½ çš„å›°é›£ï¼Œå…¶å¯¦éƒ½æ˜¯å¢Šé«˜ä½ çš„éšæ¢¯ã€‚\",\r\n    \r\n    \"ç«¹å­åœ¨å‰å››å¹´åªé•·äº†ä¸‰å…¬åˆ†ï¼Œä½†å¾ç¬¬äº”å¹´é–‹å§‹ï¼Œæ¯å¤©ä»¥ä¸‰åå…¬åˆ†çš„é€Ÿåº¦ç˜‹ç‹‚ç”Ÿé•·ï¼Œåƒ…ç”¨å…­é€±å°±é•·åˆ°äº†åäº”å…¬å°ºã€‚åŸä¾†åœ¨å‰å››å¹´ï¼Œç«¹å­çš„æ ¹å·²ç¶“åœ¨åœŸå£¤è£¡å»¶ä¼¸äº†æ•¸ç™¾å¹³æ–¹å…¬å°ºã€‚äººç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¦æ“”å¿ƒä½ çš„ä»˜å‡ºæ²’æœ‰å›å ±ï¼Œä½ ç¾åœ¨åšçš„æ¯ä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯åœ¨æ‰æ ¹ã€‚æ™‚æ©Ÿä¸€åˆ°ï¼Œä½ æœƒæˆé•·å¾—æ¯”ä»»ä½•äººéƒ½å¿«ã€‚\",\r\n    \r\n    \"æœ‰å€‹å°ç”·å­©å•çˆ¶è¦ªï¼šã€Œçˆ¸çˆ¸ï¼Œæˆ‘å€‘å®¶å¾ˆçª®å—ï¼Ÿã€çˆ¶è¦ªèªªï¼šã€Œä¸ï¼Œæˆ‘å€‘åªæ˜¯æš«æ™‚æ²’æœ‰éŒ¢ã€‚çª®æ˜¯ä¸€ç¨®å¿ƒæ…‹ï¼Œè€Œæ²’æœ‰éŒ¢åªæ˜¯ä¸€ç¨®ç‹€æ…‹ã€‚ç‹€æ…‹å¯ä»¥æ”¹è®Šï¼Œä½†å¦‚æœä½ èªå®šè‡ªå·±çª®ï¼Œå°±æœƒæ°¸é çª®ã€‚ã€å¤šå¹´å¾Œï¼Œé€™å€‹ç”·å­©æˆç‚ºæˆåŠŸçš„ä¼æ¥­å®¶ã€‚ä»–èªªï¼šã€Œçˆ¶è¦ªé‚£ç•ªè©±æ”¹è®Šäº†æˆ‘çš„ä¸€ç”Ÿã€‚æˆ‘å¾ä¸èªç‚ºè‡ªå·±æ˜¯çª®äººï¼Œæˆ‘åªæ˜¯é‚„åœ¨é€šå¾€å¯Œæœ‰çš„è·¯ä¸Šã€‚ã€\",\r\n    \r\n    \"ä¸€ä½ç•«å®¶æŠŠä½œå“æ”¾åœ¨å»£å ´ä¸Šï¼Œè«‹è·¯äººç”¨ç´…ç­†åœˆå‡ºç¼ºé»ã€‚ä¸€å¤©å¾Œï¼Œç•«ä½œè¢«åœˆå¾—æ»¿æ»¿çš„ã€‚ä»–å¾ˆæ²®å–ªã€‚è€å¸«èªªï¼šã€Œå†ç•«ä¸€å¹…ï¼Œé€™æ¬¡è«‹è·¯äººåœˆå‡ºå„ªé»ã€‚ã€çµæœå„ªé»æ¯”ç¼ºé»é‚„å¤šã€‚è€å¸«èªªï¼šã€Œç„¡è«–ä½ åšä»€éº¼ï¼Œéƒ½æœƒæœ‰äººæ‰¹è©•ï¼Œä¹Ÿæœƒæœ‰äººæ¬£è³ã€‚ä½ è¦åšçš„ä¸æ˜¯è¨å¥½æ‰€æœ‰äººï¼Œè€Œæ˜¯ä¸æ–·ç²¾é€²ï¼Œè®“æ¬£è³ä½ çš„äººè¶Šä¾†è¶Šå¤šã€‚ã€\"\r\n  ),\r\n  author = c(\r\n    # çŸ­èªéŒ„ä½œè€…\r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \r\n    # å°æ•…äº‹ä½œè€…/å‡ºè™•\r\n    \"æ™ºè€…èˆ‡æ²³çš„æ•…äº‹\",\r\n    \"é©¢å­èˆ‡æ¯äº•çš„æ•…äº‹\",\r\n    \"ç«¹å­çš„å•Ÿç¤º\",\r\n    \"çª®èˆ‡æ²’éŒ¢çš„æ•…äº‹\",\r\n    \"ç•«å®¶èˆ‡è·¯äººçš„æ•…äº‹\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0f0c29\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    tags$style(HTML(\"\r\n      body {\r\n        background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);\r\n        min-height: 100vh;\r\n        font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;\r\n      }\r\n      \r\n      .quote-container {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 80vh;\r\n        padding: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .quote-card {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        backdrop-filter: blur(10px);\r\n        border-radius: 20px;\r\n        padding: 3rem;\r\n        max-width: 900px;\r\n        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        animation: fadeIn 1s ease-in-out;\r\n      }\r\n      \r\n      @keyframes fadeIn {\r\n        from { opacity: 0; transform: translateY(20px); }\r\n        to { opacity: 1; transform: translateY(0); }\r\n      }\r\n      \r\n      .quote-icon {\r\n        font-size: 3rem;\r\n        color: rgba(255, 215, 0, 0.8);\r\n        margin-bottom: 1rem;\r\n      }\r\n      \r\n      /* çŸ­èªéŒ„æ¨£å¼ (100å­—ä»¥å…§) */\r\n      .quote-text.short {\r\n        font-size: 2rem;\r\n        font-weight: 300;\r\n        line-height: 1.8;\r\n        color: #ffffff;\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.05em;\r\n      }\r\n      \r\n      /* ä¸­ç­‰é•·åº¦æ¨£å¼ (100-200å­—) */\r\n      .quote-text.medium {\r\n        font-size: 1.4rem;\r\n        font-weight: 300;\r\n        line-height: 2;\r\n        color: #ffffff;\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.03em;\r\n        text-align: justify;\r\n      }\r\n      \r\n      /* é•·æ•…äº‹æ¨£å¼ (200-300å­—) */\r\n      .quote-text.long {\r\n        font-size: 1.15rem;\r\n        font-weight: 300;\r\n        line-height: 2.2;\r\n        color: #ffffff;\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.02em;\r\n        text-align: justify;\r\n      }\r\n      \r\n      .quote-author {\r\n        font-size: 1.1rem;\r\n        color: rgba(255, 255, 255, 0.7);\r\n        font-style: italic;\r\n        padding-top: 1rem;\r\n        border-top: 1px solid rgba(255, 255, 255, 0.2);\r\n      }\r\n      \r\n      .timer-info {\r\n        margin-top: 2rem;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        margin-top: 1.5rem;\r\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n        border: none;\r\n        padding: 0.8rem 2rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 1rem;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: scale(1.05);\r\n        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);\r\n      }\r\n      \r\n      .title {\r\n        font-size: 1.5rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        margin-bottom: 2rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .char-count {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        margin-top: 0.5rem;\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  div(class = \"quote-container\",\r\n    h1(class = \"title\", \"âœ¨ æ¯æ—¥å‹µå¿—èªéŒ„ âœ¨\"),\r\n    \r\n    div(class = \"quote-card\",\r\n      div(class = \"quote-icon\", \"â\"),\r\n      uiOutput(\"quote_display\"),\r\n      div(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n      actionButton(\"refresh\", \"æ›ä¸€å¥\", class = \"refresh-btn\"),\r\n      div(class = \"timer-info\", \r\n        \"æ¯ 10 åˆ†é˜è‡ªå‹•æ›´æ› | ä¸‹æ¬¡æ›´æ›ï¼š\",\r\n        textOutput(\"countdown\", inline = TRUE)\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # å„²å­˜ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  \r\n  # æ¯ç§’æ›´æ–°å€’æ•¸\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n      } else {\r\n        # æ™‚é–“åˆ°ï¼Œæ›´æ›èªéŒ„\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(600)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°æŒ‰éˆ•\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(600)\r\n  })\r\n  \r\n  # æ ¹æ“šå­—æ•¸æ±ºå®šæ¨£å¼é¡åˆ¥\r\n  get_size_class <- function(text) {\r\n    char_count <- nchar(text)\r\n    if (char_count <= 100) {\r\n      return(\"short\")\r\n    } else if (char_count <= 200) {\r\n      return(\"medium\")\r\n    } else {\r\n      return(\"long\")\r\n    }\r\n  }\r\n  \r\n  # é¡¯ç¤ºèªéŒ„ (å«å‹•æ…‹æ¨£å¼)\r\n  output$quote_display <- renderUI({\r\n    quote_text <- quotes$quote[current_index()]\r\n    size_class <- get_size_class(quote_text)\r\n    char_count <- nchar(quote_text)\r\n    \r\n    tagList(\r\n      div(class = paste(\"quote-text\", size_class), quote_text),\r\n      div(class = \"char-count\", paste0(\"ï¼ˆ\", char_count, \" å­—ï¼‰\"))\r\n    )\r\n  })\r\n  \r\n  # é¡¯ç¤ºä½œè€…\r\n  output$quote_author <- renderText({\r\n    paste(\"â€”\", quotes$author[current_index()])\r\n  })\r\n  \r\n  # é¡¯ç¤ºå€’æ•¸æ™‚é–“\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    mins <- floor(t / 60)\r\n    secs <- t %% 60\r\n    sprintf(\"%02d:%02d\", mins, secs)\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"v3.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ - å¢åŠ åˆ†é¡æ¨™ç±¤\r\nquotes <- data.frame(\r\n  quote = c(\r\n    # çŸ­èªéŒ„ (100å­—ä»¥å…§)\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\",\r\n    \r\n    # å°æ•…äº‹ (100-300å­—)\r\n    \"æœ‰å€‹å¹´è¼•äººå•æ™ºè€…ï¼šã€Œå¦‚ä½•æ‰èƒ½æˆåŠŸï¼Ÿã€æ™ºè€…å¸¶ä»–åˆ°æ²³é‚Šï¼Œçªç„¶æŠŠä»–çš„é ­æŒ‰å…¥æ°´ä¸­ã€‚å¹´è¼•äººæ‹¼å‘½æ™æ‰ï¼Œçµ‚æ–¼æ™è„«ã€‚æ™ºè€…å•ï¼šã€Œåœ¨æ°´è£¡æ™‚ï¼Œä½ æœ€æƒ³è¦ä»€éº¼ï¼Ÿã€å¹´è¼•äººèªªï¼šã€Œç©ºæ°£ï¼ã€æ™ºè€…å¾®ç¬‘ï¼šã€Œç•¶ä½ æ¸´æœ›æˆåŠŸå¦‚åŒæ¸´æœ›ç©ºæ°£ä¸€æ¨£å¼·çƒˆæ™‚ï¼Œä½ å°±æœƒæˆåŠŸã€‚ã€æˆåŠŸä¸æ˜¯é é‹æ°£ï¼Œè€Œæ˜¯é é‚£ä»½æ°¸ä¸æ”¾æ£„çš„æ¸´æœ›èˆ‡æ±ºå¿ƒã€‚\",\r\n    \r\n    \"ä¸€ä½è€è¾²å¤«çš„é©¢å­æ‰é€²æ¯äº•è£¡ã€‚è€è¾²å¤«æƒ³äº†å¾ˆä¹…ï¼Œæ±ºå®šæ”¾æ£„æ•‘æ´ï¼Œç›´æ¥æŠŠäº•å¡«å¹³ã€‚ç•¶æ³¥åœŸè½åœ¨é©¢å­èº«ä¸Šæ™‚ï¼Œé©¢å­èµ·åˆå¾ˆé©šæï¼Œä½†éš¨å¾Œç‰ åšäº†ä¸€å€‹æ±ºå®šï¼šæ¯æ¬¡æ³¥åœŸè½ä¸‹ï¼Œå°±æŠ–è½èº«ä¸Šçš„åœŸï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ä¸€éŸåˆä¸€éŸï¼Œé©¢å­ä¸æ–·å¾€ä¸Šå‡ã€‚æœ€å¾Œï¼Œç‰ è·³å‡ºäº†äº•å£ã€‚é‚£äº›æƒ³åŸ‹è‘¬ä½ çš„å›°é›£ï¼Œå…¶å¯¦éƒ½æ˜¯å¢Šé«˜ä½ çš„éšæ¢¯ã€‚\",\r\n    \r\n    \"ç«¹å­åœ¨å‰å››å¹´åªé•·äº†ä¸‰å…¬åˆ†ï¼Œä½†å¾ç¬¬äº”å¹´é–‹å§‹ï¼Œæ¯å¤©ä»¥ä¸‰åå…¬åˆ†çš„é€Ÿåº¦ç˜‹ç‹‚ç”Ÿé•·ï¼Œåƒ…ç”¨å…­é€±å°±é•·åˆ°äº†åäº”å…¬å°ºã€‚åŸä¾†åœ¨å‰å››å¹´ï¼Œç«¹å­çš„æ ¹å·²ç¶“åœ¨åœŸå£¤è£¡å»¶ä¼¸äº†æ•¸ç™¾å¹³æ–¹å…¬å°ºã€‚äººç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¦æ“”å¿ƒä½ çš„ä»˜å‡ºæ²’æœ‰å›å ±ï¼Œä½ ç¾åœ¨åšçš„æ¯ä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯åœ¨æ‰æ ¹ã€‚æ™‚æ©Ÿä¸€åˆ°ï¼Œä½ æœƒæˆé•·å¾—æ¯”ä»»ä½•äººéƒ½å¿«ã€‚\",\r\n    \r\n    \"æœ‰å€‹å°ç”·å­©å•çˆ¶è¦ªï¼šã€Œçˆ¸çˆ¸ï¼Œæˆ‘å€‘å®¶å¾ˆçª®å—ï¼Ÿã€çˆ¶è¦ªèªªï¼šã€Œä¸ï¼Œæˆ‘å€‘åªæ˜¯æš«æ™‚æ²’æœ‰éŒ¢ã€‚çª®æ˜¯ä¸€ç¨®å¿ƒæ…‹ï¼Œè€Œæ²’æœ‰éŒ¢åªæ˜¯ä¸€ç¨®ç‹€æ…‹ã€‚ç‹€æ…‹å¯ä»¥æ”¹è®Šï¼Œä½†å¦‚æœä½ èªå®šè‡ªå·±çª®ï¼Œå°±æœƒæ°¸é çª®ã€‚ã€å¤šå¹´å¾Œï¼Œé€™å€‹ç”·å­©æˆç‚ºæˆåŠŸçš„ä¼æ¥­å®¶ã€‚ä»–èªªï¼šã€Œçˆ¶è¦ªé‚£ç•ªè©±æ”¹è®Šäº†æˆ‘çš„ä¸€ç”Ÿã€‚æˆ‘å¾ä¸èªç‚ºè‡ªå·±æ˜¯çª®äººï¼Œæˆ‘åªæ˜¯é‚„åœ¨é€šå¾€å¯Œæœ‰çš„è·¯ä¸Šã€‚ã€\",\r\n    \r\n    \"ä¸€ä½ç•«å®¶æŠŠä½œå“æ”¾åœ¨å»£å ´ä¸Šï¼Œè«‹è·¯äººç”¨ç´…ç­†åœˆå‡ºç¼ºé»ã€‚ä¸€å¤©å¾Œï¼Œç•«ä½œè¢«åœˆå¾—æ»¿æ»¿çš„ã€‚ä»–å¾ˆæ²®å–ªã€‚è€å¸«èªªï¼šã€Œå†ç•«ä¸€å¹…ï¼Œé€™æ¬¡è«‹è·¯äººåœˆå‡ºå„ªé»ã€‚ã€çµæœå„ªé»æ¯”ç¼ºé»é‚„å¤šã€‚è€å¸«èªªï¼šã€Œç„¡è«–ä½ åšä»€éº¼ï¼Œéƒ½æœƒæœ‰äººæ‰¹è©•ï¼Œä¹Ÿæœƒæœ‰äººæ¬£è³ã€‚ä½ è¦åšçš„ä¸æ˜¯è¨å¥½æ‰€æœ‰äººï¼Œè€Œæ˜¯ä¸æ–·ç²¾é€²ï¼Œè®“æ¬£è³ä½ çš„äººè¶Šä¾†è¶Šå¤šã€‚ã€\"\r\n  ),\r\n  author = c(\r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ™ºè€…èˆ‡æ²³çš„æ•…äº‹\",\r\n    \"é©¢å­èˆ‡æ¯äº•çš„æ•…äº‹\",\r\n    \"ç«¹å­çš„å•Ÿç¤º\",\r\n    \"çª®èˆ‡æ²’éŒ¢çš„æ•…äº‹\",\r\n    \"ç•«å®¶èˆ‡è·¯äººçš„æ•…äº‹\"\r\n  ),\r\n  category = c(\r\n    \"å‹‡æ°£\", \"è‡ªçœ\", \"è¡Œå‹•\", \"æ™‚é–“\", \"å¤¢æƒ³\",\r\n    \"åŠªåŠ›\", \"æ¯…åŠ›\", \"åˆå¿ƒ\", \"æˆé•·\", \"è‡ªä¿¡\",\r\n    \"æ¸´æœ›\", \"é€†å¢ƒ\", \"è€å¿ƒ\", \"å¿ƒæ…‹\", \"æ‰¹è©•\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0a0a0f\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    # å¼•å…¥å„ªé›…çš„ä¸­æ–‡å­—é«”\r\n    tags$link(\r\n      href = \"https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500;600&family=LXGW+WenKai+TC:wght@300;400&display=swap\",\r\n      rel = \"stylesheet\"\r\n    ),\r\n    tags$style(HTML(\"\r\n      /* ===== å…¨åŸŸæ¨£å¼ ===== */\r\n      * {\r\n        margin: 0;\r\n        padding: 0;\r\n        box-sizing: border-box;\r\n      }\r\n      \r\n      body {\r\n        background: #0a0a0f;\r\n        min-height: 100vh;\r\n        font-family: 'LXGW WenKai TC', 'Noto Serif TC', serif;\r\n        overflow-x: hidden;\r\n      }\r\n      \r\n      /* ===== å‹•æ…‹èƒŒæ™¯ ===== */\r\n      .bg-container {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 0;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .bg-gradient {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: \r\n          radial-gradient(ellipse at 20% 20%, rgba(120, 80, 160, 0.15) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 80% 80%, rgba(80, 120, 180, 0.12) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 50% 50%, rgba(60, 60, 80, 0.1) 0%, transparent 70%);\r\n      }\r\n      \r\n      /* æµ®å‹•å…‰é» */\r\n      .floating-orb {\r\n        position: absolute;\r\n        border-radius: 50%;\r\n        filter: blur(60px);\r\n        animation: float 20s infinite ease-in-out;\r\n        opacity: 0.4;\r\n      }\r\n      \r\n      .orb-1 {\r\n        width: 400px;\r\n        height: 400px;\r\n        background: linear-gradient(135deg, #6366f1, #8b5cf6);\r\n        top: -10%;\r\n        left: -5%;\r\n        animation-delay: 0s;\r\n      }\r\n      \r\n      .orb-2 {\r\n        width: 350px;\r\n        height: 350px;\r\n        background: linear-gradient(135deg, #0ea5e9, #06b6d4);\r\n        bottom: -10%;\r\n        right: -5%;\r\n        animation-delay: -7s;\r\n      }\r\n      \r\n      .orb-3 {\r\n        width: 250px;\r\n        height: 250px;\r\n        background: linear-gradient(135deg, #f59e0b, #ef4444);\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        animation-delay: -14s;\r\n        opacity: 0.2;\r\n      }\r\n      \r\n      @keyframes float {\r\n        0%, 100% { transform: translate(0, 0) scale(1); }\r\n        25% { transform: translate(30px, -30px) scale(1.05); }\r\n        50% { transform: translate(-20px, 20px) scale(0.95); }\r\n        75% { transform: translate(20px, 30px) scale(1.02); }\r\n      }\r\n      \r\n      /* æ˜Ÿæ˜Ÿç²’å­ */\r\n      .stars {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-image: \r\n          radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),\r\n          radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.4), transparent),\r\n          radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 160px 120px, rgba(255,255,255,0.3), transparent);\r\n        background-repeat: repeat;\r\n        background-size: 200px 200px;\r\n        animation: twinkle 8s infinite;\r\n      }\r\n      \r\n      @keyframes twinkle {\r\n        0%, 100% { opacity: 0.5; }\r\n        50% { opacity: 1; }\r\n      }\r\n      \r\n      /* ===== ä¸»å®¹å™¨ ===== */\r\n      .main-container {\r\n        position: relative;\r\n        z-index: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 100vh;\r\n        padding: 1.5rem;\r\n      }\r\n      \r\n      /* ===== æ¨™é¡Œå€ ===== */\r\n      .header {\r\n        text-align: center;\r\n        margin-bottom: 2rem;\r\n      }\r\n      \r\n      .main-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: clamp(1.5rem, 4vw, 2.2rem);\r\n        font-weight: 300;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.3em;\r\n        margin-bottom: 0.5rem;\r\n        text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .sub-title {\r\n        font-size: 0.85rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.2em;\r\n        font-weight: 300;\r\n      }\r\n      \r\n      /* ===== å¡ç‰‡ä¸»é«” ===== */\r\n      .quote-card {\r\n        position: relative;\r\n        background: linear-gradient(\r\n          135deg,\r\n          rgba(255, 255, 255, 0.03) 0%,\r\n          rgba(255, 255, 255, 0.08) 50%,\r\n          rgba(255, 255, 255, 0.03) 100%\r\n        );\r\n        backdrop-filter: blur(20px);\r\n        -webkit-backdrop-filter: blur(20px);\r\n        border-radius: 24px;\r\n        padding: clamp(2rem, 5vw, 3.5rem);\r\n        max-width: 850px;\r\n        width: 100%;\r\n        border: 1px solid rgba(255, 255, 255, 0.08);\r\n        box-shadow: \r\n          0 25px 50px -12px rgba(0, 0, 0, 0.5),\r\n          inset 0 1px 0 rgba(255, 255, 255, 0.1);\r\n        animation: cardEnter 1s cubic-bezier(0.16, 1, 0.3, 1);\r\n      }\r\n      \r\n      @keyframes cardEnter {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(40px) scale(0.95);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0) scale(1);\r\n        }\r\n      }\r\n      \r\n      /* å¡ç‰‡é ‚éƒ¨è£é£¾ç·š */\r\n      .quote-card::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        width: 60%;\r\n        height: 1px;\r\n        background: linear-gradient(\r\n          90deg,\r\n          transparent,\r\n          rgba(139, 92, 246, 0.5),\r\n          rgba(236, 72, 153, 0.5),\r\n          transparent\r\n        );\r\n      }\r\n      \r\n      /* ===== åˆ†é¡æ¨™ç±¤ ===== */\r\n      .category-tag {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 0.4rem;\r\n        padding: 0.4rem 1rem;\r\n        background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2));\r\n        border: 1px solid rgba(139, 92, 246, 0.3);\r\n        border-radius: 20px;\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .category-icon {\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      /* ===== å¼•è™Ÿè£é£¾ ===== */\r\n      .quote-mark {\r\n        font-family: Georgia, serif;\r\n        font-size: 4rem;\r\n        line-height: 1;\r\n        color: rgba(139, 92, 246, 0.3);\r\n        margin-bottom: -1rem;\r\n        user-select: none;\r\n      }\r\n      \r\n      /* ===== èªéŒ„æ–‡å­— ===== */\r\n      .quote-wrapper {\r\n        position: relative;\r\n        min-height: 120px;\r\n      }\r\n      \r\n      .quote-text {\r\n        font-family: 'Noto Serif TC', serif;\r\n        color: rgba(255, 255, 255, 0.95);\r\n        margin-bottom: 1.5rem;\r\n        animation: textFade 0.8s ease-out;\r\n      }\r\n      \r\n      @keyframes textFade {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(10px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n      \r\n      /* çŸ­èªéŒ„ */\r\n      .quote-text.short {\r\n        font-size: clamp(1.4rem, 3vw, 1.9rem);\r\n        font-weight: 400;\r\n        line-height: 2;\r\n        letter-spacing: 0.08em;\r\n        text-align: center;\r\n      }\r\n      \r\n      /* ä¸­ç­‰é•·åº¦ */\r\n      .quote-text.medium {\r\n        font-size: clamp(1.1rem, 2.2vw, 1.35rem);\r\n        font-weight: 400;\r\n        line-height: 2.2;\r\n        letter-spacing: 0.05em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* é•·æ•…äº‹ */\r\n      .quote-text.long {\r\n        font-size: clamp(1rem, 1.8vw, 1.15rem);\r\n        font-weight: 400;\r\n        line-height: 2.4;\r\n        letter-spacing: 0.03em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* ===== ä½œè€…å€ ===== */\r\n      .author-section {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        padding-top: 1.5rem;\r\n        border-top: 1px solid rgba(255, 255, 255, 0.08);\r\n        animation: authorFade 0.8s ease-out 0.3s both;\r\n      }\r\n      \r\n      @keyframes authorFade {\r\n        from { opacity: 0; }\r\n        to { opacity: 1; }\r\n      }\r\n      \r\n      .author-line {\r\n        width: 30px;\r\n        height: 1px;\r\n        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));\r\n      }\r\n      \r\n      .author-line:last-child {\r\n        background: linear-gradient(90deg, rgba(255, 255, 255, 0.4), transparent);\r\n      }\r\n      \r\n      .quote-author {\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 1rem;\r\n        color: rgba(255, 255, 255, 0.6);\r\n        font-style: normal;\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      /* ===== å­—æ•¸é¡¯ç¤º ===== */\r\n      .char-count {\r\n        text-align: center;\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        margin-top: 1rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      /* ===== æŒ‰éˆ•å€ ===== */\r\n      .button-group {\r\n        display: flex;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        margin-top: 2rem;\r\n        flex-wrap: wrap;\r\n      }\r\n      \r\n      .action-btn {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 0.5rem;\r\n        padding: 0.9rem 1.8rem;\r\n        border-radius: 50px;\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 0.95rem;\r\n        letter-spacing: 0.1em;\r\n        cursor: pointer;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border: none;\r\n        outline: none;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);\r\n        color: white;\r\n        box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: translateY(-3px) scale(1.02);\r\n        box-shadow: 0 8px 30px rgba(99, 102, 241, 0.5);\r\n      }\r\n      \r\n      .refresh-btn:active {\r\n        transform: translateY(0) scale(0.98);\r\n      }\r\n      \r\n      .secondary-btn {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        color: rgba(255, 255, 255, 0.7);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .secondary-btn:hover {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        color: white;\r\n        transform: translateY(-2px);\r\n      }\r\n      \r\n      .secondary-btn.active {\r\n        background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(239, 68, 68, 0.2));\r\n        border-color: rgba(236, 72, 153, 0.4);\r\n        color: #f472b6;\r\n      }\r\n      \r\n      /* ===== é€²åº¦æ¢ ===== */\r\n      .progress-section {\r\n        margin-top: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .progress-bar-container {\r\n        width: 100%;\r\n        max-width: 300px;\r\n        height: 3px;\r\n        background: rgba(255, 255, 255, 0.1);\r\n        border-radius: 3px;\r\n        margin: 0 auto 0.8rem;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .progress-bar-fill {\r\n        height: 100%;\r\n        background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);\r\n        border-radius: 3px;\r\n        transition: width 1s linear;\r\n      }\r\n      \r\n      .timer-text {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      .countdown {\r\n        font-family: 'SF Mono', 'Consolas', monospace;\r\n        color: rgba(255, 255, 255, 0.6);\r\n      }\r\n      \r\n      /* ===== æ”¶è—åˆ—è¡¨ Modal ===== */\r\n      .favorites-panel {\r\n        position: fixed;\r\n        top: 0;\r\n        right: -400px;\r\n        width: 380px;\r\n        max-width: 90vw;\r\n        height: 100vh;\r\n        background: linear-gradient(180deg, rgba(15, 15, 25, 0.98), rgba(10, 10, 15, 0.98));\r\n        backdrop-filter: blur(20px);\r\n        z-index: 1000;\r\n        padding: 2rem;\r\n        overflow-y: auto;\r\n        transition: right 0.5s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border-left: 1px solid rgba(255, 255, 255, 0.1);\r\n        box-shadow: -10px 0 40px rgba(0, 0, 0, 0.5);\r\n      }\r\n      \r\n      .favorites-panel.open {\r\n        right: 0;\r\n      }\r\n      \r\n      .panel-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-bottom: 2rem;\r\n        padding-bottom: 1rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .panel-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: 1.3rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .close-btn {\r\n        background: none;\r\n        border: none;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 1.5rem;\r\n        cursor: pointer;\r\n        padding: 0.5rem;\r\n        transition: color 0.3s;\r\n      }\r\n      \r\n      .close-btn:hover {\r\n        color: white;\r\n      }\r\n      \r\n      .favorite-item {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        border-radius: 12px;\r\n        padding: 1.2rem;\r\n        margin-bottom: 1rem;\r\n        border: 1px solid rgba(255, 255, 255, 0.05);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .favorite-item:hover {\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border-color: rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .favorite-quote {\r\n        font-size: 0.9rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        line-height: 1.8;\r\n        margin-bottom: 0.8rem;\r\n      }\r\n      \r\n      .favorite-author {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        text-align: right;\r\n      }\r\n      \r\n      .empty-favorites {\r\n        text-align: center;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        padding: 3rem 1rem;\r\n        font-size: 0.9rem;\r\n        line-height: 1.8;\r\n      }\r\n      \r\n      /* ===== é®ç½©å±¤ ===== */\r\n      .overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        z-index: 999;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .overlay.show {\r\n        opacity: 1;\r\n        visibility: visible;\r\n      }\r\n      \r\n      /* ===== å¿«æ·éµæç¤º ===== */\r\n      .shortcut-hint {\r\n        position: fixed;\r\n        bottom: 1.5rem;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        display: flex;\r\n        gap: 2rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        font-size: 0.75rem;\r\n        letter-spacing: 0.05em;\r\n      }\r\n      \r\n      .shortcut-item {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 0.5rem;\r\n      }\r\n      \r\n      .key {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        min-width: 24px;\r\n        height: 24px;\r\n        padding: 0 6px;\r\n        background: rgba(255, 255, 255, 0.08);\r\n        border-radius: 4px;\r\n        font-family: 'SF Mono', 'Consolas', monospace;\r\n        font-size: 0.7rem;\r\n      }\r\n      \r\n      /* ===== é€šçŸ¥æç¤º ===== */\r\n      .toast {\r\n        position: fixed;\r\n        bottom: 80px;\r\n        left: 50%;\r\n        transform: translateX(-50%) translateY(100px);\r\n        background: rgba(20, 20, 30, 0.95);\r\n        backdrop-filter: blur(10px);\r\n        padding: 0.8rem 1.5rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 0.9rem;\r\n        letter-spacing: 0.05em;\r\n        opacity: 0;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        z-index: 2000;\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .toast.show {\r\n        opacity: 1;\r\n        transform: translateX(-50%) translateY(0);\r\n      }\r\n      \r\n      /* ===== éŸ¿æ‡‰å¼è¨­è¨ˆ ===== */\r\n      @media (max-width: 768px) {\r\n        .main-container {\r\n          padding: 1rem;\r\n        }\r\n        \r\n        .quote-card {\r\n          padding: 1.5rem;\r\n          border-radius: 16px;\r\n        }\r\n        \r\n        .quote-mark {\r\n          font-size: 3rem;\r\n        }\r\n        \r\n        .button-group {\r\n          flex-direction: column;\r\n          align-items: stretch;\r\n        }\r\n        \r\n        .action-btn {\r\n          width: 100%;\r\n        }\r\n        \r\n        .shortcut-hint {\r\n          display: none;\r\n        }\r\n        \r\n        .favorites-panel {\r\n          width: 100%;\r\n          right: -100%;\r\n        }\r\n      }\r\n      \r\n      /* ===== æ·±è‰²ä¸»é¡Œæ»¾å‹•æ¢ ===== */\r\n      ::-webkit-scrollbar {\r\n        width: 6px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-track {\r\n        background: rgba(255, 255, 255, 0.05);\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb {\r\n        background: rgba(255, 255, 255, 0.2);\r\n        border-radius: 3px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb:hover {\r\n        background: rgba(255, 255, 255, 0.3);\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  # èƒŒæ™¯å±¤\r\n  div(class = \"bg-container\",\r\n    div(class = \"bg-gradient\"),\r\n    div(class = \"floating-orb orb-1\"),\r\n    div(class = \"floating-orb orb-2\"),\r\n    div(class = \"floating-orb orb-3\"),\r\n    div(class = \"stars\")\r\n  ),\r\n  \r\n  # ä¸»å…§å®¹\r\n  div(class = \"main-container\",\r\n    # æ¨™é¡Œ\r\n    div(class = \"header\",\r\n      h1(class = \"main-title\", \"å¿ƒéˆé©›ç«™\"),\r\n      p(class = \"sub-title\", \"DAILY INSPIRATIONS\")\r\n    ),\r\n    \r\n    # èªéŒ„å¡ç‰‡\r\n    div(class = \"quote-card\",\r\n      # åˆ†é¡æ¨™ç±¤\r\n      uiOutput(\"category_tag\"),\r\n      \r\n      # å¼•è™Ÿè£é£¾\r\n      div(class = \"quote-mark\", \"ã€Œ\"),\r\n      \r\n      # èªéŒ„å…§å®¹\r\n      div(class = \"quote-wrapper\",\r\n        uiOutput(\"quote_display\")\r\n      ),\r\n      \r\n      # ä½œè€…\r\n      div(class = \"author-section\",\r\n        span(class = \"author-line\"),\r\n        span(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n        span(class = \"author-line\")\r\n      ),\r\n      \r\n      # å­—æ•¸\r\n      div(class = \"char-count\", textOutput(\"char_count\", inline = TRUE)),\r\n      \r\n      # æŒ‰éˆ•çµ„\r\n      div(class = \"button-group\",\r\n        actionButton(\"refresh\", \r\n          tagList(icon(\"rotate\"), \"æ›ä¸€å‰‡\"),\r\n          class = \"action-btn refresh-btn\"\r\n        ),\r\n        actionButton(\"favorite\", \r\n          tagList(uiOutput(\"fav_icon\", inline = TRUE), \"æ”¶è—\"),\r\n          class = \"action-btn secondary-btn\"\r\n        ),\r\n        actionButton(\"show_favorites\", \r\n          tagList(icon(\"heart\"), \"æ”¶è—å¤¾\"),\r\n          class = \"action-btn secondary-btn\"\r\n        )\r\n      ),\r\n      \r\n      # é€²åº¦æ¢\r\n      div(class = \"progress-section\",\r\n        div(class = \"progress-bar-container\",\r\n          div(id = \"progress-fill\", class = \"progress-bar-fill\", style = \"width: 100%;\")\r\n        ),\r\n        div(class = \"timer-text\",\r\n          \"ä¸‹ä¸€å‰‡ï¼š\",\r\n          span(class = \"countdown\", textOutput(\"countdown\", inline = TRUE))\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # æ”¶è—é¢æ¿é®ç½©\r\n  div(id = \"overlay\", class = \"overlay\"),\r\n  \r\n  # æ”¶è—é¢æ¿\r\n  div(id = \"favorites-panel\", class = \"favorites-panel\",\r\n    div(class = \"panel-header\",\r\n      span(class = \"panel-title\", \"ğŸ’œ æˆ‘çš„æ”¶è—\"),\r\n      actionButton(\"close_panel\", \"Ã—\", class = \"close-btn\")\r\n    ),\r\n    uiOutput(\"favorites_list\")\r\n  ),\r\n  \r\n  # Toast é€šçŸ¥\r\n  div(id = \"toast\", class = \"toast\", textOutput(\"toast_message\", inline = TRUE)),\r\n  \r\n  # å¿«æ·éµæç¤º\r\n  div(class = \"shortcut-hint\",\r\n    div(class = \"shortcut-item\",\r\n      span(class = \"key\", \"Space\"),\r\n      span(\"æ›ä¸€å‰‡\")\r\n    ),\r\n    div(class = \"shortcut-item\",\r\n      span(class = \"key\", \"F\"),\r\n      span(\"æ”¶è—\")\r\n    ),\r\n    div(class = \"shortcut-item\",\r\n      span(class = \"key\", \"L\"),\r\n      span(\"æ”¶è—å¤¾\")\r\n    )\r\n  ),\r\n  \r\n  # JavaScript\r\n  tags$script(HTML(\"\r\n    // éµç›¤å¿«æ·éµ\r\n    document.addEventListener('keydown', function(e) {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\r\n      \r\n      if (e.code === 'Space') {\r\n        e.preventDefault();\r\n        document.getElementById('refresh').click();\r\n      } else if (e.key.toLowerCase() === 'f') {\r\n        document.getElementById('favorite').click();\r\n      } else if (e.key.toLowerCase() === 'l') {\r\n        document.getElementById('show_favorites').click();\r\n      } else if (e.key === 'Escape') {\r\n        document.getElementById('close_panel').click();\r\n      }\r\n    });\r\n    \r\n    // æ”¶è—é¢æ¿æ§åˆ¶\r\n    Shiny.addCustomMessageHandler('togglePanel', function(open) {\r\n      var panel = document.getElementById('favorites-panel');\r\n      var overlay = document.getElementById('overlay');\r\n      if (open) {\r\n        panel.classList.add('open');\r\n        overlay.classList.add('show');\r\n      } else {\r\n        panel.classList.remove('open');\r\n        overlay.classList.remove('show');\r\n      }\r\n    });\r\n    \r\n    // é»æ“Šé®ç½©é—œé–‰é¢æ¿\r\n    document.getElementById('overlay').addEventListener('click', function() {\r\n      document.getElementById('close_panel').click();\r\n    });\r\n    \r\n    // Toast é€šçŸ¥\r\n    Shiny.addCustomMessageHandler('showToast', function(message) {\r\n      var toast = document.getElementById('toast');\r\n      document.getElementById('toast_message').innerText = message;\r\n      toast.classList.add('show');\r\n      setTimeout(function() {\r\n        toast.classList.remove('show');\r\n      }, 2500);\r\n    });\r\n    \r\n    // æ›´æ–°é€²åº¦æ¢\r\n    Shiny.addCustomMessageHandler('updateProgress', function(percent) {\r\n      document.getElementById('progress-fill').style.width = percent + '%';\r\n    });\r\n  \"))\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  favorites <- reactiveVal(integer(0))\r\n  \r\n  # è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  total_time <- 600\r\n  \r\n  # Toast è¨Šæ¯\r\n  toast_msg <- reactiveVal(\"\")\r\n  \r\n  # æ¯ç§’æ›´æ–°\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n        # æ›´æ–°é€²åº¦æ¢\r\n        percent <- (t / total_time) * 100\r\n        session$sendCustomMessage(\"updateProgress\", percent)\r\n      } else {\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(total_time)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(total_time)\r\n  })\r\n  \r\n  # æ”¶è—/å–æ¶ˆæ”¶è—\r\n  observeEvent(input$favorite, {\r\n    idx <- current_index()\r\n    fav <- favorites()\r\n    \r\n    if (idx %in% fav) {\r\n      favorites(setdiff(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²å¾æ”¶è—å¤¾ç§»é™¤\")\r\n    } else {\r\n      favorites(c(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²åŠ å…¥æ”¶è—å¤¾ ğŸ’œ\")\r\n    }\r\n  })\r\n  \r\n  # é¡¯ç¤ºæ”¶è—é¢æ¿\r\n  observeEvent(input$show_favorites, {\r\n    session$sendCustomMessage(\"togglePanel\", TRUE)\r\n  })\r\n  \r\n  # é—œé–‰æ”¶è—é¢æ¿\r\n  observeEvent(input$close_panel, {\r\n    session$sendCustomMessage(\"togglePanel\", FALSE)\r\n  })\r\n  \r\n  # ç²å–å°ºå¯¸é¡åˆ¥\r\n  get_size_class <- function(text) {\r\n    n <- nchar(text)\r\n    if (n <= 100) \"short\"\r\n    else if (n <= 200) \"medium\"\r\n    else \"long\"\r\n  }\r\n  \r\n  # åˆ†é¡æ¨™ç±¤\r\n  output$category_tag <- renderUI({\r\n    cat <- quotes$category[current_index()]\r\n    icons <- list(\r\n      \"å‹‡æ°£\" = \"ğŸ¦\", \"è‡ªçœ\" = \"ğŸª\", \"è¡Œå‹•\" = \"ğŸš€\", \"æ™‚é–“\" = \"â°\", \"å¤¢æƒ³\" = \"âœ¨\",\r\n      \"åŠªåŠ›\" = \"ğŸ’ª\", \"æ¯…åŠ›\" = \"ğŸ”ï¸\", \"åˆå¿ƒ\" = \"ğŸŒ±\", \"æˆé•·\" = \"ğŸŒ³\", \"è‡ªä¿¡\" = \"ğŸ‘‘\",\r\n      \"æ¸´æœ›\" = \"ğŸ”¥\", \"é€†å¢ƒ\" = \"ğŸŒŠ\", \"è€å¿ƒ\" = \"ğŸ‹\", \"å¿ƒæ…‹\" = \"ğŸ§ \", \"æ‰¹è©•\" = \"ğŸ¨\"\r\n    )\r\n    icon <- icons[[cat]] %||% \"ğŸ’«\"\r\n    \r\n    div(class = \"category-tag\",\r\n      span(class = \"category-icon\", icon),\r\n      cat\r\n    )\r\n  })\r\n  \r\n  # é¡¯ç¤ºèªéŒ„\r\n  output$quote_display <- renderUI({\r\n    quote_text <- quotes$quote[current_index()]\r\n    size_class <- get_size_class(quote_text)\r\n    div(class = paste(\"quote-text\", size_class), quote_text)\r\n  })\r\n  \r\n  # ä½œè€…\r\n  output$quote_author <- renderText({\r\n    quotes$author[current_index()]\r\n  })\r\n  \r\n  # å­—æ•¸\r\n  output$char_count <- renderText({\r\n    paste0(\"å…± \", nchar(quotes$quote[current_index()]), \" å­—\")\r\n  })\r\n  \r\n  # æ”¶è—åœ–æ¨™\r\n  output$fav_icon <- renderUI({\r\n    if (current_index() %in% favorites()) {\r\n      icon(\"heart\", class = \"fas\", style = \"color: #f472b6;\")\r\n    } else {\r\n      icon(\"heart\", class = \"far\")\r\n    }\r\n  })\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    sprintf(\"%02d:%02d\", floor(t / 60), t %% 60)\r\n  })\r\n  \r\n  # Toast è¨Šæ¯è¼¸å‡º\r\n  output$toast_message <- renderText({\r\n    toast_msg()\r\n  })\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  output$favorites_list <- renderUI({\r\n    fav <- favorites()\r\n    \r\n    if (length(fav) == 0) {\r\n      return(div(class = \"empty-favorites\",\r\n        p(\"ğŸŒ™\"),\r\n        p(\"é‚„æ²’æœ‰æ”¶è—ä»»ä½•èªéŒ„\"),\r\n        p(\"é»æ“Šã€Œæ”¶è—ã€æŒ‰éˆ•æˆ–æŒ‰ F éµå³å¯æ”¶è—\")\r\n      ))\r\n    }\r\n    \r\n    tagList(\r\n      lapply(fav, function(idx) {\r\n        div(class = \"favorite-item\",\r\n          div(class = \"favorite-quote\",\r\n            substr(quotes$quote[idx], 1, 80),\r\n            if (nchar(quotes$quote[idx]) > 80) \"...\" else \"\"\r\n          ),\r\n          div(class = \"favorite-author\",\r\n            paste(\"â€”\", quotes$author[idx])\r\n          )\r\n        )\r\n      })\r\n    )\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"v4.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ - å¢åŠ åˆ†é¡æ¨™ç±¤\r\nquotes <- data.frame(\r\n  quote = c(\r\n    # çŸ­èªéŒ„ (100å­—ä»¥å…§)\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\",\r\n    \r\n    # å°æ•…äº‹ (100-300å­—)\r\n    \"æœ‰å€‹å¹´è¼•äººå•æ™ºè€…ï¼šã€Œå¦‚ä½•æ‰èƒ½æˆåŠŸï¼Ÿã€æ™ºè€…å¸¶ä»–åˆ°æ²³é‚Šï¼Œçªç„¶æŠŠä»–çš„é ­æŒ‰å…¥æ°´ä¸­ã€‚å¹´è¼•äººæ‹¼å‘½æ™æ‰ï¼Œçµ‚æ–¼æ™è„«ã€‚æ™ºè€…å•ï¼šã€Œåœ¨æ°´è£¡æ™‚ï¼Œä½ æœ€æƒ³è¦ä»€éº¼ï¼Ÿã€å¹´è¼•äººèªªï¼šã€Œç©ºæ°£ï¼ã€æ™ºè€…å¾®ç¬‘ï¼šã€Œç•¶ä½ æ¸´æœ›æˆåŠŸå¦‚åŒæ¸´æœ›ç©ºæ°£ä¸€æ¨£å¼·çƒˆæ™‚ï¼Œä½ å°±æœƒæˆåŠŸã€‚ã€æˆåŠŸä¸æ˜¯é é‹æ°£ï¼Œè€Œæ˜¯é é‚£ä»½æ°¸ä¸æ”¾æ£„çš„æ¸´æœ›èˆ‡æ±ºå¿ƒã€‚\",\r\n    \r\n    \"ä¸€ä½è€è¾²å¤«çš„é©¢å­æ‰é€²æ¯äº•è£¡ã€‚è€è¾²å¤«æƒ³äº†å¾ˆä¹…ï¼Œæ±ºå®šæ”¾æ£„æ•‘æ´ï¼Œç›´æ¥æŠŠäº•å¡«å¹³ã€‚ç•¶æ³¥åœŸè½åœ¨é©¢å­èº«ä¸Šæ™‚ï¼Œé©¢å­èµ·åˆå¾ˆé©šæï¼Œä½†éš¨å¾Œç‰ åšäº†ä¸€å€‹æ±ºå®šï¼šæ¯æ¬¡æ³¥åœŸè½ä¸‹ï¼Œå°±æŠ–è½èº«ä¸Šçš„åœŸï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ä¸€éŸåˆä¸€éŸï¼Œé©¢å­ä¸æ–·å¾€ä¸Šå‡ã€‚æœ€å¾Œï¼Œç‰ è·³å‡ºäº†äº•å£ã€‚é‚£äº›æƒ³åŸ‹è‘¬ä½ çš„å›°é›£ï¼Œå…¶å¯¦éƒ½æ˜¯å¢Šé«˜ä½ çš„éšæ¢¯ã€‚\",\r\n    \r\n    \"ç«¹å­åœ¨å‰å››å¹´åªé•·äº†ä¸‰å…¬åˆ†ï¼Œä½†å¾ç¬¬äº”å¹´é–‹å§‹ï¼Œæ¯å¤©ä»¥ä¸‰åå…¬åˆ†çš„é€Ÿåº¦ç˜‹ç‹‚ç”Ÿé•·ï¼Œåƒ…ç”¨å…­é€±å°±é•·åˆ°äº†åäº”å…¬å°ºã€‚åŸä¾†åœ¨å‰å››å¹´ï¼Œç«¹å­çš„æ ¹å·²ç¶“åœ¨åœŸå£¤è£¡å»¶ä¼¸äº†æ•¸ç™¾å¹³æ–¹å…¬å°ºã€‚äººç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¦æ“”å¿ƒä½ çš„ä»˜å‡ºæ²’æœ‰å›å ±ï¼Œä½ ç¾åœ¨åšçš„æ¯ä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯åœ¨æ‰æ ¹ã€‚æ™‚æ©Ÿä¸€åˆ°ï¼Œä½ æœƒæˆé•·å¾—æ¯”ä»»ä½•äººéƒ½å¿«ã€‚\",\r\n    \r\n    \"æœ‰å€‹å°ç”·å­©å•çˆ¶è¦ªï¼šã€Œçˆ¸çˆ¸ï¼Œæˆ‘å€‘å®¶å¾ˆçª®å—ï¼Ÿã€çˆ¶è¦ªèªªï¼šã€Œä¸ï¼Œæˆ‘å€‘åªæ˜¯æš«æ™‚æ²’æœ‰éŒ¢ã€‚çª®æ˜¯ä¸€ç¨®å¿ƒæ…‹ï¼Œè€Œæ²’æœ‰éŒ¢åªæ˜¯ä¸€ç¨®ç‹€æ…‹ã€‚ç‹€æ…‹å¯ä»¥æ”¹è®Šï¼Œä½†å¦‚æœä½ èªå®šè‡ªå·±çª®ï¼Œå°±æœƒæ°¸é çª®ã€‚ã€å¤šå¹´å¾Œï¼Œé€™å€‹ç”·å­©æˆç‚ºæˆåŠŸçš„ä¼æ¥­å®¶ã€‚ä»–èªªï¼šã€Œçˆ¶è¦ªé‚£ç•ªè©±æ”¹è®Šäº†æˆ‘çš„ä¸€ç”Ÿã€‚æˆ‘å¾ä¸èªç‚ºè‡ªå·±æ˜¯çª®äººï¼Œæˆ‘åªæ˜¯é‚„åœ¨é€šå¾€å¯Œæœ‰çš„è·¯ä¸Šã€‚ã€\",\r\n    \r\n    \"ä¸€ä½ç•«å®¶æŠŠä½œå“æ”¾åœ¨å»£å ´ä¸Šï¼Œè«‹è·¯äººç”¨ç´…ç­†åœˆå‡ºç¼ºé»ã€‚ä¸€å¤©å¾Œï¼Œç•«ä½œè¢«åœˆå¾—æ»¿æ»¿çš„ã€‚ä»–å¾ˆæ²®å–ªã€‚è€å¸«èªªï¼šã€Œå†ç•«ä¸€å¹…ï¼Œé€™æ¬¡è«‹è·¯äººåœˆå‡ºå„ªé»ã€‚ã€çµæœå„ªé»æ¯”ç¼ºé»é‚„å¤šã€‚è€å¸«èªªï¼šã€Œç„¡è«–ä½ åšä»€éº¼ï¼Œéƒ½æœƒæœ‰äººæ‰¹è©•ï¼Œä¹Ÿæœƒæœ‰äººæ¬£è³ã€‚ä½ è¦åšçš„ä¸æ˜¯è¨å¥½æ‰€æœ‰äººï¼Œè€Œæ˜¯ä¸æ–·ç²¾é€²ï¼Œè®“æ¬£è³ä½ çš„äººè¶Šä¾†è¶Šå¤šã€‚ã€\"\r\n  ),\r\n  author = c(\r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ™ºè€…èˆ‡æ²³çš„æ•…äº‹\",\r\n    \"é©¢å­èˆ‡æ¯äº•çš„æ•…äº‹\",\r\n    \"ç«¹å­çš„å•Ÿç¤º\",\r\n    \"çª®èˆ‡æ²’éŒ¢çš„æ•…äº‹\",\r\n    \"ç•«å®¶èˆ‡è·¯äººçš„æ•…äº‹\"\r\n  ),\r\n  category = c(\r\n    \"å‹‡æ°£\", \"è‡ªçœ\", \"è¡Œå‹•\", \"æ™‚é–“\", \"å¤¢æƒ³\",\r\n    \"åŠªåŠ›\", \"æ¯…åŠ›\", \"åˆå¿ƒ\", \"æˆé•·\", \"è‡ªä¿¡\",\r\n    \"æ¸´æœ›\", \"é€†å¢ƒ\", \"è€å¿ƒ\", \"å¿ƒæ…‹\", \"æ‰¹è©•\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0a0a0f\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    # å¼•å…¥å„ªé›…çš„ä¸­æ–‡å­—é«”\r\n    tags$link(\r\n      href = \"https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500;600&family=LXGW+WenKai+TC:wght@300;400&display=swap\",\r\n      rel = \"stylesheet\"\r\n    ),\r\n    tags$style(HTML(\"\r\n      /* ===== å…¨åŸŸæ¨£å¼ ===== */\r\n      * {\r\n        margin: 0;\r\n        padding: 0;\r\n        box-sizing: border-box;\r\n      }\r\n      \r\n      body {\r\n        background: #0a0a0f;\r\n        min-height: 100vh;\r\n        font-family: 'LXGW WenKai TC', 'Noto Serif TC', serif;\r\n        overflow-x: hidden;\r\n      }\r\n      \r\n      /* ===== å‹•æ…‹èƒŒæ™¯ ===== */\r\n      .bg-container {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 0;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .bg-gradient {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: \r\n          radial-gradient(ellipse at 20% 20%, rgba(120, 80, 160, 0.15) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 80% 80%, rgba(80, 120, 180, 0.12) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 50% 50%, rgba(60, 60, 80, 0.1) 0%, transparent 70%);\r\n      }\r\n      \r\n      /* æµ®å‹•å…‰é» */\r\n      .floating-orb {\r\n        position: absolute;\r\n        border-radius: 50%;\r\n        filter: blur(60px);\r\n        animation: float 20s infinite ease-in-out;\r\n        opacity: 0.4;\r\n      }\r\n      \r\n      .orb-1 {\r\n        width: 400px;\r\n        height: 400px;\r\n        background: linear-gradient(135deg, #6366f1, #8b5cf6);\r\n        top: -10%;\r\n        left: -5%;\r\n        animation-delay: 0s;\r\n      }\r\n      \r\n      .orb-2 {\r\n        width: 350px;\r\n        height: 350px;\r\n        background: linear-gradient(135deg, #0ea5e9, #06b6d4);\r\n        bottom: -10%;\r\n        right: -5%;\r\n        animation-delay: -7s;\r\n      }\r\n      \r\n      .orb-3 {\r\n        width: 250px;\r\n        height: 250px;\r\n        background: linear-gradient(135deg, #f59e0b, #ef4444);\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        animation-delay: -14s;\r\n        opacity: 0.2;\r\n      }\r\n      \r\n      @keyframes float {\r\n        0%, 100% { transform: translate(0, 0) scale(1); }\r\n        25% { transform: translate(30px, -30px) scale(1.05); }\r\n        50% { transform: translate(-20px, 20px) scale(0.95); }\r\n        75% { transform: translate(20px, 30px) scale(1.02); }\r\n      }\r\n      \r\n      /* æ˜Ÿæ˜Ÿç²’å­ */\r\n      .stars {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-image: \r\n          radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),\r\n          radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.4), transparent),\r\n          radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 160px 120px, rgba(255,255,255,0.3), transparent);\r\n        background-repeat: repeat;\r\n        background-size: 200px 200px;\r\n        animation: twinkle 8s infinite;\r\n      }\r\n      \r\n      @keyframes twinkle {\r\n        0%, 100% { opacity: 0.5; }\r\n        50% { opacity: 1; }\r\n      }\r\n      \r\n      /* ===== ä¸»å®¹å™¨ ===== */\r\n      .main-container {\r\n        position: relative;\r\n        z-index: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 100vh;\r\n        padding: 1.5rem;\r\n      }\r\n      \r\n      /* ===== æ¨™é¡Œå€ ===== */\r\n      .header {\r\n        text-align: center;\r\n        margin-bottom: 2rem;\r\n      }\r\n      \r\n      .main-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: clamp(1.5rem, 4vw, 2.2rem);\r\n        font-weight: 300;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.3em;\r\n        margin-bottom: 0.5rem;\r\n        text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .sub-title {\r\n        font-size: 0.85rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.2em;\r\n        font-weight: 300;\r\n      }\r\n      \r\n      /* ===== å¡ç‰‡ä¸»é«” ===== */\r\n      .quote-card {\r\n        position: relative;\r\n        background: linear-gradient(\r\n          135deg,\r\n          rgba(255, 255, 255, 0.03) 0%,\r\n          rgba(255, 255, 255, 0.08) 50%,\r\n          rgba(255, 255, 255, 0.03) 100%\r\n        );\r\n        backdrop-filter: blur(20px);\r\n        -webkit-backdrop-filter: blur(20px);\r\n        border-radius: 24px;\r\n        padding: clamp(2rem, 5vw, 3.5rem);\r\n        max-width: 850px;\r\n        width: 100%;\r\n        border: 1px solid rgba(255, 255, 255, 0.08);\r\n        box-shadow: \r\n          0 25px 50px -12px rgba(0, 0, 0, 0.5),\r\n          inset 0 1px 0 rgba(255, 255, 255, 0.1);\r\n        animation: cardEnter 1s cubic-bezier(0.16, 1, 0.3, 1);\r\n      }\r\n      \r\n      @keyframes cardEnter {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(40px) scale(0.95);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0) scale(1);\r\n        }\r\n      }\r\n      \r\n      /* å¡ç‰‡é ‚éƒ¨è£é£¾ç·š */\r\n      .quote-card::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        width: 60%;\r\n        height: 1px;\r\n        background: linear-gradient(\r\n          90deg,\r\n          transparent,\r\n          rgba(139, 92, 246, 0.5),\r\n          rgba(236, 72, 153, 0.5),\r\n          transparent\r\n        );\r\n      }\r\n      \r\n      /* ===== åˆ†é¡æ¨™ç±¤ ===== */\r\n      .category-tag {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 0.4rem;\r\n        padding: 0.4rem 1rem;\r\n        background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2));\r\n        border: 1px solid rgba(139, 92, 246, 0.3);\r\n        border-radius: 20px;\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .category-icon {\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      /* ===== å¼•è™Ÿè£é£¾ ===== */\r\n      .quote-mark {\r\n        font-family: Georgia, serif;\r\n        font-size: 4rem;\r\n        line-height: 1;\r\n        color: rgba(139, 92, 246, 0.3);\r\n        margin-bottom: -1rem;\r\n        user-select: none;\r\n      }\r\n      \r\n      /* ===== èªéŒ„æ–‡å­— ===== */\r\n      .quote-wrapper {\r\n        position: relative;\r\n        min-height: 120px;\r\n      }\r\n      \r\n      .quote-text {\r\n        font-family: 'Noto Serif TC', serif;\r\n        color: rgba(255, 255, 255, 0.95);\r\n        margin-bottom: 1.5rem;\r\n        animation: textFade 0.8s ease-out;\r\n      }\r\n      \r\n      @keyframes textFade {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(10px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n      \r\n      /* çŸ­èªéŒ„ */\r\n      .quote-text.short {\r\n        font-size: clamp(1.4rem, 3vw, 1.9rem);\r\n        font-weight: 400;\r\n        line-height: 2;\r\n        letter-spacing: 0.08em;\r\n        text-align: center;\r\n      }\r\n      \r\n      /* ä¸­ç­‰é•·åº¦ */\r\n      .quote-text.medium {\r\n        font-size: clamp(1.1rem, 2.2vw, 1.35rem);\r\n        font-weight: 400;\r\n        line-height: 2.2;\r\n        letter-spacing: 0.05em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* é•·æ•…äº‹ */\r\n      .quote-text.long {\r\n        font-size: clamp(1rem, 1.8vw, 1.15rem);\r\n        font-weight: 400;\r\n        line-height: 2.4;\r\n        letter-spacing: 0.03em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* ===== ä½œè€…å€ ===== */\r\n      .author-section {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        padding-top: 1.5rem;\r\n        border-top: 1px solid rgba(255, 255, 255, 0.08);\r\n        animation: authorFade 0.8s ease-out 0.3s both;\r\n      }\r\n      \r\n      @keyframes authorFade {\r\n        from { opacity: 0; }\r\n        to { opacity: 1; }\r\n      }\r\n      \r\n      .author-line {\r\n        width: 30px;\r\n        height: 1px;\r\n        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));\r\n      }\r\n      \r\n      .author-line:last-child {\r\n        background: linear-gradient(90deg, rgba(255, 255, 255, 0.4), transparent);\r\n      }\r\n      \r\n      .quote-author {\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 1rem;\r\n        color: rgba(255, 255, 255, 0.6);\r\n        font-style: normal;\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      /* ===== å­—æ•¸é¡¯ç¤º ===== */\r\n      .char-count {\r\n        text-align: center;\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        margin-top: 1rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      /* ===== æŒ‰éˆ•å€ ===== */\r\n      .button-group {\r\n        display: flex;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        margin-top: 2rem;\r\n        flex-wrap: wrap;\r\n      }\r\n      \r\n      .action-btn {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 0.5rem;\r\n        padding: 0.9rem 1.8rem;\r\n        border-radius: 50px;\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 0.95rem;\r\n        letter-spacing: 0.1em;\r\n        cursor: pointer;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border: none;\r\n        outline: none;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);\r\n        color: white;\r\n        box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: translateY(-3px) scale(1.02);\r\n        box-shadow: 0 8px 30px rgba(99, 102, 241, 0.5);\r\n      }\r\n      \r\n      .refresh-btn:active {\r\n        transform: translateY(0) scale(0.98);\r\n      }\r\n      \r\n      .secondary-btn {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        color: rgba(255, 255, 255, 0.7);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .secondary-btn:hover {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        color: white;\r\n        transform: translateY(-2px);\r\n      }\r\n      \r\n      .secondary-btn.active {\r\n        background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(239, 68, 68, 0.2));\r\n        border-color: rgba(236, 72, 153, 0.4);\r\n        color: #f472b6;\r\n      }\r\n      \r\n      /* ===== é€²åº¦æ¢ ===== */\r\n      .progress-section {\r\n        margin-top: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .progress-bar-container {\r\n        width: 100%;\r\n        max-width: 300px;\r\n        height: 3px;\r\n        background: rgba(255, 255, 255, 0.1);\r\n        border-radius: 3px;\r\n        margin: 0 auto 0.8rem;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .progress-bar-fill {\r\n        height: 100%;\r\n        background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);\r\n        border-radius: 3px;\r\n        transition: width 1s linear;\r\n      }\r\n      \r\n      .timer-text {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      .countdown {\r\n        font-family: 'SF Mono', 'Consolas', monospace;\r\n        color: rgba(255, 255, 255, 0.6);\r\n      }\r\n      \r\n      /* ===== æ”¶è—åˆ—è¡¨ Modal ===== */\r\n      .favorites-panel {\r\n        position: fixed;\r\n        top: 0;\r\n        right: -400px;\r\n        width: 380px;\r\n        max-width: 90vw;\r\n        height: 100vh;\r\n        background: linear-gradient(180deg, rgba(15, 15, 25, 0.98), rgba(10, 10, 15, 0.98));\r\n        backdrop-filter: blur(20px);\r\n        z-index: 1000;\r\n        padding: 2rem;\r\n        overflow-y: auto;\r\n        transition: right 0.5s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border-left: 1px solid rgba(255, 255, 255, 0.1);\r\n        box-shadow: -10px 0 40px rgba(0, 0, 0, 0.5);\r\n      }\r\n      \r\n      .favorites-panel.open {\r\n        right: 0;\r\n      }\r\n      \r\n      .panel-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-bottom: 2rem;\r\n        padding-bottom: 1rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .panel-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: 1.3rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .close-btn {\r\n        background: none;\r\n        border: none;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 1.5rem;\r\n        cursor: pointer;\r\n        padding: 0.5rem;\r\n        transition: color 0.3s;\r\n      }\r\n      \r\n      .close-btn:hover {\r\n        color: white;\r\n      }\r\n      \r\n      .favorite-item {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        border-radius: 12px;\r\n        padding: 1.2rem;\r\n        margin-bottom: 1rem;\r\n        border: 1px solid rgba(255, 255, 255, 0.05);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .favorite-item:hover {\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border-color: rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .favorite-quote {\r\n        font-size: 0.9rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        line-height: 1.8;\r\n        margin-bottom: 0.8rem;\r\n      }\r\n      \r\n      .favorite-author {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        text-align: right;\r\n      }\r\n      \r\n      .empty-favorites {\r\n        text-align: center;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        padding: 3rem 1rem;\r\n        font-size: 0.9rem;\r\n        line-height: 1.8;\r\n      }\r\n      \r\n      /* ===== é®ç½©å±¤ ===== */\r\n      .overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        z-index: 999;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .overlay.show {\r\n        opacity: 1;\r\n        visibility: visible;\r\n      }\r\n      \r\n      /* ===== å¿«æ·éµæç¤º (å·¦å´) ===== */\r\n      .shortcut-hint {\r\n        position: fixed;\r\n        left: 1.5rem;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.5rem;\r\n        z-index: 100;\r\n      }\r\n      \r\n      .shortcut-panel {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        backdrop-filter: blur(10px);\r\n        border: 1px solid rgba(255, 255, 255, 0.06);\r\n        border-radius: 12px;\r\n        padding: 1rem 0.8rem;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.6rem;\r\n      }\r\n      \r\n      .shortcut-title {\r\n        font-size: 0.65rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        letter-spacing: 0.15em;\r\n        text-transform: uppercase;\r\n        margin-bottom: 0.3rem;\r\n        padding-bottom: 0.5rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.06);\r\n      }\r\n      \r\n      .shortcut-item {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 0.6rem;\r\n        padding: 0.3rem 0;\r\n        transition: all 0.3s ease;\r\n        border-radius: 6px;\r\n        cursor: default;\r\n      }\r\n      \r\n      .shortcut-item:hover {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        padding-left: 0.4rem;\r\n        padding-right: 0.4rem;\r\n        margin-left: -0.4rem;\r\n        margin-right: -0.4rem;\r\n      }\r\n      \r\n      .shortcut-item:hover .key {\r\n        background: rgba(139, 92, 246, 0.3);\r\n        border-color: rgba(139, 92, 246, 0.5);\r\n        color: rgba(255, 255, 255, 0.9);\r\n      }\r\n      \r\n      .shortcut-item:hover .shortcut-label {\r\n        color: rgba(255, 255, 255, 0.7);\r\n      }\r\n      \r\n      .key {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        min-width: 28px;\r\n        height: 26px;\r\n        padding: 0 8px;\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        border-radius: 6px;\r\n        font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;\r\n        font-size: 0.7rem;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .shortcut-label {\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.05em;\r\n        transition: color 0.3s ease;\r\n      }\r\n      \r\n      /* ===== é€šçŸ¥æç¤º ===== */\r\n      .toast {\r\n        position: fixed;\r\n        bottom: 80px;\r\n        left: 50%;\r\n        transform: translateX(-50%) translateY(100px);\r\n        background: rgba(20, 20, 30, 0.95);\r\n        backdrop-filter: blur(10px);\r\n        padding: 0.8rem 1.5rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 0.9rem;\r\n        letter-spacing: 0.05em;\r\n        opacity: 0;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        z-index: 2000;\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .toast.show {\r\n        opacity: 1;\r\n        transform: translateX(-50%) translateY(0);\r\n      }\r\n      \r\n      /* ===== éŸ¿æ‡‰å¼è¨­è¨ˆ ===== */\r\n      @media (max-width: 768px) {\r\n        .main-container {\r\n          padding: 1rem;\r\n        }\r\n        \r\n        .quote-card {\r\n          padding: 1.5rem;\r\n          border-radius: 16px;\r\n        }\r\n        \r\n        .quote-mark {\r\n          font-size: 3rem;\r\n        }\r\n        \r\n        .button-group {\r\n          flex-direction: column;\r\n          align-items: stretch;\r\n        }\r\n        \r\n        .action-btn {\r\n          width: 100%;\r\n        }\r\n        \r\n        .shortcut-hint {\r\n          display: none;\r\n        }\r\n        \r\n        .favorites-panel {\r\n          width: 100%;\r\n          right: -100%;\r\n        }\r\n      }\r\n      \r\n      @media (max-width: 1100px) {\r\n        .shortcut-hint {\r\n          left: 0.8rem;\r\n        }\r\n        \r\n        .shortcut-panel {\r\n          padding: 0.7rem 0.5rem;\r\n        }\r\n        \r\n        .shortcut-label {\r\n          display: none;\r\n        }\r\n        \r\n        .shortcut-title {\r\n          font-size: 0.55rem;\r\n          text-align: center;\r\n        }\r\n      }\r\n      \r\n      /* ===== æ·±è‰²ä¸»é¡Œæ»¾å‹•æ¢ ===== */\r\n      ::-webkit-scrollbar {\r\n        width: 6px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-track {\r\n        background: rgba(255, 255, 255, 0.05);\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb {\r\n        background: rgba(255, 255, 255, 0.2);\r\n        border-radius: 3px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb:hover {\r\n        background: rgba(255, 255, 255, 0.3);\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  # èƒŒæ™¯å±¤\r\n  div(class = \"bg-container\",\r\n    div(class = \"bg-gradient\"),\r\n    div(class = \"floating-orb orb-1\"),\r\n    div(class = \"floating-orb orb-2\"),\r\n    div(class = \"floating-orb orb-3\"),\r\n    div(class = \"stars\")\r\n  ),\r\n  \r\n  # ä¸»å…§å®¹\r\n  div(class = \"main-container\",\r\n    # æ¨™é¡Œ\r\n    div(class = \"header\",\r\n      h1(class = \"main-title\", \"å¿ƒéˆé©›ç«™\"),\r\n      p(class = \"sub-title\", \"DAILY INSPIRATIONS\")\r\n    ),\r\n    \r\n    # èªéŒ„å¡ç‰‡\r\n    div(class = \"quote-card\",\r\n      # åˆ†é¡æ¨™ç±¤\r\n      uiOutput(\"category_tag\"),\r\n      \r\n      # å¼•è™Ÿè£é£¾\r\n      div(class = \"quote-mark\", \"ã€Œ\"),\r\n      \r\n      # èªéŒ„å…§å®¹\r\n      div(class = \"quote-wrapper\",\r\n        uiOutput(\"quote_display\")\r\n      ),\r\n      \r\n      # ä½œè€…\r\n      div(class = \"author-section\",\r\n        span(class = \"author-line\"),\r\n        span(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n        span(class = \"author-line\")\r\n      ),\r\n      \r\n      # å­—æ•¸\r\n      div(class = \"char-count\", textOutput(\"char_count\", inline = TRUE)),\r\n      \r\n      # æŒ‰éˆ•çµ„\r\n      div(class = \"button-group\",\r\n        actionButton(\"refresh\", \r\n          tagList(icon(\"rotate\"), \"æ›ä¸€å‰‡\"),\r\n          class = \"action-btn refresh-btn\"\r\n        ),\r\n        actionButton(\"favorite\", \r\n          tagList(uiOutput(\"fav_icon\", inline = TRUE), \"æ”¶è—\"),\r\n          class = \"action-btn secondary-btn\"\r\n        ),\r\n        actionButton(\"show_favorites\", \r\n          tagList(icon(\"heart\"), \"æ”¶è—å¤¾\"),\r\n          class = \"action-btn secondary-btn\"\r\n        )\r\n      ),\r\n      \r\n      # é€²åº¦æ¢\r\n      div(class = \"progress-section\",\r\n        div(class = \"progress-bar-container\",\r\n          div(id = \"progress-fill\", class = \"progress-bar-fill\", style = \"width: 100%;\")\r\n        ),\r\n        div(class = \"timer-text\",\r\n          \"ä¸‹ä¸€å‰‡ï¼š\",\r\n          span(class = \"countdown\", textOutput(\"countdown\", inline = TRUE))\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # æ”¶è—é¢æ¿é®ç½©\r\n  div(id = \"overlay\", class = \"overlay\"),\r\n  \r\n  # æ”¶è—é¢æ¿\r\n  div(id = \"favorites-panel\", class = \"favorites-panel\",\r\n    div(class = \"panel-header\",\r\n      span(class = \"panel-title\", \"ğŸ’œ æˆ‘çš„æ”¶è—\"),\r\n      actionButton(\"close_panel\", \"Ã—\", class = \"close-btn\")\r\n    ),\r\n    uiOutput(\"favorites_list\")\r\n  ),\r\n  \r\n  # Toast é€šçŸ¥\r\n  div(id = \"toast\", class = \"toast\", textOutput(\"toast_message\", inline = TRUE)),\r\n  \r\n  # å¿«æ·éµæç¤º (å·¦å´)\r\n  div(class = \"shortcut-hint\",\r\n    div(class = \"shortcut-panel\",\r\n      div(class = \"shortcut-title\", \"å¿«æ·éµ\"),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Space\"),\r\n        span(class = \"shortcut-label\", \"æ›ä¸€å‰‡\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"F\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"L\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—å¤¾\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Esc\"),\r\n        span(class = \"shortcut-label\", \"é—œé–‰\")\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # JavaScript\r\n  tags$script(HTML(\"\r\n    // éµç›¤å¿«æ·éµ\r\n    document.addEventListener('keydown', function(e) {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\r\n      \r\n      if (e.code === 'Space') {\r\n        e.preventDefault();\r\n        document.getElementById('refresh').click();\r\n      } else if (e.key.toLowerCase() === 'f') {\r\n        document.getElementById('favorite').click();\r\n      } else if (e.key.toLowerCase() === 'l') {\r\n        document.getElementById('show_favorites').click();\r\n      } else if (e.key === 'Escape') {\r\n        document.getElementById('close_panel').click();\r\n      }\r\n    });\r\n    \r\n    // æ”¶è—é¢æ¿æ§åˆ¶\r\n    Shiny.addCustomMessageHandler('togglePanel', function(open) {\r\n      var panel = document.getElementById('favorites-panel');\r\n      var overlay = document.getElementById('overlay');\r\n      if (open) {\r\n        panel.classList.add('open');\r\n        overlay.classList.add('show');\r\n      } else {\r\n        panel.classList.remove('open');\r\n        overlay.classList.remove('show');\r\n      }\r\n    });\r\n    \r\n    // é»æ“Šé®ç½©é—œé–‰é¢æ¿\r\n    document.getElementById('overlay').addEventListener('click', function() {\r\n      document.getElementById('close_panel').click();\r\n    });\r\n    \r\n    // Toast é€šçŸ¥\r\n    Shiny.addCustomMessageHandler('showToast', function(message) {\r\n      var toast = document.getElementById('toast');\r\n      document.getElementById('toast_message').innerText = message;\r\n      toast.classList.add('show');\r\n      setTimeout(function() {\r\n        toast.classList.remove('show');\r\n      }, 2500);\r\n    });\r\n    \r\n    // æ›´æ–°é€²åº¦æ¢\r\n    Shiny.addCustomMessageHandler('updateProgress', function(percent) {\r\n      document.getElementById('progress-fill').style.width = percent + '%';\r\n    });\r\n  \"))\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  favorites <- reactiveVal(integer(0))\r\n  \r\n  # è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  total_time <- 600\r\n  \r\n  # Toast è¨Šæ¯\r\n  toast_msg <- reactiveVal(\"\")\r\n  \r\n  # æ¯ç§’æ›´æ–°\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n        # æ›´æ–°é€²åº¦æ¢\r\n        percent <- (t / total_time) * 100\r\n        session$sendCustomMessage(\"updateProgress\", percent)\r\n      } else {\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(total_time)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(total_time)\r\n  })\r\n  \r\n  # æ”¶è—/å–æ¶ˆæ”¶è—\r\n  observeEvent(input$favorite, {\r\n    idx <- current_index()\r\n    fav <- favorites()\r\n    \r\n    if (idx %in% fav) {\r\n      favorites(setdiff(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²å¾æ”¶è—å¤¾ç§»é™¤\")\r\n    } else {\r\n      favorites(c(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²åŠ å…¥æ”¶è—å¤¾ ğŸ’œ\")\r\n    }\r\n  })\r\n  \r\n  # é¡¯ç¤ºæ”¶è—é¢æ¿\r\n  observeEvent(input$show_favorites, {\r\n    session$sendCustomMessage(\"togglePanel\", TRUE)\r\n  })\r\n  \r\n  # é—œé–‰æ”¶è—é¢æ¿\r\n  observeEvent(input$close_panel, {\r\n    session$sendCustomMessage(\"togglePanel\", FALSE)\r\n  })\r\n  \r\n  # ç²å–å°ºå¯¸é¡åˆ¥\r\n  get_size_class <- function(text) {\r\n    n <- nchar(text)\r\n    if (n <= 100) \"short\"\r\n    else if (n <= 200) \"medium\"\r\n    else \"long\"\r\n  }\r\n  \r\n  # åˆ†é¡æ¨™ç±¤\r\n  output$category_tag <- renderUI({\r\n    cat <- quotes$category[current_index()]\r\n    icons <- list(\r\n      \"å‹‡æ°£\" = \"ğŸ¦\", \"è‡ªçœ\" = \"ğŸª\", \"è¡Œå‹•\" = \"ğŸš€\", \"æ™‚é–“\" = \"â°\", \"å¤¢æƒ³\" = \"âœ¨\",\r\n      \"åŠªåŠ›\" = \"ğŸ’ª\", \"æ¯…åŠ›\" = \"ğŸ”ï¸\", \"åˆå¿ƒ\" = \"ğŸŒ±\", \"æˆé•·\" = \"ğŸŒ³\", \"è‡ªä¿¡\" = \"ğŸ‘‘\",\r\n      \"æ¸´æœ›\" = \"ğŸ”¥\", \"é€†å¢ƒ\" = \"ğŸŒŠ\", \"è€å¿ƒ\" = \"ğŸ‹\", \"å¿ƒæ…‹\" = \"ğŸ§ \", \"æ‰¹è©•\" = \"ğŸ¨\"\r\n    )\r\n    icon <- icons[[cat]] %||% \"ğŸ’«\"\r\n    \r\n    div(class = \"category-tag\",\r\n      span(class = \"category-icon\", icon),\r\n      cat\r\n    )\r\n  })\r\n  \r\n  # é¡¯ç¤ºèªéŒ„\r\n  output$quote_display <- renderUI({\r\n    quote_text <- quotes$quote[current_index()]\r\n    size_class <- get_size_class(quote_text)\r\n    div(class = paste(\"quote-text\", size_class), quote_text)\r\n  })\r\n  \r\n  # ä½œè€…\r\n  output$quote_author <- renderText({\r\n    quotes$author[current_index()]\r\n  })\r\n  \r\n  # å­—æ•¸\r\n  output$char_count <- renderText({\r\n    paste0(\"å…± \", nchar(quotes$quote[current_index()]), \" å­—\")\r\n  })\r\n  \r\n  # æ”¶è—åœ–æ¨™\r\n  output$fav_icon <- renderUI({\r\n    if (current_index() %in% favorites()) {\r\n      icon(\"heart\", class = \"fas\", style = \"color: #f472b6;\")\r\n    } else {\r\n      icon(\"heart\", class = \"far\")\r\n    }\r\n  })\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    sprintf(\"%02d:%02d\", floor(t / 60), t %% 60)\r\n  })\r\n  \r\n  # Toast è¨Šæ¯è¼¸å‡º\r\n  output$toast_message <- renderText({\r\n    toast_msg()\r\n  })\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  output$favorites_list <- renderUI({\r\n    fav <- favorites()\r\n    \r\n    if (length(fav) == 0) {\r\n      return(div(class = \"empty-favorites\",\r\n        p(\"ğŸŒ™\"),\r\n        p(\"é‚„æ²’æœ‰æ”¶è—ä»»ä½•èªéŒ„\"),\r\n        p(\"é»æ“Šã€Œæ”¶è—ã€æŒ‰éˆ•æˆ–æŒ‰ F éµå³å¯æ”¶è—\")\r\n      ))\r\n    }\r\n    \r\n    tagList(\r\n      lapply(fav, function(idx) {\r\n        div(class = \"favorite-item\",\r\n          div(class = \"favorite-quote\",\r\n            substr(quotes$quote[idx], 1, 80),\r\n            if (nchar(quotes$quote[idx]) > 80) \"...\" else \"\"\r\n          ),\r\n          div(class = \"favorite-author\",\r\n            paste(\"â€”\", quotes$author[idx])\r\n          )\r\n        )\r\n      })\r\n    )\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"v5.R","content":"library(shiny)\r\nlibrary(bslib)\r\n\r\n# å‹µå¿—èªéŒ„è³‡æ–™ - å¢åŠ åˆ†é¡æ¨™ç±¤\r\nquotes <- data.frame(\r\n  quote = c(\r\n    # 20260131\r\n    \"ç”Ÿç‰©å­¸å®¶æ›¾åšéä¸€å€‹å¯¦é©—ï¼šå°‡è·³èš¤æ”¾é€²ç»ç’ƒç½ï¼Œè·³èš¤æœƒè¼•æ˜“è·³å‡ºã€‚éš¨å¾Œï¼Œå¯¦é©—è€…è“‹ä¸Šé€æ˜è“‹å­ï¼Œè·³èš¤æ¯æ¬¡è·³èºéƒ½æœƒæ’åˆ°è“‹å­ã€‚ ä¸€æ®µæ™‚é–“å¾Œï¼Œå³ä¾¿æ‹¿æ‰è“‹å­ï¼Œè·³èš¤ä¹Ÿå†ä¹Ÿä¸æœƒè·³å‡ºç½å£äº†â€”â€”å› ç‚ºç‰ å·²ç¶“ã€Œå­¸æœƒã€äº†é«˜åº¦çš„é™åˆ¶ã€‚å¾ˆå¤šæ™‚å€™ï¼Œæˆ‘å€‘å°±åƒé‚£éš»è·³èš¤ã€‚éå»çš„æŒ«æŠ˜æˆäº†æˆ‘å€‘é ­é ‚çœ‹ä¸è¦‹çš„è“‹å­ï¼Œè®“æˆ‘å€‘å¿˜äº†è‡ªå·±å…¶å¯¦æ“æœ‰è·³å¾—æ›´é«˜ã€çœ‹æ›´é çš„èƒ½åŠ›ã€‚\",\r\n    \"éµé”å°¼è™Ÿä¸æ˜¯æ’ä¸Šäº†æµ·é¢ä¸Šçš„å†°å¡Šï¼Œè€Œæ˜¯æ’ä¸Šäº†æµ·é¢ä¸‹çœ‹ä¸è¦‹çš„å·¨å¤§å†°å±±ã€‚ äººçš„èƒ½åŠ›ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä½ ç¾åœ¨è¡¨ç¾å‡ºä¾†çš„ã€Œè¡Œç‚ºã€ï¼Œåªæ˜¯éœ²åœ¨æ°´é¢ä¸Šçš„ 10%ã€‚è€Œé‚£äº›è¢«å£“æŠ‘çš„å‹‡æ°£ã€å‰µé€ åŠ›èˆ‡éŸŒæ€§ï¼Œéƒ½æ²‰ç¡åœ¨æ·±æµ·ä¹‹ä¸­ã€‚ä¸è¦ç”¨é‚£ 10% çš„ç¾æ³ä¾†å®šç¾©ä½ è‡ªå·±ã€‚åªè¦ä½ é¡˜æ„æŒ–æ˜ï¼Œæµ·é¢ä¸‹é‚„æœ‰ 90% çš„å¥‡è¹Ÿç­‰è‘—è¢«ä½ å–šé†’ã€‚\",\r\n    \"æœ‰å…©å€‹äººç”Ÿç—…ä½åœ¨åŒä¸€å€‹ç—…æˆ¿ï¼Œå…¶ä¸­ä¸€å€‹äººé çª—ï¼Œæ¯å¤©ä»–éƒ½æœƒå‘å®¤å‹æè¿°çª—å¤–çš„æ™¯è±¡ï¼š ã€Œä»Šå¤©å…¬åœ’è£¡æœ‰å­©å­åœ¨æ”¾é¢¨ç®ï¼Œæ¹–é¢ä¸Šæœ‰å¤©éµåœ¨æˆ²æ°´ï¼Œå¤©æ°£å¥½æ¥µäº†ã€‚ã€ å¦ä¸€ä½å®¤å‹è½è‘—è½è‘—ï¼Œå¿ƒè£¡æ¼¸æ¼¸ç”¢ç”Ÿäº†å¸Œæœ›ï¼Œæ¯å¤©éƒ½æœŸå¾…è‘—é€™æ®µæè¿°ã€‚ å¾Œä¾†ï¼Œé çª—çš„äººå‡ºé™¢äº†ï¼Œå¦ä¸€äººè¿«ä¸åŠå¾…åœ°çœ‹å‘çª—å¤–ï¼Œå»ç™¼ç¾çª—å¤–åªæœ‰ä¸€å µå†·å†°å†°çš„ç£šç‰†ã€‚ä»–é€™æ‰æ˜ç™½ï¼Œç¾å¥½çš„é¢¨æ™¯ä¸ä¸€å®šæ˜¯åœ¨çª—å¤–ï¼Œè€Œæ˜¯åœ¨ä¸€å€‹äººçš„å¿ƒè£¡ã€‚å¦‚æœä½ å¿ƒä¸­æœ‰å…‰ï¼Œå³ä¾¿é¢å°æ®˜ç‰†ï¼Œä¹Ÿèƒ½çœ‹è¦‹è¬ç´«åƒç´…ã€‚\",\r\n    \"ä¸€ä½å¹´è¼•çš„æ¨‚å¸«å•ä½›é™€ï¼šã€Œæˆ‘æ¯å¤©ä¿®è¡Œéå¸¸åˆ»è‹¦ï¼Œç‚ºä»€éº¼é‚„æ˜¯æ„Ÿè¦ºä¸åˆ°é€²æ­¥ï¼Ÿã€ ä½›é™€å•ä»–ï¼šã€Œä½ å½ˆç´æ™‚ï¼Œå¦‚æœç´å¼¦èª¿å¾—å¤ªç·Šæœƒæ€æ¨£ï¼Ÿã€ æ¨‚å¸«ç­”ï¼šã€Œå¼¦æœƒæ–·ã€‚ã€ ä½›é™€åˆå•ï¼šã€Œå¦‚æœèª¿å¾—å¤ªé¬†å‘¢ï¼Ÿã€ æ¨‚å¸«ç­”ï¼šã€Œå½ˆä¸å‡ºè²éŸ³ã€‚ã€ ä½›é™€å¾®ç¬‘èªªï¼šã€Œä¿®è¡Œèˆ‡ç”Ÿæ´»ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¤ªç·Šå‰‡ç´¯ï¼Œå¤ªé¬†å‰‡å»¢ã€‚å”¯æœ‰ä¿æŒé©åº¦çš„å¼µåŠ›ï¼Œæ‰èƒ½å½ˆå¥å‡ºç¾å¦™çš„æ¨‚ç« ã€‚ã€\",\r\n    \r\n    # çŸ­èªéŒ„ (100å­—ä»¥å…§)\r\n    \"æˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯è‡´å‘½çš„ï¼Œé‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚\",\r\n    \"æ¯ä¸€å€‹ä½ ä¸æ»¿æ„çš„ç¾åœ¨ï¼Œéƒ½æœ‰ä¸€å€‹ä½ æ²’æœ‰åŠªåŠ›çš„æ›¾ç¶“ã€‚\",\r\n    \"ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚\",\r\n    \"ä½ çš„æ™‚é–“æœ‰é™ï¼Œä¸è¦æµªè²»åœ¨åˆ¥äººçš„ç”Ÿæ´»è£¡ã€‚\",\r\n    \"å¤¢æƒ³ä¸æœƒé€ƒè·‘ï¼Œé€ƒè·‘çš„æ°¸é æ˜¯è‡ªå·±ã€‚\",\r\n    \"ä»Šå¤©çš„åŠªåŠ›æ˜¯æ˜å¤©çš„å¹¸é‹ã€‚\",\r\n    \"æ²’æœ‰æ¯”è…³æ›´é•·çš„è·¯ï¼Œæ²’æœ‰æ¯”äººæ›´é«˜çš„å±±ã€‚\",\r\n    \"ç•¶ä½ æ„Ÿåˆ°ç–²æ†Šæ™‚ï¼Œè¨˜å¾—ä½ ç‚ºä½•é–‹å§‹ã€‚\",\r\n    \"æ¯ä¸€æ¬¡è·Œå€’ï¼Œéƒ½æ˜¯ä¸€æ¬¡å­¸æœƒç«™èµ·ä¾†çš„æ©Ÿæœƒã€‚\",\r\n    \"ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ¯”æƒ³åƒä¸­æ›´å¼·å¤§ã€‚\",\r\n    \r\n    # å°æ•…äº‹ (100-300å­—)\r\n    \"æœ‰å€‹å¹´è¼•äººå•æ™ºè€…ï¼šã€Œå¦‚ä½•æ‰èƒ½æˆåŠŸï¼Ÿã€æ™ºè€…å¸¶ä»–åˆ°æ²³é‚Šï¼Œçªç„¶æŠŠä»–çš„é ­æŒ‰å…¥æ°´ä¸­ã€‚å¹´è¼•äººæ‹¼å‘½æ™æ‰ï¼Œçµ‚æ–¼æ™è„«ã€‚æ™ºè€…å•ï¼šã€Œåœ¨æ°´è£¡æ™‚ï¼Œä½ æœ€æƒ³è¦ä»€éº¼ï¼Ÿã€å¹´è¼•äººèªªï¼šã€Œç©ºæ°£ï¼ã€æ™ºè€…å¾®ç¬‘ï¼šã€Œç•¶ä½ æ¸´æœ›æˆåŠŸå¦‚åŒæ¸´æœ›ç©ºæ°£ä¸€æ¨£å¼·çƒˆæ™‚ï¼Œä½ å°±æœƒæˆåŠŸã€‚ã€æˆåŠŸä¸æ˜¯é é‹æ°£ï¼Œè€Œæ˜¯é é‚£ä»½æ°¸ä¸æ”¾æ£„çš„æ¸´æœ›èˆ‡æ±ºå¿ƒã€‚\",  \r\n    \"ä¸€ä½è€è¾²å¤«çš„é©¢å­æ‰é€²æ¯äº•è£¡ã€‚è€è¾²å¤«æƒ³äº†å¾ˆä¹…ï¼Œæ±ºå®šæ”¾æ£„æ•‘æ´ï¼Œç›´æ¥æŠŠäº•å¡«å¹³ã€‚ç•¶æ³¥åœŸè½åœ¨é©¢å­èº«ä¸Šæ™‚ï¼Œé©¢å­èµ·åˆå¾ˆé©šæï¼Œä½†éš¨å¾Œç‰ åšäº†ä¸€å€‹æ±ºå®šï¼šæ¯æ¬¡æ³¥åœŸè½ä¸‹ï¼Œå°±æŠ–è½èº«ä¸Šçš„åœŸï¼Œç„¶å¾Œè¸©ä¸Šå»ã€‚ä¸€éŸåˆä¸€éŸï¼Œé©¢å­ä¸æ–·å¾€ä¸Šå‡ã€‚æœ€å¾Œï¼Œç‰ è·³å‡ºäº†äº•å£ã€‚é‚£äº›æƒ³åŸ‹è‘¬ä½ çš„å›°é›£ï¼Œå…¶å¯¦éƒ½æ˜¯å¢Šé«˜ä½ çš„éšæ¢¯ã€‚\",\r\n    \"ç«¹å­åœ¨å‰å››å¹´åªé•·äº†ä¸‰å…¬åˆ†ï¼Œä½†å¾ç¬¬äº”å¹´é–‹å§‹ï¼Œæ¯å¤©ä»¥ä¸‰åå…¬åˆ†çš„é€Ÿåº¦ç˜‹ç‹‚ç”Ÿé•·ï¼Œåƒ…ç”¨å…­é€±å°±é•·åˆ°äº†åäº”å…¬å°ºã€‚åŸä¾†åœ¨å‰å››å¹´ï¼Œç«¹å­çš„æ ¹å·²ç¶“åœ¨åœŸå£¤è£¡å»¶ä¼¸äº†æ•¸ç™¾å¹³æ–¹å…¬å°ºã€‚äººç”Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¦æ“”å¿ƒä½ çš„ä»˜å‡ºæ²’æœ‰å›å ±ï¼Œä½ ç¾åœ¨åšçš„æ¯ä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯åœ¨æ‰æ ¹ã€‚æ™‚æ©Ÿä¸€åˆ°ï¼Œä½ æœƒæˆé•·å¾—æ¯”ä»»ä½•äººéƒ½å¿«ã€‚\",\r\n    \"æœ‰å€‹å°ç”·å­©å•çˆ¶è¦ªï¼šã€Œçˆ¸çˆ¸ï¼Œæˆ‘å€‘å®¶å¾ˆçª®å—ï¼Ÿã€çˆ¶è¦ªèªªï¼šã€Œä¸ï¼Œæˆ‘å€‘åªæ˜¯æš«æ™‚æ²’æœ‰éŒ¢ã€‚çª®æ˜¯ä¸€ç¨®å¿ƒæ…‹ï¼Œè€Œæ²’æœ‰éŒ¢åªæ˜¯ä¸€ç¨®ç‹€æ…‹ã€‚ç‹€æ…‹å¯ä»¥æ”¹è®Šï¼Œä½†å¦‚æœä½ èªå®šè‡ªå·±çª®ï¼Œå°±æœƒæ°¸é çª®ã€‚ã€å¤šå¹´å¾Œï¼Œé€™å€‹ç”·å­©æˆç‚ºæˆåŠŸçš„ä¼æ¥­å®¶ã€‚ä»–èªªï¼šã€Œçˆ¶è¦ªé‚£ç•ªè©±æ”¹è®Šäº†æˆ‘çš„ä¸€ç”Ÿã€‚æˆ‘å¾ä¸èªç‚ºè‡ªå·±æ˜¯çª®äººï¼Œæˆ‘åªæ˜¯é‚„åœ¨é€šå¾€å¯Œæœ‰çš„è·¯ä¸Šã€‚ã€\",\r\n    \"ä¸€ä½ç•«å®¶æŠŠä½œå“æ”¾åœ¨å»£å ´ä¸Šï¼Œè«‹è·¯äººç”¨ç´…ç­†åœˆå‡ºç¼ºé»ã€‚ä¸€å¤©å¾Œï¼Œç•«ä½œè¢«åœˆå¾—æ»¿æ»¿çš„ã€‚ä»–å¾ˆæ²®å–ªã€‚è€å¸«èªªï¼šã€Œå†ç•«ä¸€å¹…ï¼Œé€™æ¬¡è«‹è·¯äººåœˆå‡ºå„ªé»ã€‚ã€çµæœå„ªé»æ¯”ç¼ºé»é‚„å¤šã€‚è€å¸«èªªï¼šã€Œç„¡è«–ä½ åšä»€éº¼ï¼Œéƒ½æœƒæœ‰äººæ‰¹è©•ï¼Œä¹Ÿæœƒæœ‰äººæ¬£è³ã€‚ä½ è¦åšçš„ä¸æ˜¯è¨å¥½æ‰€æœ‰äººï¼Œè€Œæ˜¯ä¸æ–·ç²¾é€²ï¼Œè®“æ¬£è³ä½ çš„äººè¶Šä¾†è¶Šå¤šã€‚ã€\",\r\n    \r\n    # æ–°å¢å‹µå¿—å°æ•…äº‹\r\n    \"æ„›è¿ªç”Ÿåœ¨ç™¼æ˜ç‡ˆæ³¡å‰å¤±æ•—äº†ä¸€è¬æ¬¡ã€‚æœ‰äººå•ä»–ï¼šã€Œå¤±æ•—é€™éº¼å¤šæ¬¡ä¸ç°å¿ƒå—ï¼Ÿã€ä»–ç¬‘è‘—èªªï¼šã€Œæˆ‘æ²’æœ‰å¤±æ•—ï¼Œæˆ‘åªæ˜¯ç™¼ç¾äº†ä¸€è¬ç¨®ä¸èƒ½ç”¨çš„ææ–™ã€‚ã€æ¯ä¸€æ¬¡æ‰€è¬‚çš„å¤±æ•—ï¼Œéƒ½æ˜¯é€šå¾€æˆåŠŸçš„å¿…ç¶“ä¹‹è·¯ã€‚é‡é»ä¸æ˜¯è·Œå€’å¹¾æ¬¡ï¼Œè€Œæ˜¯ä½ é¡˜ä¸é¡˜æ„å†ç«™èµ·ä¾†ã€‚\",\r\n    \"å…©å€‹æ¨éŠ·å“¡è¢«æ´¾åˆ°éæ´²è³£é‹ã€‚ç¬¬ä¸€å€‹äººæŠµé”å¾Œç™¼é›»å ±å›å…¬å¸ï¼šã€Œé€™è£¡æ²’æœ‰å¸‚å ´ï¼Œå› ç‚ºæ‰€æœ‰äººéƒ½ä¸ç©¿é‹ã€‚ã€ç¬¬äºŒå€‹äººå»èˆˆå¥®åœ°å›å ±ï¼šã€Œé€™è£¡å•†æ©Ÿç„¡é™ï¼Œå› ç‚ºé‚„æ²’æœ‰äººç©¿é‹ï¼ã€åŒæ¨£çš„ç¾å¯¦ï¼Œä¸åŒçš„è¦–è§’ï¼Œé€ å°±æˆªç„¶ä¸åŒçš„å‘½é‹ã€‚ä½ çœ‹åˆ°çš„æ˜¯å›°é›£ï¼Œé‚„æ˜¯æ©Ÿæœƒï¼Ÿ\",\r\n    \"è€é·¹æ˜¯ä¸–ç•Œä¸Šå£½å‘½æœ€é•·çš„é³¥é¡ã€‚ä½†åœ¨ç‰  40 æ­²æ™‚ï¼Œçˆªå­æœƒé–‹å§‹è€åŒ–ã€å–™æœƒè®Šå¾—åˆé•·åˆå½ï¼Œç¾½æ¯›ä¹Ÿæœƒè®Šå¾—æ²‰é‡ã€‚é€™æ™‚ç‰ é¢è‡¨å…©å€‹é¸æ“‡ï¼šç­‰æ­»ï¼Œæˆ–æ˜¯ç¶“æ­· 150 å¤©ç—›è‹¦çš„ã€Œè›»è®Šã€ã€‚ ç‰ å¿…é ˆç”¨å–™æ“Šæ‰“å²©çŸ³ç›´åˆ°è„«è½ï¼Œé•·å‡ºæ–°å–™å¾Œï¼Œå†æŠŠè€åŒ–çš„è¶¾ç”²å’Œç¾½æ¯›ä¸€ä¸€æ‹”æ‰ã€‚é‡ç”Ÿå¾ˆç—›ï¼Œä½†ä¸é‡ç”Ÿå°±æ˜¯æ­»è·¯ä¸€æ¢ã€‚å¦‚æœä½ è¦ºå¾—ç¾ç‹€è®“ä½ çª’æ¯ï¼Œæˆ–è¨±æ˜¯å› ç‚ºä½ éœ€è¦ä¸€å ´å¾¹åº•çš„ã€Œè‡ªæˆ‘ä¿®å‰ªã€ï¼Œæ‹”æ‰é‚£äº›é™åˆ¶ä½ é£›ç¿”çš„è€èˆŠç¿’æ…£ã€‚\",\r\n    \"ä¸€ä½çˆ¶è¦ªé€å…’å­ä¸€å¡Šæ‰‹éŒ¶ï¼Œèªªï¼šã€Œé€™æ˜¯çˆºçˆºå‚³ä¸‹ä¾†çš„ï¼Œå…ˆå»ç•¶é‹ªå•å•å€¼å¤šå°‘éŒ¢ã€‚ã€ç•¶é‹ªçµ¦äº†ä¸€ç™¾å…ƒã€‚çˆ¶è¦ªåˆèªªï¼šã€Œå»å¤è‘£åº—å•å•ã€‚ã€å¤è‘£åº—é–‹åƒ¹åè¬ã€‚çˆ¶è¦ªèªªï¼šã€Œè¨˜ä½ï¼Œåªæœ‰åœ¨å°çš„åœ°æ–¹ï¼Œä½ çš„åƒ¹å€¼æ‰æœƒè¢«çœ‹è¦‹ã€‚ä¸è¦å¾…åœ¨ä¸æ‡‚å¾—æ¬£è³ä½ çš„ç’°å¢ƒè£¡ï¼Œé‚£åªæœƒè®“ä½ ä½ä¼°è‡ªå·±ã€‚ã€\",\r\n    \"æš´é¢¨é›¨å¾Œçš„æµ·ç˜ä¸Šï¼Œæˆåƒä¸Šè¬çš„æµ·æ˜Ÿè¢«æ²–ä¸Šå²¸ã€‚ä¸€å€‹å°ç”·å­©ä¸æ–·æ’¿èµ·æµ·æ˜Ÿä¸Ÿå›æµ·è£¡ã€‚è·¯äººèªªï¼šã€Œé€™éº¼å¤šæµ·æ˜Ÿï¼Œä½ æ•‘å¾—å®Œå—ï¼Ÿé€™æœ‰ä»€éº¼æ„ç¾©ï¼Ÿã€å°ç”·å­©æ’¿èµ·ä¸€éš»æµ·æ˜Ÿèªªï¼šã€Œå°é€™ä¸€éš»ä¾†èªªï¼Œå¾ˆæœ‰æ„ç¾©ã€‚ã€æ”¹è®Šä¸–ç•Œä¸éœ€è¦è½Ÿè½Ÿçƒˆçƒˆï¼Œæœ‰æ™‚åªéœ€è¦ä¸€å€‹å°å°çš„å–„èˆ‰ã€‚\",\r\n    \"é¦¬æˆ²åœ˜è£¡çš„å¤§è±¡ï¼Œå°æ™‚å€™è¢«ç´°ç¹©ç¶ä½ï¼Œæ™è„«ä¸äº†ã€‚é•·å¤§å¾ŒåŠ›æ°£è¶³ä»¥æ™æ–·éµéˆï¼Œå»ä»è¢«åŒä¸€æ¢ç´°ç¹©å›°ä½ï¼Œå› ç‚ºç‰ å·²ç¶“ç›¸ä¿¡è‡ªå·±æ™è„«ä¸äº†ã€‚æˆ‘å€‘æœ‰å¤šå°‘æ½›èƒ½ï¼Œæ˜¯è¢«éå»çš„å¤±æ•—ç¶“é©—æ‰€æŸç¸›ï¼ŸçœŸæ­£å›°ä½ä½ çš„ï¼Œå¾ä¾†ä¸æ˜¯ç’°å¢ƒï¼Œè€Œæ˜¯ä½ å¿ƒä¸­é‚£é“ç„¡å½¢çš„åœç‰†ã€‚\",\r\n    \"è´è¶ç ´ç¹­æ™‚ï¼Œæœ‰äººå‡ºæ–¼å¥½å¿ƒå¹«ç‰ å‰ªé–‹ç¹­ã€‚çµæœè´è¶å‡ºä¾†å¾Œç¿…è†€èç¸®ï¼Œæ°¸é ç„¡æ³•é£›ç¿”ã€‚åŸä¾†ï¼Œè´è¶å¿…é ˆé è‡ªå·±æ™æ‰çš„éç¨‹ï¼Œå°‡é«”æ¶²æ“ å…¥ç¿…è†€æ‰èƒ½å±•ç¿…ã€‚äººç”Ÿçš„æ™æ‰èˆ‡è‹¦é›£ï¼Œä¸æ˜¯æ‡²ç½°ï¼Œè€Œæ˜¯è®“æˆ‘å€‘èŒå£¯çš„å¿…è¦éç¨‹ã€‚\",\r\n    \"ä¸€ä½è€äººåœ¨è·¯é‚Šè³£æ°£çƒï¼Œç”Ÿæ„ä¸å¥½æ™‚å°±æ”¾ä¸€å€‹æ°£çƒä¸Šå¤©ã€‚æ¯æ¬¡æ°£çƒå‡ç©ºï¼Œå°±æœƒå¸å¼•å­©å­ä¾†è²·ã€‚ä¸€å€‹é»‘äººå°å­©å•ï¼šã€Œé»‘è‰²çš„æ°£çƒä¹Ÿèƒ½é£›å—ï¼Ÿã€è€äººå¾®ç¬‘è‘—æ”¾äº†ä¸€å€‹é»‘æ°£çƒï¼Œå®ƒåŒæ¨£é£›å‘å¤©ç©ºã€‚è€äººèªªï¼šã€Œå­©å­ï¼Œæ°£çƒèƒ½ä¸èƒ½é£›ï¼Œä¸æ˜¯çœ‹é¡è‰²ï¼Œè€Œæ˜¯çœ‹è£¡é¢æœ‰æ²’æœ‰æ°£ã€‚ã€æ±ºå®šä½ èƒ½é£›å¤šé«˜çš„ï¼Œæ˜¯ä½ å…§å¿ƒçš„åŠ›é‡ã€‚\",\r\n    \"ä¸€å€‹äººæŠ±æ€¨è‡ªå·±æ²’æœ‰é‹ç©¿ï¼Œç›´åˆ°ä»–é‡è¦‹ä¸€å€‹æ²’æœ‰è…³çš„äººã€‚é‚£äººååœ¨è·¯é‚Šï¼Œå¾®ç¬‘è‘—ç”¨é›™æ‰‹æ’åœ°å‰é€²ï¼Œçœ¼ä¸­æ²’æœ‰ä¸€çµ²æ€¨æ¨ã€‚ä»–çªç„¶æ˜ç™½ï¼šå¹¸ç¦ä¸æ˜¯æ“æœ‰å¤šå°‘ï¼Œè€Œæ˜¯è¨ˆè¼ƒå¤šå°‘ã€‚ç•¶ä½ é–‹å§‹æ„Ÿæ©å·²æ“æœ‰çš„ï¼Œä½ æœƒç™¼ç¾è‡ªå·±æ¯”æƒ³åƒä¸­å¯Œæœ‰ã€‚\",\r\n    \"æœ‰äººå•è¾²å¤«ï¼šã€Œä½ æ¯å¤©éƒ½åœ¨åšä»€éº¼ï¼Ÿã€è¾²å¤«èªªï¼šã€Œæ˜¥å¤©æ’­ç¨®ï¼Œå¤å¤©è€•è€˜ï¼Œç§‹å¤©æ”¶ç©«ï¼Œå†¬å¤©ä¼‘æ¯ã€‚ã€é‚£äººåˆå•ï¼šã€Œé‚£ä»€éº¼æ™‚å€™æ‰èƒ½æˆåŠŸï¼Ÿã€è¾²å¤«ç¬‘èªªï¼šã€ŒæˆåŠŸæ²’æœ‰æ·å¾‘ï¼Œä½†æœ‰æ™‚åˆ»è¡¨ã€‚ä½ ä¸èƒ½åœ¨å†¬å¤©æ’­ç¨®ï¼Œä¹Ÿä¸èƒ½åœ¨æ˜¥å¤©æ”¶ç©«ã€‚åšå°çš„äº‹ï¼Œåœ¨å°çš„æ™‚é–“ï¼ŒæˆåŠŸè‡ªç„¶æœƒä¾†ã€‚ã€\",\r\n    \"å…©æ£µæ¨¹ç”Ÿé•·åœ¨æ‡¸å´–é‚Šã€‚ä¸€æ£µæŠ±æ€¨é¢¨å¤ªå¤§ã€åœŸå¤ªå°‘ï¼Œæœ€çµ‚æ¯èã€‚å¦ä¸€æ£µæŠŠæ ¹æ·±æ·±æ‰é€²å²©ç¸«ï¼Œåè€Œé•·å¾—æ›´åŠ å …éŸŒã€‚å¤šå¹´å¾Œï¼Œå®ƒæˆäº†æ‡¸å´–ä¸Šæœ€å£¯è§€çš„é¢¨æ™¯ã€‚æƒ¡åŠ£çš„ç’°å¢ƒä¸ä¸€å®šæ˜¯è©›å’’ï¼Œä¹Ÿå¯èƒ½æ˜¯è®“ä½ èˆ‡çœ¾ä¸åŒçš„ç¥ç¦ã€‚\",\r\n    \"ä¸‰éš»é’è›™ååœ¨è·è‘‰ä¸Šï¼Œå…¶ä¸­ä¸€éš»æ±ºå®šè·³é€²æ°´è£¡ã€‚è«‹å•è·è‘‰ä¸Šé‚„æœ‰å¹¾éš»é’è›™ï¼Ÿç­”æ¡ˆæ˜¯ä¸‰éš»ã€‚å› ç‚ºã€Œæ±ºå®šã€å’Œã€Œè¡Œå‹•ã€æ˜¯å…©å›äº‹ã€‚é€™å€‹ä¸–ç•Œä¸Šä¸ç¼ºæœ‰æƒ³æ³•çš„äººï¼Œç¼ºçš„æ˜¯æŠŠæƒ³æ³•ä»˜è«¸è¡Œå‹•çš„äººã€‚åˆ¥åªæ˜¯æƒ³ï¼Œå»åšå§ã€‚\"\r\n  ),\r\n  author = c(\r\n    #20260131\r\n    \"è·³èš¤çš„å¯¦é©—\",\r\n    \"å†°å±±ä¸‹çš„ä¹æˆ\",\r\n    \"çª—å¤–çš„é¢¨æ™¯\",\r\n    \"ç·Šç¹ƒçš„ç´å¼¦\",\r\n    \r\n    \"æº«æ–¯é “Â·é‚±å‰çˆ¾\",\r\n    \"ä½šå\",\r\n    \"å–¬æ²»Â·è•­ä¼¯ç´\",\r\n    \"å²è’‚å¤«Â·è³ˆä¼¯æ–¯\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ±ªåœ‹çœŸ\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"ä½šå\",\r\n    \"æ™ºè€…èˆ‡æ²³çš„æ•…äº‹\",\r\n    \"é©¢å­èˆ‡æ¯äº•çš„æ•…äº‹\",\r\n    \"ç«¹å­çš„å•Ÿç¤º\",\r\n    \"çª®èˆ‡æ²’éŒ¢çš„æ•…äº‹\",\r\n    \"ç•«å®¶èˆ‡è·¯äººçš„æ•…äº‹\",\r\n    \"æ„›è¿ªç”Ÿçš„ç‡ˆæ³¡\",\r\n    \"éæ´²è³£é‹çš„æ•…äº‹\",\r\n    \"è€é·¹é‡ç”Ÿçš„æ•…äº‹\",\r\n    \"æ‰‹éŒ¶èˆ‡åƒ¹å€¼çš„æ•…äº‹\",\r\n    \"æµ·æ˜Ÿç”·å­©çš„æ•…äº‹\",\r\n    \"é¦¬æˆ²åœ˜å¤§è±¡çš„æ•…äº‹\",\r\n    \"è´è¶ç ´ç¹­çš„æ•…äº‹\",\r\n    \"æ°£çƒè€äººçš„æ•…äº‹\",\r\n    \"æ²’æœ‰é‹çš„äºº\",\r\n    \"è¾²å¤«çš„æ™‚åˆ»è¡¨\",\r\n    \"æ‡¸å´–é‚Šçš„å…©æ£µæ¨¹\",\r\n    \"ä¸‰éš»é’è›™çš„æ•…äº‹\"\r\n  ),\r\n  category = c(\r\n    #20260131\r\n    \"æ¡†æ¶\",\r\n    \"æ½›åŠ›\",\r\n    \"è¦–è§’\",\r\n    \"å¹³è¡¡\",\r\n\r\n    \"å‹‡æ°£\", \"è‡ªçœ\", \"è¡Œå‹•\", \"æ™‚é–“\", \"å¤¢æƒ³\",\r\n    \"åŠªåŠ›\", \"æ¯…åŠ›\", \"åˆå¿ƒ\", \"æˆé•·\", \"è‡ªä¿¡\",\r\n    \"æ¸´æœ›\", \"é€†å¢ƒ\", \"è€å¿ƒ\", \"å¿ƒæ…‹\", \"æ‰¹è©•\",\r\n    \"å …æŒ\", \"è¦–è§’\", \"é‡ç”Ÿ\", \"åƒ¹å€¼\", \"å–„è‰¯\",\r\n    \"æ½›èƒ½\", \"ç£¨ç·´\", \"å…§åœ¨\", \"æ„Ÿæ©\", \"æ™‚æ©Ÿ\",\r\n    \"éŸŒæ€§\", \"è¡Œå‹•\"\r\n  ),\r\n  stringsAsFactors = FALSE\r\n)\r\n\r\nui <- page_fillable(\r\n  theme = bs_theme(\r\n    version = 5,\r\n    bootswatch = \"flatly\",\r\n    bg = \"#0a0a0f\",\r\n    fg = \"#ffffff\"\r\n  ),\r\n  \r\n  tags$head(\r\n    # å¼•å…¥å„ªé›…çš„ä¸­æ–‡å­—é«”\r\n    tags$link(\r\n      href = \"https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500;600&family=LXGW+WenKai+TC:wght@300;400&display=swap\",\r\n      rel = \"stylesheet\"\r\n    ),\r\n    tags$style(HTML(\"\r\n      /* ===== å…¨åŸŸæ¨£å¼ ===== */\r\n      * {\r\n        margin: 0;\r\n        padding: 0;\r\n        box-sizing: border-box;\r\n      }\r\n      \r\n      body {\r\n        background: #0a0a0f;\r\n        min-height: 100vh;\r\n        font-family: 'LXGW WenKai TC', 'Noto Serif TC', serif;\r\n        overflow-x: hidden;\r\n      }\r\n      \r\n      /* ===== å‹•æ…‹èƒŒæ™¯ ===== */\r\n      .bg-container {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        z-index: 0;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .bg-gradient {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: \r\n          radial-gradient(ellipse at 20% 20%, rgba(120, 80, 160, 0.15) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 80% 80%, rgba(80, 120, 180, 0.12) 0%, transparent 50%),\r\n          radial-gradient(ellipse at 50% 50%, rgba(60, 60, 80, 0.1) 0%, transparent 70%);\r\n      }\r\n      \r\n      /* æµ®å‹•å…‰é» */\r\n      .floating-orb {\r\n        position: absolute;\r\n        border-radius: 50%;\r\n        filter: blur(60px);\r\n        animation: float 20s infinite ease-in-out;\r\n        opacity: 0.4;\r\n      }\r\n      \r\n      .orb-1 {\r\n        width: 400px;\r\n        height: 400px;\r\n        background: linear-gradient(135deg, #6366f1, #8b5cf6);\r\n        top: -10%;\r\n        left: -5%;\r\n        animation-delay: 0s;\r\n      }\r\n      \r\n      .orb-2 {\r\n        width: 350px;\r\n        height: 350px;\r\n        background: linear-gradient(135deg, #0ea5e9, #06b6d4);\r\n        bottom: -10%;\r\n        right: -5%;\r\n        animation-delay: -7s;\r\n      }\r\n      \r\n      .orb-3 {\r\n        width: 250px;\r\n        height: 250px;\r\n        background: linear-gradient(135deg, #f59e0b, #ef4444);\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        animation-delay: -14s;\r\n        opacity: 0.2;\r\n      }\r\n      \r\n      @keyframes float {\r\n        0%, 100% { transform: translate(0, 0) scale(1); }\r\n        25% { transform: translate(30px, -30px) scale(1.05); }\r\n        50% { transform: translate(-20px, 20px) scale(0.95); }\r\n        75% { transform: translate(20px, 30px) scale(1.02); }\r\n      }\r\n      \r\n      /* æ˜Ÿæ˜Ÿç²’å­ */\r\n      .stars {\r\n        position: absolute;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-image: \r\n          radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),\r\n          radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.4), transparent),\r\n          radial-gradient(2px 2px at 130px 80px, rgba(255,255,255,0.2), transparent),\r\n          radial-gradient(1px 1px at 160px 120px, rgba(255,255,255,0.3), transparent);\r\n        background-repeat: repeat;\r\n        background-size: 200px 200px;\r\n        animation: twinkle 8s infinite;\r\n      }\r\n      \r\n      @keyframes twinkle {\r\n        0%, 100% { opacity: 0.5; }\r\n        50% { opacity: 1; }\r\n      }\r\n      \r\n      /* ===== ä¸»å®¹å™¨ ===== */\r\n      .main-container {\r\n        position: relative;\r\n        z-index: 1;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        min-height: 100vh;\r\n        padding: 1.5rem;\r\n      }\r\n      \r\n      /* ===== æ¨™é¡Œå€ ===== */\r\n      .header {\r\n        text-align: center;\r\n        margin-bottom: 2rem;\r\n      }\r\n      \r\n      .main-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: clamp(1.5rem, 4vw, 2.2rem);\r\n        font-weight: 300;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.3em;\r\n        margin-bottom: 0.5rem;\r\n        text-shadow: 0 0 40px rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .sub-title {\r\n        font-size: 0.85rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.2em;\r\n        font-weight: 300;\r\n      }\r\n      \r\n      /* ===== å¡ç‰‡ä¸»é«” ===== */\r\n      .quote-card {\r\n        position: relative;\r\n        background: linear-gradient(\r\n          135deg,\r\n          rgba(255, 255, 255, 0.03) 0%,\r\n          rgba(255, 255, 255, 0.08) 50%,\r\n          rgba(255, 255, 255, 0.03) 100%\r\n        );\r\n        backdrop-filter: blur(20px);\r\n        -webkit-backdrop-filter: blur(20px);\r\n        border-radius: 24px;\r\n        padding: clamp(2rem, 5vw, 3.5rem);\r\n        max-width: 850px;\r\n        width: 100%;\r\n        border: 1px solid rgba(255, 255, 255, 0.08);\r\n        box-shadow: \r\n          0 25px 50px -12px rgba(0, 0, 0, 0.5),\r\n          inset 0 1px 0 rgba(255, 255, 255, 0.1);\r\n        animation: cardEnter 1s cubic-bezier(0.16, 1, 0.3, 1);\r\n      }\r\n      \r\n      @keyframes cardEnter {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(40px) scale(0.95);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0) scale(1);\r\n        }\r\n      }\r\n      \r\n      /* å¡ç‰‡é ‚éƒ¨è£é£¾ç·š */\r\n      .quote-card::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        width: 60%;\r\n        height: 1px;\r\n        background: linear-gradient(\r\n          90deg,\r\n          transparent,\r\n          rgba(139, 92, 246, 0.5),\r\n          rgba(236, 72, 153, 0.5),\r\n          transparent\r\n        );\r\n      }\r\n      \r\n      /* ===== åˆ†é¡æ¨™ç±¤ ===== */\r\n      .category-tag {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        gap: 0.4rem;\r\n        padding: 0.4rem 1rem;\r\n        background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2));\r\n        border: 1px solid rgba(139, 92, 246, 0.3);\r\n        border-radius: 20px;\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        margin-bottom: 1.5rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .category-icon {\r\n        font-size: 0.9rem;\r\n      }\r\n      \r\n      /* ===== å¼•è™Ÿè£é£¾ ===== */\r\n      .quote-mark {\r\n        font-family: Georgia, serif;\r\n        font-size: 4rem;\r\n        line-height: 1;\r\n        color: rgba(139, 92, 246, 0.3);\r\n        margin-bottom: -1rem;\r\n        user-select: none;\r\n      }\r\n      \r\n      /* ===== èªéŒ„æ–‡å­— ===== */\r\n      .quote-wrapper {\r\n        position: relative;\r\n        min-height: 120px;\r\n      }\r\n      \r\n      .quote-text {\r\n        font-family: 'Noto Serif TC', serif;\r\n        color: rgba(255, 255, 255, 0.95);\r\n        margin-bottom: 1.5rem;\r\n        animation: textFade 0.8s ease-out;\r\n      }\r\n      \r\n      @keyframes textFade {\r\n        from {\r\n          opacity: 0;\r\n          transform: translateY(10px);\r\n        }\r\n        to {\r\n          opacity: 1;\r\n          transform: translateY(0);\r\n        }\r\n      }\r\n      \r\n      /* çŸ­èªéŒ„ */\r\n      .quote-text.short {\r\n        font-size: clamp(1.4rem, 3vw, 1.9rem);\r\n        font-weight: 400;\r\n        line-height: 2;\r\n        letter-spacing: 0.08em;\r\n        text-align: center;\r\n      }\r\n      \r\n      /* ä¸­ç­‰é•·åº¦ */\r\n      .quote-text.medium {\r\n        font-size: clamp(1.1rem, 2.2vw, 1.35rem);\r\n        font-weight: 400;\r\n        line-height: 2.2;\r\n        letter-spacing: 0.05em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* é•·æ•…äº‹ */\r\n      .quote-text.long {\r\n        font-size: clamp(1rem, 1.8vw, 1.15rem);\r\n        font-weight: 400;\r\n        line-height: 2.4;\r\n        letter-spacing: 0.03em;\r\n        text-align: justify;\r\n        text-justify: inter-ideograph;\r\n      }\r\n      \r\n      /* ===== ä½œè€…å€ ===== */\r\n      .author-section {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        padding-top: 1.5rem;\r\n        border-top: 1px solid rgba(255, 255, 255, 0.08);\r\n        animation: authorFade 0.8s ease-out 0.3s both;\r\n      }\r\n      \r\n      @keyframes authorFade {\r\n        from { opacity: 0; }\r\n        to { opacity: 1; }\r\n      }\r\n      \r\n      .author-line {\r\n        width: 30px;\r\n        height: 1px;\r\n        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4));\r\n      }\r\n      \r\n      .author-line:last-child {\r\n        background: linear-gradient(90deg, rgba(255, 255, 255, 0.4), transparent);\r\n      }\r\n      \r\n      .quote-author {\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 1rem;\r\n        color: rgba(255, 255, 255, 0.6);\r\n        font-style: normal;\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      /* ===== å­—æ•¸é¡¯ç¤º ===== */\r\n      .char-count {\r\n        text-align: center;\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        margin-top: 1rem;\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      /* ===== æŒ‰éˆ•å€ ===== */\r\n      .button-group {\r\n        display: flex;\r\n        justify-content: center;\r\n        gap: 1rem;\r\n        margin-top: 2rem;\r\n        flex-wrap: wrap;\r\n      }\r\n      \r\n      .action-btn {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 0.5rem;\r\n        padding: 0.9rem 1.8rem;\r\n        border-radius: 50px;\r\n        font-family: 'LXGW WenKai TC', serif;\r\n        font-size: 0.95rem;\r\n        letter-spacing: 0.1em;\r\n        cursor: pointer;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border: none;\r\n        outline: none;\r\n      }\r\n      \r\n      .refresh-btn {\r\n        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);\r\n        color: white;\r\n        box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);\r\n      }\r\n      \r\n      .refresh-btn:hover {\r\n        transform: translateY(-3px) scale(1.02);\r\n        box-shadow: 0 8px 30px rgba(99, 102, 241, 0.5);\r\n      }\r\n      \r\n      .refresh-btn:active {\r\n        transform: translateY(0) scale(0.98);\r\n      }\r\n      \r\n      .secondary-btn {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        color: rgba(255, 255, 255, 0.7);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .secondary-btn:hover {\r\n        background: rgba(255, 255, 255, 0.1);\r\n        color: white;\r\n        transform: translateY(-2px);\r\n      }\r\n      \r\n      .secondary-btn.active {\r\n        background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(239, 68, 68, 0.2));\r\n        border-color: rgba(236, 72, 153, 0.4);\r\n        color: #f472b6;\r\n      }\r\n      \r\n      /* ===== é€²åº¦æ¢ ===== */\r\n      .progress-section {\r\n        margin-top: 2rem;\r\n        text-align: center;\r\n      }\r\n      \r\n      .progress-bar-container {\r\n        width: 100%;\r\n        max-width: 300px;\r\n        height: 3px;\r\n        background: rgba(255, 255, 255, 0.1);\r\n        border-radius: 3px;\r\n        margin: 0 auto 0.8rem;\r\n        overflow: hidden;\r\n      }\r\n      \r\n      .progress-bar-fill {\r\n        height: 100%;\r\n        background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7);\r\n        border-radius: 3px;\r\n        transition: width 1s linear;\r\n      }\r\n      \r\n      .timer-text {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.15em;\r\n      }\r\n      \r\n      .countdown {\r\n        font-family: 'SF Mono', 'Consolas', monospace;\r\n        color: rgba(255, 255, 255, 0.6);\r\n      }\r\n      \r\n      /* ===== æ”¶è—åˆ—è¡¨ Modal ===== */\r\n      .favorites-panel {\r\n        position: fixed;\r\n        top: 0;\r\n        right: -400px;\r\n        width: 380px;\r\n        max-width: 90vw;\r\n        height: 100vh;\r\n        background: linear-gradient(180deg, rgba(15, 15, 25, 0.98), rgba(10, 10, 15, 0.98));\r\n        backdrop-filter: blur(20px);\r\n        z-index: 1000;\r\n        padding: 2rem;\r\n        overflow-y: auto;\r\n        transition: right 0.5s cubic-bezier(0.16, 1, 0.3, 1);\r\n        border-left: 1px solid rgba(255, 255, 255, 0.1);\r\n        box-shadow: -10px 0 40px rgba(0, 0, 0, 0.5);\r\n      }\r\n      \r\n      .favorites-panel.open {\r\n        right: 0;\r\n      }\r\n      \r\n      .panel-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        margin-bottom: 2rem;\r\n        padding-bottom: 1rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .panel-title {\r\n        font-family: 'Noto Serif TC', serif;\r\n        font-size: 1.3rem;\r\n        color: rgba(255, 255, 255, 0.9);\r\n        letter-spacing: 0.1em;\r\n      }\r\n      \r\n      .close-btn {\r\n        background: none;\r\n        border: none;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        font-size: 1.5rem;\r\n        cursor: pointer;\r\n        padding: 0.5rem;\r\n        transition: color 0.3s;\r\n      }\r\n      \r\n      .close-btn:hover {\r\n        color: white;\r\n      }\r\n      \r\n      .favorite-item {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        border-radius: 12px;\r\n        padding: 1.2rem;\r\n        margin-bottom: 1rem;\r\n        border: 1px solid rgba(255, 255, 255, 0.05);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .favorite-item:hover {\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border-color: rgba(139, 92, 246, 0.3);\r\n      }\r\n      \r\n      .favorite-quote {\r\n        font-size: 0.9rem;\r\n        color: rgba(255, 255, 255, 0.8);\r\n        line-height: 1.8;\r\n        margin-bottom: 0.8rem;\r\n      }\r\n      \r\n      .favorite-author {\r\n        font-size: 0.8rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        text-align: right;\r\n      }\r\n      \r\n      .empty-favorites {\r\n        text-align: center;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        padding: 3rem 1rem;\r\n        font-size: 0.9rem;\r\n        line-height: 1.8;\r\n      }\r\n      \r\n      /* ===== é®ç½©å±¤ ===== */\r\n      .overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        z-index: 999;\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .overlay.show {\r\n        opacity: 1;\r\n        visibility: visible;\r\n      }\r\n      \r\n      /* ===== å¿«æ·éµæç¤º (å·¦å´) ===== */\r\n      .shortcut-hint {\r\n        position: fixed;\r\n        left: 1.5rem;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.5rem;\r\n        z-index: 100;\r\n      }\r\n      \r\n      .shortcut-panel {\r\n        background: rgba(255, 255, 255, 0.03);\r\n        backdrop-filter: blur(10px);\r\n        border: 1px solid rgba(255, 255, 255, 0.06);\r\n        border-radius: 12px;\r\n        padding: 1rem 0.8rem;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 0.6rem;\r\n      }\r\n      \r\n      .shortcut-title {\r\n        font-size: 0.65rem;\r\n        color: rgba(255, 255, 255, 0.3);\r\n        letter-spacing: 0.15em;\r\n        text-transform: uppercase;\r\n        margin-bottom: 0.3rem;\r\n        padding-bottom: 0.5rem;\r\n        border-bottom: 1px solid rgba(255, 255, 255, 0.06);\r\n      }\r\n      \r\n      .shortcut-item {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 0.6rem;\r\n        padding: 0.3rem 0;\r\n        transition: all 0.3s ease;\r\n        border-radius: 6px;\r\n        cursor: default;\r\n      }\r\n      \r\n      .shortcut-item:hover {\r\n        background: rgba(255, 255, 255, 0.05);\r\n        padding-left: 0.4rem;\r\n        padding-right: 0.4rem;\r\n        margin-left: -0.4rem;\r\n        margin-right: -0.4rem;\r\n      }\r\n      \r\n      .shortcut-item:hover .key {\r\n        background: rgba(139, 92, 246, 0.3);\r\n        border-color: rgba(139, 92, 246, 0.5);\r\n        color: rgba(255, 255, 255, 0.9);\r\n      }\r\n      \r\n      .shortcut-item:hover .shortcut-label {\r\n        color: rgba(255, 255, 255, 0.7);\r\n      }\r\n      \r\n      .key {\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        min-width: 28px;\r\n        height: 26px;\r\n        padding: 0 8px;\r\n        background: rgba(255, 255, 255, 0.06);\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        border-radius: 6px;\r\n        font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;\r\n        font-size: 0.7rem;\r\n        color: rgba(255, 255, 255, 0.5);\r\n        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);\r\n        transition: all 0.3s ease;\r\n      }\r\n      \r\n      .shortcut-label {\r\n        font-size: 0.75rem;\r\n        color: rgba(255, 255, 255, 0.4);\r\n        letter-spacing: 0.05em;\r\n        transition: color 0.3s ease;\r\n      }\r\n      \r\n      /* ===== é€šçŸ¥æç¤º ===== */\r\n      .toast {\r\n        position: fixed;\r\n        bottom: 80px;\r\n        left: 50%;\r\n        transform: translateX(-50%) translateY(100px);\r\n        background: rgba(20, 20, 30, 0.95);\r\n        backdrop-filter: blur(10px);\r\n        padding: 0.8rem 1.5rem;\r\n        border-radius: 50px;\r\n        color: white;\r\n        font-size: 0.9rem;\r\n        letter-spacing: 0.05em;\r\n        opacity: 0;\r\n        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);\r\n        z-index: 2000;\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n      }\r\n      \r\n      .toast.show {\r\n        opacity: 1;\r\n        transform: translateX(-50%) translateY(0);\r\n      }\r\n      \r\n      /* ===== éŸ¿æ‡‰å¼è¨­è¨ˆ ===== */\r\n      @media (max-width: 768px) {\r\n        .main-container {\r\n          padding: 1rem;\r\n        }\r\n        \r\n        .quote-card {\r\n          padding: 1.5rem;\r\n          border-radius: 16px;\r\n        }\r\n        \r\n        .quote-mark {\r\n          font-size: 3rem;\r\n        }\r\n        \r\n        .button-group {\r\n          flex-direction: column;\r\n          align-items: stretch;\r\n        }\r\n        \r\n        .action-btn {\r\n          width: 100%;\r\n        }\r\n        \r\n        .shortcut-hint {\r\n          display: none;\r\n        }\r\n        \r\n        .favorites-panel {\r\n          width: 100%;\r\n          right: -100%;\r\n        }\r\n      }\r\n      \r\n      @media (max-width: 1100px) {\r\n        .shortcut-hint {\r\n          left: 0.8rem;\r\n        }\r\n        \r\n        .shortcut-panel {\r\n          padding: 0.7rem 0.5rem;\r\n        }\r\n        \r\n        .shortcut-label {\r\n          display: none;\r\n        }\r\n        \r\n        .shortcut-title {\r\n          font-size: 0.55rem;\r\n          text-align: center;\r\n        }\r\n      }\r\n      \r\n      /* ===== æ·±è‰²ä¸»é¡Œæ»¾å‹•æ¢ ===== */\r\n      ::-webkit-scrollbar {\r\n        width: 6px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-track {\r\n        background: rgba(255, 255, 255, 0.05);\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb {\r\n        background: rgba(255, 255, 255, 0.2);\r\n        border-radius: 3px;\r\n      }\r\n      \r\n      ::-webkit-scrollbar-thumb:hover {\r\n        background: rgba(255, 255, 255, 0.3);\r\n      }\r\n    \"))\r\n  ),\r\n  \r\n  # èƒŒæ™¯å±¤\r\n  div(class = \"bg-container\",\r\n    div(class = \"bg-gradient\"),\r\n    div(class = \"floating-orb orb-1\"),\r\n    div(class = \"floating-orb orb-2\"),\r\n    div(class = \"floating-orb orb-3\"),\r\n    div(class = \"stars\")\r\n  ),\r\n  \r\n  # ä¸»å…§å®¹\r\n  div(class = \"main-container\",\r\n    # æ¨™é¡Œ\r\n    div(class = \"header\",\r\n      h1(class = \"main-title\", \"å¿ƒéˆé©›ç«™\"),\r\n      p(class = \"sub-title\", \"DAILY INSPIRATIONS\")\r\n    ),\r\n    \r\n    # èªéŒ„å¡ç‰‡\r\n    div(class = \"quote-card\",\r\n      # åˆ†é¡æ¨™ç±¤\r\n      uiOutput(\"category_tag\"),\r\n      \r\n      # å¼•è™Ÿè£é£¾\r\n      div(class = \"quote-mark\", \"ã€Œ\"),\r\n      \r\n      # èªéŒ„å…§å®¹\r\n      div(class = \"quote-wrapper\",\r\n        uiOutput(\"quote_display\")\r\n      ),\r\n      \r\n      # ä½œè€…\r\n      div(class = \"author-section\",\r\n        span(class = \"author-line\"),\r\n        span(class = \"quote-author\", textOutput(\"quote_author\", inline = TRUE)),\r\n        span(class = \"author-line\")\r\n      ),\r\n      \r\n      # å­—æ•¸\r\n      div(class = \"char-count\", textOutput(\"char_count\", inline = TRUE)),\r\n      \r\n      # æŒ‰éˆ•çµ„\r\n      div(class = \"button-group\",\r\n        actionButton(\"refresh\", \r\n          tagList(icon(\"rotate\"), \"æ›ä¸€å‰‡\"),\r\n          class = \"action-btn refresh-btn\"\r\n        ),\r\n        actionButton(\"favorite\", \r\n          tagList(uiOutput(\"fav_icon\", inline = TRUE), \"æ”¶è—\"),\r\n          class = \"action-btn secondary-btn\"\r\n        ),\r\n        actionButton(\"show_favorites\", \r\n          tagList(icon(\"heart\"), \"æ”¶è—å¤¾\"),\r\n          class = \"action-btn secondary-btn\"\r\n        )\r\n      ),\r\n      \r\n      # é€²åº¦æ¢\r\n      div(class = \"progress-section\",\r\n        div(class = \"progress-bar-container\",\r\n          div(id = \"progress-fill\", class = \"progress-bar-fill\", style = \"width: 100%;\")\r\n        ),\r\n        div(class = \"timer-text\",\r\n          \"ä¸‹ä¸€å‰‡ï¼š\",\r\n          span(class = \"countdown\", textOutput(\"countdown\", inline = TRUE))\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # æ”¶è—é¢æ¿é®ç½©\r\n  div(id = \"overlay\", class = \"overlay\"),\r\n  \r\n  # æ”¶è—é¢æ¿\r\n  div(id = \"favorites-panel\", class = \"favorites-panel\",\r\n    div(class = \"panel-header\",\r\n      span(class = \"panel-title\", \"ğŸ’œ æˆ‘çš„æ”¶è—\"),\r\n      actionButton(\"close_panel\", \"Ã—\", class = \"close-btn\")\r\n    ),\r\n    uiOutput(\"favorites_list\")\r\n  ),\r\n  \r\n  # Toast é€šçŸ¥\r\n  div(id = \"toast\", class = \"toast\", textOutput(\"toast_message\", inline = TRUE)),\r\n  \r\n  # å¿«æ·éµæç¤º (å·¦å´)\r\n  div(class = \"shortcut-hint\",\r\n    div(class = \"shortcut-panel\",\r\n      div(class = \"shortcut-title\", \"å¿«æ·éµ\"),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Space\"),\r\n        span(class = \"shortcut-label\", \"æ›ä¸€å‰‡\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"F\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"L\"),\r\n        span(class = \"shortcut-label\", \"æ”¶è—å¤¾\")\r\n      ),\r\n      div(class = \"shortcut-item\",\r\n        span(class = \"key\", \"Esc\"),\r\n        span(class = \"shortcut-label\", \"é—œé–‰\")\r\n      )\r\n    )\r\n  ),\r\n  \r\n  # JavaScript\r\n  tags$script(HTML(\"\r\n    // éµç›¤å¿«æ·éµ\r\n    document.addEventListener('keydown', function(e) {\r\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\r\n      \r\n      if (e.code === 'Space') {\r\n        e.preventDefault();\r\n        document.getElementById('refresh').click();\r\n      } else if (e.key.toLowerCase() === 'f') {\r\n        document.getElementById('favorite').click();\r\n      } else if (e.key.toLowerCase() === 'l') {\r\n        document.getElementById('show_favorites').click();\r\n      } else if (e.key === 'Escape') {\r\n        document.getElementById('close_panel').click();\r\n      }\r\n    });\r\n    \r\n    // æ”¶è—é¢æ¿æ§åˆ¶\r\n    Shiny.addCustomMessageHandler('togglePanel', function(open) {\r\n      var panel = document.getElementById('favorites-panel');\r\n      var overlay = document.getElementById('overlay');\r\n      if (open) {\r\n        panel.classList.add('open');\r\n        overlay.classList.add('show');\r\n      } else {\r\n        panel.classList.remove('open');\r\n        overlay.classList.remove('show');\r\n      }\r\n    });\r\n    \r\n    // é»æ“Šé®ç½©é—œé–‰é¢æ¿\r\n    document.getElementById('overlay').addEventListener('click', function() {\r\n      document.getElementById('close_panel').click();\r\n    });\r\n    \r\n    // Toast é€šçŸ¥\r\n    Shiny.addCustomMessageHandler('showToast', function(message) {\r\n      var toast = document.getElementById('toast');\r\n      document.getElementById('toast_message').innerText = message;\r\n      toast.classList.add('show');\r\n      setTimeout(function() {\r\n        toast.classList.remove('show');\r\n      }, 2500);\r\n    });\r\n    \r\n    // æ›´æ–°é€²åº¦æ¢\r\n    Shiny.addCustomMessageHandler('updateProgress', function(percent) {\r\n      document.getElementById('progress-fill').style.width = percent + '%';\r\n    });\r\n  \"))\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # ç•¶å‰èªéŒ„ç´¢å¼•\r\n  current_index <- reactiveVal(sample(nrow(quotes), 1))\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  favorites <- reactiveVal(integer(0))\r\n  \r\n  # è¨ˆæ™‚å™¨ (600ç§’ = 10åˆ†é˜)\r\n  timer <- reactiveVal(600)\r\n  total_time <- 600\r\n  \r\n  # Toast è¨Šæ¯\r\n  toast_msg <- reactiveVal(\"\")\r\n  \r\n  # æ¯ç§’æ›´æ–°\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      t <- timer()\r\n      if (t > 0) {\r\n        timer(t - 1)\r\n        # æ›´æ–°é€²åº¦æ¢\r\n        percent <- (t / total_time) * 100\r\n        session$sendCustomMessage(\"updateProgress\", percent)\r\n      } else {\r\n        current_index(sample(nrow(quotes), 1))\r\n        timer(total_time)\r\n      }\r\n    })\r\n  })\r\n  \r\n  # æ‰‹å‹•åˆ·æ–°\r\n  observeEvent(input$refresh, {\r\n    current_index(sample(nrow(quotes), 1))\r\n    timer(total_time)\r\n  })\r\n  \r\n  # æ”¶è—/å–æ¶ˆæ”¶è—\r\n  observeEvent(input$favorite, {\r\n    idx <- current_index()\r\n    fav <- favorites()\r\n    \r\n    if (idx %in% fav) {\r\n      favorites(setdiff(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²å¾æ”¶è—å¤¾ç§»é™¤\")\r\n    } else {\r\n      favorites(c(fav, idx))\r\n      session$sendCustomMessage(\"showToast\", \"å·²åŠ å…¥æ”¶è—å¤¾ ğŸ’œ\")\r\n    }\r\n  })\r\n  \r\n  # é¡¯ç¤ºæ”¶è—é¢æ¿\r\n  observeEvent(input$show_favorites, {\r\n    session$sendCustomMessage(\"togglePanel\", TRUE)\r\n  })\r\n  \r\n  # é—œé–‰æ”¶è—é¢æ¿\r\n  observeEvent(input$close_panel, {\r\n    session$sendCustomMessage(\"togglePanel\", FALSE)\r\n  })\r\n  \r\n  # ç²å–å°ºå¯¸é¡åˆ¥\r\n  get_size_class <- function(text) {\r\n    n <- nchar(text)\r\n    if (n <= 100) \"short\"\r\n    else if (n <= 200) \"medium\"\r\n    else \"long\"\r\n  }\r\n  \r\n  # åˆ†é¡æ¨™ç±¤\r\n  output$category_tag <- renderUI({\r\n    cat <- quotes$category[current_index()]\r\n    icons <- list(\r\n      \"å‹‡æ°£\" = \"ğŸ¦\", \"è‡ªçœ\" = \"ğŸª\", \"è¡Œå‹•\" = \"ğŸš€\", \"æ™‚é–“\" = \"â°\", \"å¤¢æƒ³\" = \"âœ¨\",\r\n      \"åŠªåŠ›\" = \"ğŸ’ª\", \"æ¯…åŠ›\" = \"ğŸ”ï¸\", \"åˆå¿ƒ\" = \"ğŸŒ±\", \"æˆé•·\" = \"ğŸŒ³\", \"è‡ªä¿¡\" = \"ğŸ‘‘\",\r\n      \"æ¸´æœ›\" = \"ğŸ”¥\", \"é€†å¢ƒ\" = \"ğŸŒŠ\", \"è€å¿ƒ\" = \"ğŸ‹\", \"å¿ƒæ…‹\" = \"ğŸ§ \", \"æ‰¹è©•\" = \"ğŸ¨\",\r\n      \"å …æŒ\" = \"ğŸ’\", \"è¦–è§’\" = \"ğŸ‘ï¸\", \"é‡ç”Ÿ\" = \"ğŸ¦…\", \"åƒ¹å€¼\" = \"âŒš\", \"å–„è‰¯\" = \"ğŸŒŸ\",\r\n      \"æ½›èƒ½\" = \"ğŸ˜\", \"ç£¨ç·´\" = \"ğŸ¦‹\", \"å…§åœ¨\" = \"ğŸˆ\", \"æ„Ÿæ©\" = \"ğŸ™\", \"æ™‚æ©Ÿ\" = \"ğŸŒ¾\",\r\n      \"éŸŒæ€§\" = \"ğŸŒ²\"\r\n    )\r\n    icon <- icons[[cat]] %||% \"ğŸ’«\"\r\n    \r\n    div(class = \"category-tag\",\r\n      span(class = \"category-icon\", icon),\r\n      cat\r\n    )\r\n  })\r\n  \r\n  # é¡¯ç¤ºèªéŒ„\r\n  output$quote_display <- renderUI({\r\n    quote_text <- quotes$quote[current_index()]\r\n    size_class <- get_size_class(quote_text)\r\n    div(class = paste(\"quote-text\", size_class), quote_text)\r\n  })\r\n  \r\n  # ä½œè€…\r\n  output$quote_author <- renderText({\r\n    quotes$author[current_index()]\r\n  })\r\n  \r\n  # å­—æ•¸\r\n  output$char_count <- renderText({\r\n    paste0(\"å…± \", nchar(quotes$quote[current_index()]), \" å­—\")\r\n  })\r\n  \r\n  # æ”¶è—åœ–æ¨™\r\n  output$fav_icon <- renderUI({\r\n    if (current_index() %in% favorites()) {\r\n      icon(\"heart\", class = \"fas\", style = \"color: #f472b6;\")\r\n    } else {\r\n      icon(\"heart\", class = \"far\")\r\n    }\r\n  })\r\n  \r\n  # å€’æ•¸è¨ˆæ™‚\r\n  output$countdown <- renderText({\r\n    t <- timer()\r\n    sprintf(\"%02d:%02d\", floor(t / 60), t %% 60)\r\n  })\r\n  \r\n  # Toast è¨Šæ¯è¼¸å‡º\r\n  output$toast_message <- renderText({\r\n    toast_msg()\r\n  })\r\n  \r\n  # æ”¶è—åˆ—è¡¨\r\n  output$favorites_list <- renderUI({\r\n    fav <- favorites()\r\n    \r\n    if (length(fav) == 0) {\r\n      return(div(class = \"empty-favorites\",\r\n        p(\"ğŸŒ™\"),\r\n        p(\"é‚„æ²’æœ‰æ”¶è—ä»»ä½•èªéŒ„\"),\r\n        p(\"é»æ“Šã€Œæ”¶è—ã€æŒ‰éˆ•æˆ–æŒ‰ F éµå³å¯æ”¶è—\")\r\n      ))\r\n    }\r\n    \r\n    tagList(\r\n      lapply(fav, function(idx) {\r\n        div(class = \"favorite-item\",\r\n          div(class = \"favorite-quote\",\r\n            substr(quotes$quote[idx], 1, 80),\r\n            if (nchar(quotes$quote[idx]) > 80) \"...\" else \"\"\r\n          ),\r\n          div(class = \"favorite-author\",\r\n            paste(\"â€”\", quotes$author[idx])\r\n          )\r\n        )\r\n      })\r\n    )\r\n  })\r\n}\r\n\r\nshinyApp(ui = ui, server = server)","type":"text"}]
